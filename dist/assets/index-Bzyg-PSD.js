var e=Object.defineProperty,t=(t,a,s)=>((t,a,s)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s)(t,"symbol"!=typeof a?a+"":a,s);import{r as a,b as s,a as r}from"./vendor-SlK7pBj5.js";import{u as n,a as i,N as o,H as l,R as c,b as d}from"./router-B3M4db4c.js";import{M as m,W as u,a as x,C as h,H as g,S as p,U as b,P as f,b as y,G as v,L as j,c as N,d as w,e as C,B as k,R as A,X as S,f as D,z as P,g as I,h as T,i as M,j as E,k as $,l as F,m as O,D as z,F as R,n as W,o as L,p as q,q as B,A as G,r as U,s as Y,T as H,t as X,u as _,v as J,w as V,x as Q,y as K,E as Z,I as ee,J as te,K as ae,N as se,O as re,Q as ne,V as ie,Y as oe,Z as le,_ as ce,$ as de}from"./ui-BXr1LiLV.js";import{_ as me,E as ue}from"./pdf-CmU5JFRX.js";import{X as xe,u as he}from"./database-RJ8daOrL.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const a of e)if("childList"===a.type)for(const e of a.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var ge={exports:{}},pe={},be=a,fe=Symbol.for("react.element"),ye=Symbol.for("react.fragment"),ve=Object.prototype.hasOwnProperty,je=be.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Ne={key:!0,ref:!0,__self:!0,__source:!0};function we(e,t,a){var s,r={},n=null,i=null;for(s in void 0!==a&&(n=""+a),void 0!==t.key&&(n=""+t.key),void 0!==t.ref&&(i=t.ref),t)ve.call(t,s)&&!Ne.hasOwnProperty(s)&&(r[s]=t[s]);if(e&&e.defaultProps)for(s in t=e.defaultProps)void 0===r[s]&&(r[s]=t[s]);return{$$typeof:fe,type:e,key:n,ref:i,props:r,_owner:je.current}}pe.Fragment=ye,pe.jsx=we,pe.jsxs=we,ge.exports=pe;var Ce=ge.exports,ke={},Ae=s;ke.createRoot=Ae.createRoot,ke.hydrateRoot=Ae.hydrateRoot;const Se=a.createContext(void 0),De=({children:e})=>{const[t,s]=a.useState(!1),[r,n]=a.useState(navigator.onLine),[i,o]=a.useState(null);a.useEffect(()=>{(async()=>{try{await new Promise(e=>setTimeout(e,500)),s(!0)}catch(e){s(!0)}})()},[]),a.useEffect(()=>{const e=()=>n(!0),t=()=>n(!1);return window.addEventListener("online",e),window.addEventListener("offline",t),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",t)}},[]);const l={isReady:t,isOnline:r,lastSync:i};return Ce.jsx(Se.Provider,{value:l,children:e})},Pe=()=>{const e=a.useContext(Se);if(void 0===e)throw new Error("useDatabase must be used within a DatabaseProvider");return e};function Ie(e){if(null===e||!0===e||!1===e)return NaN;var t=Number(e);return isNaN(t)?t:t<0?Math.ceil(t):Math.floor(t)}function Te(e,t){if(t.length<e)throw new TypeError(e+" argument"+(e>1?"s":"")+" required, but only "+t.length+" present")}function Me(e){Te(1,arguments);var t=Object.prototype.toString.call(e);return e instanceof Date||"object"===me(e)&&"[object Date]"===t?new Date(e.getTime()):"number"==typeof e||"[object Number]"===t?new Date(e):new Date(NaN)}var Ee={};function $e(){return Ee}function Fe(e){if(Te(1,arguments),!function(e){return Te(1,arguments),e instanceof Date||"object"===me(e)&&"[object Date]"===Object.prototype.toString.call(e)}(e)&&"number"!=typeof e)return!1;var t=Me(e);return!isNaN(Number(t))}function Oe(e,t){return Te(2,arguments),function(e,t){Te(2,arguments);var a=Me(e).getTime(),s=Ie(t);return new Date(a+s)}(e,-Ie(t))}function ze(e){Te(1,arguments);var t=Me(e),a=t.getUTCDay(),s=(a<1?7:0)+a-1;return t.setUTCDate(t.getUTCDate()-s),t.setUTCHours(0,0,0,0),t}function Re(e){Te(1,arguments);var t=Me(e),a=t.getUTCFullYear(),s=new Date(0);s.setUTCFullYear(a+1,0,4),s.setUTCHours(0,0,0,0);var r=ze(s),n=new Date(0);n.setUTCFullYear(a,0,4),n.setUTCHours(0,0,0,0);var i=ze(n);return t.getTime()>=r.getTime()?a+1:t.getTime()>=i.getTime()?a:a-1}function We(e){Te(1,arguments);var t=Me(e),a=ze(t).getTime()-function(e){Te(1,arguments);var t=Re(e),a=new Date(0);return a.setUTCFullYear(t,0,4),a.setUTCHours(0,0,0,0),ze(a)}(t).getTime();return Math.round(a/6048e5)+1}function Le(e,t){var a,s,r,n,i,o,l,c;Te(1,arguments);var d=$e(),m=Ie(null!==(a=null!==(s=null!==(r=null!==(n=null==t?void 0:t.weekStartsOn)&&void 0!==n?n:null==t||null===(i=t.locale)||void 0===i||null===(o=i.options)||void 0===o?void 0:o.weekStartsOn)&&void 0!==r?r:d.weekStartsOn)&&void 0!==s?s:null===(l=d.locale)||void 0===l||null===(c=l.options)||void 0===c?void 0:c.weekStartsOn)&&void 0!==a?a:0);if(!(m>=0&&m<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var u=Me(e),x=u.getUTCDay(),h=(x<m?7:0)+x-m;return u.setUTCDate(u.getUTCDate()-h),u.setUTCHours(0,0,0,0),u}function qe(e,t){var a,s,r,n,i,o,l,c;Te(1,arguments);var d=Me(e),m=d.getUTCFullYear(),u=$e(),x=Ie(null!==(a=null!==(s=null!==(r=null!==(n=null==t?void 0:t.firstWeekContainsDate)&&void 0!==n?n:null==t||null===(i=t.locale)||void 0===i||null===(o=i.options)||void 0===o?void 0:o.firstWeekContainsDate)&&void 0!==r?r:u.firstWeekContainsDate)&&void 0!==s?s:null===(l=u.locale)||void 0===l||null===(c=l.options)||void 0===c?void 0:c.firstWeekContainsDate)&&void 0!==a?a:1);if(!(x>=1&&x<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var h=new Date(0);h.setUTCFullYear(m+1,0,x),h.setUTCHours(0,0,0,0);var g=Le(h,t),p=new Date(0);p.setUTCFullYear(m,0,x),p.setUTCHours(0,0,0,0);var b=Le(p,t);return d.getTime()>=g.getTime()?m+1:d.getTime()>=b.getTime()?m:m-1}function Be(e,t){Te(1,arguments);var a=Me(e),s=Le(a,t).getTime()-function(e,t){var a,s,r,n,i,o,l,c;Te(1,arguments);var d=$e(),m=Ie(null!==(a=null!==(s=null!==(r=null!==(n=null==t?void 0:t.firstWeekContainsDate)&&void 0!==n?n:null==t||null===(i=t.locale)||void 0===i||null===(o=i.options)||void 0===o?void 0:o.firstWeekContainsDate)&&void 0!==r?r:d.firstWeekContainsDate)&&void 0!==s?s:null===(l=d.locale)||void 0===l||null===(c=l.options)||void 0===c?void 0:c.firstWeekContainsDate)&&void 0!==a?a:1),u=qe(e,t),x=new Date(0);return x.setUTCFullYear(u,0,m),x.setUTCHours(0,0,0,0),Le(x,t)}(a,t).getTime();return Math.round(s/6048e5)+1}function Ge(e,t){for(var a=e<0?"-":"",s=Math.abs(e).toString();s.length<t;)s="0"+s;return a+s}var Ue=function(e,t){var a=e.getUTCFullYear(),s=a>0?a:1-a;return Ge("yy"===t?s%100:s,t.length)},Ye=function(e,t){var a=e.getUTCMonth();return"M"===t?String(a+1):Ge(a+1,2)},He=function(e,t){return Ge(e.getUTCDate(),t.length)},Xe=function(e,t){return Ge(e.getUTCHours()%12||12,t.length)},_e=function(e,t){return Ge(e.getUTCHours(),t.length)},Je=function(e,t){return Ge(e.getUTCMinutes(),t.length)},Ve=function(e,t){return Ge(e.getUTCSeconds(),t.length)},Qe=function(e,t){var a=t.length,s=e.getUTCMilliseconds();return Ge(Math.floor(s*Math.pow(10,a-3)),t.length)},Ke="midnight",Ze="noon",et="morning",tt="afternoon",at="evening",st="night",rt={G:function(e,t,a){var s=e.getUTCFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return a.era(s,{width:"abbreviated"});case"GGGGG":return a.era(s,{width:"narrow"});default:return a.era(s,{width:"wide"})}},y:function(e,t,a){if("yo"===t){var s=e.getUTCFullYear(),r=s>0?s:1-s;return a.ordinalNumber(r,{unit:"year"})}return Ue(e,t)},Y:function(e,t,a,s){var r=qe(e,s),n=r>0?r:1-r;return"YY"===t?Ge(n%100,2):"Yo"===t?a.ordinalNumber(n,{unit:"year"}):Ge(n,t.length)},R:function(e,t){return Ge(Re(e),t.length)},u:function(e,t){return Ge(e.getUTCFullYear(),t.length)},Q:function(e,t,a){var s=Math.ceil((e.getUTCMonth()+1)/3);switch(t){case"Q":return String(s);case"QQ":return Ge(s,2);case"Qo":return a.ordinalNumber(s,{unit:"quarter"});case"QQQ":return a.quarter(s,{width:"abbreviated",context:"formatting"});case"QQQQQ":return a.quarter(s,{width:"narrow",context:"formatting"});default:return a.quarter(s,{width:"wide",context:"formatting"})}},q:function(e,t,a){var s=Math.ceil((e.getUTCMonth()+1)/3);switch(t){case"q":return String(s);case"qq":return Ge(s,2);case"qo":return a.ordinalNumber(s,{unit:"quarter"});case"qqq":return a.quarter(s,{width:"abbreviated",context:"standalone"});case"qqqqq":return a.quarter(s,{width:"narrow",context:"standalone"});default:return a.quarter(s,{width:"wide",context:"standalone"})}},M:function(e,t,a){var s=e.getUTCMonth();switch(t){case"M":case"MM":return Ye(e,t);case"Mo":return a.ordinalNumber(s+1,{unit:"month"});case"MMM":return a.month(s,{width:"abbreviated",context:"formatting"});case"MMMMM":return a.month(s,{width:"narrow",context:"formatting"});default:return a.month(s,{width:"wide",context:"formatting"})}},L:function(e,t,a){var s=e.getUTCMonth();switch(t){case"L":return String(s+1);case"LL":return Ge(s+1,2);case"Lo":return a.ordinalNumber(s+1,{unit:"month"});case"LLL":return a.month(s,{width:"abbreviated",context:"standalone"});case"LLLLL":return a.month(s,{width:"narrow",context:"standalone"});default:return a.month(s,{width:"wide",context:"standalone"})}},w:function(e,t,a,s){var r=Be(e,s);return"wo"===t?a.ordinalNumber(r,{unit:"week"}):Ge(r,t.length)},I:function(e,t,a){var s=We(e);return"Io"===t?a.ordinalNumber(s,{unit:"week"}):Ge(s,t.length)},d:function(e,t,a){return"do"===t?a.ordinalNumber(e.getUTCDate(),{unit:"date"}):He(e,t)},D:function(e,t,a){var s=function(e){Te(1,arguments);var t=Me(e),a=t.getTime();t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0);var s=a-t.getTime();return Math.floor(s/864e5)+1}(e);return"Do"===t?a.ordinalNumber(s,{unit:"dayOfYear"}):Ge(s,t.length)},E:function(e,t,a){var s=e.getUTCDay();switch(t){case"E":case"EE":case"EEE":return a.day(s,{width:"abbreviated",context:"formatting"});case"EEEEE":return a.day(s,{width:"narrow",context:"formatting"});case"EEEEEE":return a.day(s,{width:"short",context:"formatting"});default:return a.day(s,{width:"wide",context:"formatting"})}},e:function(e,t,a,s){var r=e.getUTCDay(),n=(r-s.weekStartsOn+8)%7||7;switch(t){case"e":return String(n);case"ee":return Ge(n,2);case"eo":return a.ordinalNumber(n,{unit:"day"});case"eee":return a.day(r,{width:"abbreviated",context:"formatting"});case"eeeee":return a.day(r,{width:"narrow",context:"formatting"});case"eeeeee":return a.day(r,{width:"short",context:"formatting"});default:return a.day(r,{width:"wide",context:"formatting"})}},c:function(e,t,a,s){var r=e.getUTCDay(),n=(r-s.weekStartsOn+8)%7||7;switch(t){case"c":return String(n);case"cc":return Ge(n,t.length);case"co":return a.ordinalNumber(n,{unit:"day"});case"ccc":return a.day(r,{width:"abbreviated",context:"standalone"});case"ccccc":return a.day(r,{width:"narrow",context:"standalone"});case"cccccc":return a.day(r,{width:"short",context:"standalone"});default:return a.day(r,{width:"wide",context:"standalone"})}},i:function(e,t,a){var s=e.getUTCDay(),r=0===s?7:s;switch(t){case"i":return String(r);case"ii":return Ge(r,t.length);case"io":return a.ordinalNumber(r,{unit:"day"});case"iii":return a.day(s,{width:"abbreviated",context:"formatting"});case"iiiii":return a.day(s,{width:"narrow",context:"formatting"});case"iiiiii":return a.day(s,{width:"short",context:"formatting"});default:return a.day(s,{width:"wide",context:"formatting"})}},a:function(e,t,a){var s=e.getUTCHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return a.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"aaa":return a.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return a.dayPeriod(s,{width:"narrow",context:"formatting"});default:return a.dayPeriod(s,{width:"wide",context:"formatting"})}},b:function(e,t,a){var s,r=e.getUTCHours();switch(s=12===r?Ze:0===r?Ke:r/12>=1?"pm":"am",t){case"b":case"bb":return a.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"bbb":return a.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return a.dayPeriod(s,{width:"narrow",context:"formatting"});default:return a.dayPeriod(s,{width:"wide",context:"formatting"})}},B:function(e,t,a){var s,r=e.getUTCHours();switch(s=r>=17?at:r>=12?tt:r>=4?et:st,t){case"B":case"BB":case"BBB":return a.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"BBBBB":return a.dayPeriod(s,{width:"narrow",context:"formatting"});default:return a.dayPeriod(s,{width:"wide",context:"formatting"})}},h:function(e,t,a){if("ho"===t){var s=e.getUTCHours()%12;return 0===s&&(s=12),a.ordinalNumber(s,{unit:"hour"})}return Xe(e,t)},H:function(e,t,a){return"Ho"===t?a.ordinalNumber(e.getUTCHours(),{unit:"hour"}):_e(e,t)},K:function(e,t,a){var s=e.getUTCHours()%12;return"Ko"===t?a.ordinalNumber(s,{unit:"hour"}):Ge(s,t.length)},k:function(e,t,a){var s=e.getUTCHours();return 0===s&&(s=24),"ko"===t?a.ordinalNumber(s,{unit:"hour"}):Ge(s,t.length)},m:function(e,t,a){return"mo"===t?a.ordinalNumber(e.getUTCMinutes(),{unit:"minute"}):Je(e,t)},s:function(e,t,a){return"so"===t?a.ordinalNumber(e.getUTCSeconds(),{unit:"second"}):Ve(e,t)},S:function(e,t){return Qe(e,t)},X:function(e,t,a,s){var r=(s._originalDate||e).getTimezoneOffset();if(0===r)return"Z";switch(t){case"X":return it(r);case"XXXX":case"XX":return ot(r);default:return ot(r,":")}},x:function(e,t,a,s){var r=(s._originalDate||e).getTimezoneOffset();switch(t){case"x":return it(r);case"xxxx":case"xx":return ot(r);default:return ot(r,":")}},O:function(e,t,a,s){var r=(s._originalDate||e).getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+nt(r,":");default:return"GMT"+ot(r,":")}},z:function(e,t,a,s){var r=(s._originalDate||e).getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+nt(r,":");default:return"GMT"+ot(r,":")}},t:function(e,t,a,s){var r=s._originalDate||e;return Ge(Math.floor(r.getTime()/1e3),t.length)},T:function(e,t,a,s){return Ge((s._originalDate||e).getTime(),t.length)}};function nt(e,t){var a=e>0?"-":"+",s=Math.abs(e),r=Math.floor(s/60),n=s%60;if(0===n)return a+String(r);var i=t;return a+String(r)+i+Ge(n,2)}function it(e,t){return e%60==0?(e>0?"-":"+")+Ge(Math.abs(e)/60,2):ot(e,t)}function ot(e,t){var a=t||"",s=e>0?"-":"+",r=Math.abs(e);return s+Ge(Math.floor(r/60),2)+a+Ge(r%60,2)}var lt=function(e,t){switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});default:return t.date({width:"full"})}},ct=function(e,t){switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});default:return t.time({width:"full"})}},dt={p:ct,P:function(e,t){var a,s=e.match(/(P+)(p+)?/)||[],r=s[1],n=s[2];if(!n)return lt(e,t);switch(r){case"P":a=t.dateTime({width:"short"});break;case"PP":a=t.dateTime({width:"medium"});break;case"PPP":a=t.dateTime({width:"long"});break;default:a=t.dateTime({width:"full"})}return a.replace("{{date}}",lt(r,t)).replace("{{time}}",ct(n,t))}},mt=["D","DD"],ut=["YY","YYYY"];function xt(e,t,a){if("YYYY"===e)throw new RangeError("Use `yyyy` instead of `YYYY` (in `".concat(t,"`) for formatting years to the input `").concat(a,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if("YY"===e)throw new RangeError("Use `yy` instead of `YY` (in `".concat(t,"`) for formatting years to the input `").concat(a,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if("D"===e)throw new RangeError("Use `d` instead of `D` (in `".concat(t,"`) for formatting days of the month to the input `").concat(a,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if("DD"===e)throw new RangeError("Use `dd` instead of `DD` (in `".concat(t,"`) for formatting days of the month to the input `").concat(a,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"))}var ht={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}};function gt(e){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=t.width?String(t.width):e.defaultWidth;return e.formats[a]||e.formats[e.defaultWidth]}}var pt={date:gt({formats:{full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},defaultWidth:"full"}),time:gt({formats:{full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},defaultWidth:"full"}),dateTime:gt({formats:{full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},defaultWidth:"full"})},bt={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"};function ft(e){return function(t,a){var s;if("formatting"===(null!=a&&a.context?String(a.context):"standalone")&&e.formattingValues){var r=e.defaultFormattingWidth||e.defaultWidth,n=null!=a&&a.width?String(a.width):r;s=e.formattingValues[n]||e.formattingValues[r]}else{var i=e.defaultWidth,o=null!=a&&a.width?String(a.width):e.defaultWidth;s=e.values[o]||e.values[i]}return s[e.argumentCallback?e.argumentCallback(t):t]}}function yt(e){return function(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=a.width,r=s&&e.matchPatterns[s]||e.matchPatterns[e.defaultMatchWidth],n=t.match(r);if(!n)return null;var i,o=n[0],l=s&&e.parsePatterns[s]||e.parsePatterns[e.defaultParseWidth],c=Array.isArray(l)?function(e,t){for(var a=0;a<e.length;a++)if(t(e[a]))return a;return}(l,function(e){return e.test(o)}):function(e,t){for(var a in e)if(e.hasOwnProperty(a)&&t(e[a]))return a;return}(l,function(e){return e.test(o)});return i=e.valueCallback?e.valueCallback(c):c,{value:i=a.valueCallback?a.valueCallback(i):i,rest:t.slice(o.length)}}}function vt(e){return function(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=t.match(e.matchPattern);if(!s)return null;var r=s[0],n=t.match(e.parsePattern);if(!n)return null;var i=e.valueCallback?e.valueCallback(n[0]):n[0];return{value:i=a.valueCallback?a.valueCallback(i):i,rest:t.slice(r.length)}}}var jt={code:"en-US",formatDistance:function(e,t,a){var s,r=ht[e];return s="string"==typeof r?r:1===t?r.one:r.other.replace("{{count}}",t.toString()),null!=a&&a.addSuffix?a.comparison&&a.comparison>0?"in "+s:s+" ago":s},formatLong:pt,formatRelative:function(e,t,a,s){return bt[e]},localize:{ordinalNumber:function(e,t){var a=Number(e),s=a%100;if(s>20||s<10)switch(s%10){case 1:return a+"st";case 2:return a+"nd";case 3:return a+"rd"}return a+"th"},era:ft({values:{narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},defaultWidth:"wide"}),quarter:ft({values:{narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},defaultWidth:"wide",argumentCallback:function(e){return e-1}}),month:ft({values:{narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},defaultWidth:"wide"}),day:ft({values:{narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},defaultWidth:"wide"}),dayPeriod:ft({values:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},defaultWidth:"wide",formattingValues:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},defaultFormattingWidth:"wide"})},match:{ordinalNumber:vt({matchPattern:/^(\d+)(th|st|nd|rd)?/i,parsePattern:/\d+/i,valueCallback:function(e){return parseInt(e,10)}}),era:yt({matchPatterns:{narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^b/i,/^(a|c)/i]},defaultParseWidth:"any"}),quarter:yt({matchPatterns:{narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},defaultMatchWidth:"wide",parsePatterns:{any:[/1/i,/2/i,/3/i,/4/i]},defaultParseWidth:"any",valueCallback:function(e){return e+1}}),month:yt({matchPatterns:{narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},defaultParseWidth:"any"}),day:yt({matchPatterns:{narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},defaultParseWidth:"any"}),dayPeriod:yt({matchPatterns:{narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},defaultMatchWidth:"any",parsePatterns:{any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},defaultParseWidth:"any"})},options:{weekStartsOn:0,firstWeekContainsDate:1}},Nt=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,wt=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Ct=/^'([^]*?)'?$/,kt=/''/g,At=/[a-zA-Z]/;function St(e,t,a){var s,r,n,i,o,l,c,d,m,u,x,h,g,p,b,f,y,v;Te(2,arguments);var j=String(t),N=$e(),w=null!==(s=null!==(r=null==a?void 0:a.locale)&&void 0!==r?r:N.locale)&&void 0!==s?s:jt,C=Ie(null!==(n=null!==(i=null!==(o=null!==(l=null==a?void 0:a.firstWeekContainsDate)&&void 0!==l?l:null==a||null===(c=a.locale)||void 0===c||null===(d=c.options)||void 0===d?void 0:d.firstWeekContainsDate)&&void 0!==o?o:N.firstWeekContainsDate)&&void 0!==i?i:null===(m=N.locale)||void 0===m||null===(u=m.options)||void 0===u?void 0:u.firstWeekContainsDate)&&void 0!==n?n:1);if(!(C>=1&&C<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var k=Ie(null!==(x=null!==(h=null!==(g=null!==(p=null==a?void 0:a.weekStartsOn)&&void 0!==p?p:null==a||null===(b=a.locale)||void 0===b||null===(f=b.options)||void 0===f?void 0:f.weekStartsOn)&&void 0!==g?g:N.weekStartsOn)&&void 0!==h?h:null===(y=N.locale)||void 0===y||null===(v=y.options)||void 0===v?void 0:v.weekStartsOn)&&void 0!==x?x:0);if(!(k>=0&&k<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(!w.localize)throw new RangeError("locale must contain localize property");if(!w.formatLong)throw new RangeError("locale must contain formatLong property");var A=Me(e);if(!Fe(A))throw new RangeError("Invalid time value");var S=function(e){var t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return t.setUTCFullYear(e.getFullYear()),e.getTime()-t.getTime()}(A),D=Oe(A,S),P={firstWeekContainsDate:C,weekStartsOn:k,locale:w,_originalDate:A};return j.match(wt).map(function(e){var t=e[0];return"p"===t||"P"===t?(0,dt[t])(e,w.formatLong):e}).join("").match(Nt).map(function(s){if("''"===s)return"'";var r=s[0];if("'"===r)return function(e){var t=e.match(Ct);if(!t)return e;return t[1].replace(kt,"'")}(s);var n,i=rt[r];if(i)return null!=a&&a.useAdditionalWeekYearTokens||(n=s,-1===ut.indexOf(n))||xt(s,t,String(e)),null!=a&&a.useAdditionalDayOfYearTokens||!function(e){return-1!==mt.indexOf(e)}(s)||xt(s,t,String(e)),i(D,s,w.localize,P);if(r.match(At))throw new RangeError("Format string contains an unescaped latin alphabet character `"+r+"`");return s}).join("")}var Dt={lessThanXSeconds:{one:"menos de un segundo",other:"menos de {{count}} segundos"},xSeconds:{one:"1 segundo",other:"{{count}} segundos"},halfAMinute:"medio minuto",lessThanXMinutes:{one:"menos de un minuto",other:"menos de {{count}} minutos"},xMinutes:{one:"1 minuto",other:"{{count}} minutos"},aboutXHours:{one:"alrededor de 1 hora",other:"alrededor de {{count}} horas"},xHours:{one:"1 hora",other:"{{count}} horas"},xDays:{one:"1 día",other:"{{count}} días"},aboutXWeeks:{one:"alrededor de 1 semana",other:"alrededor de {{count}} semanas"},xWeeks:{one:"1 semana",other:"{{count}} semanas"},aboutXMonths:{one:"alrededor de 1 mes",other:"alrededor de {{count}} meses"},xMonths:{one:"1 mes",other:"{{count}} meses"},aboutXYears:{one:"alrededor de 1 año",other:"alrededor de {{count}} años"},xYears:{one:"1 año",other:"{{count}} años"},overXYears:{one:"más de 1 año",other:"más de {{count}} años"},almostXYears:{one:"casi 1 año",other:"casi {{count}} años"}},Pt={date:gt({formats:{full:"EEEE, d 'de' MMMM 'de' y",long:"d 'de' MMMM 'de' y",medium:"d MMM y",short:"dd/MM/y"},defaultWidth:"full"}),time:gt({formats:{full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},defaultWidth:"full"}),dateTime:gt({formats:{full:"{{date}} 'a las' {{time}}",long:"{{date}} 'a las' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},defaultWidth:"full"})},It={lastWeek:"'el' eeee 'pasado a la' p",yesterday:"'ayer a la' p",today:"'hoy a la' p",tomorrow:"'mañana a la' p",nextWeek:"eeee 'a la' p",other:"P"},Tt={lastWeek:"'el' eeee 'pasado a las' p",yesterday:"'ayer a las' p",today:"'hoy a las' p",tomorrow:"'mañana a las' p",nextWeek:"eeee 'a las' p",other:"P"},Mt={code:"es",formatDistance:function(e,t,a){var s,r=Dt[e];return s="string"==typeof r?r:1===t?r.one:r.other.replace("{{count}}",t.toString()),null!=a&&a.addSuffix?a.comparison&&a.comparison>0?"en "+s:"hace "+s:s},formatLong:Pt,formatRelative:function(e,t,a,s){return 1!==t.getUTCHours()?Tt[e]:It[e]},localize:{ordinalNumber:function(e,t){return Number(e)+"º"},era:ft({values:{narrow:["AC","DC"],abbreviated:["AC","DC"],wide:["antes de cristo","después de cristo"]},defaultWidth:"wide"}),quarter:ft({values:{narrow:["1","2","3","4"],abbreviated:["T1","T2","T3","T4"],wide:["1º trimestre","2º trimestre","3º trimestre","4º trimestre"]},defaultWidth:"wide",argumentCallback:function(e){return Number(e)-1}}),month:ft({values:{narrow:["e","f","m","a","m","j","j","a","s","o","n","d"],abbreviated:["ene","feb","mar","abr","may","jun","jul","ago","sep","oct","nov","dic"],wide:["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"]},defaultWidth:"wide"}),day:ft({values:{narrow:["d","l","m","m","j","v","s"],short:["do","lu","ma","mi","ju","vi","sá"],abbreviated:["dom","lun","mar","mié","jue","vie","sáb"],wide:["domingo","lunes","martes","miércoles","jueves","viernes","sábado"]},defaultWidth:"wide"}),dayPeriod:ft({values:{narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"mañana",afternoon:"tarde",evening:"tarde",night:"noche"},abbreviated:{am:"AM",pm:"PM",midnight:"medianoche",noon:"mediodia",morning:"mañana",afternoon:"tarde",evening:"tarde",night:"noche"},wide:{am:"a.m.",pm:"p.m.",midnight:"medianoche",noon:"mediodia",morning:"mañana",afternoon:"tarde",evening:"tarde",night:"noche"}},defaultWidth:"wide",formattingValues:{narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"de la mañana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"},abbreviated:{am:"AM",pm:"PM",midnight:"medianoche",noon:"mediodia",morning:"de la mañana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"},wide:{am:"a.m.",pm:"p.m.",midnight:"medianoche",noon:"mediodia",morning:"de la mañana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"}},defaultFormattingWidth:"wide"})},match:{ordinalNumber:vt({matchPattern:/^(\d+)(º)?/i,parsePattern:/\d+/i,valueCallback:function(e){return parseInt(e,10)}}),era:yt({matchPatterns:{narrow:/^(ac|dc|a|d)/i,abbreviated:/^(a\.?\s?c\.?|a\.?\s?e\.?\s?c\.?|d\.?\s?c\.?|e\.?\s?c\.?)/i,wide:/^(antes de cristo|antes de la era com[uú]n|despu[eé]s de cristo|era com[uú]n)/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^ac/i,/^dc/i],wide:[/^(antes de cristo|antes de la era com[uú]n)/i,/^(despu[eé]s de cristo|era com[uú]n)/i]},defaultParseWidth:"any"}),quarter:yt({matchPatterns:{narrow:/^[1234]/i,abbreviated:/^T[1234]/i,wide:/^[1234](º)? trimestre/i},defaultMatchWidth:"wide",parsePatterns:{any:[/1/i,/2/i,/3/i,/4/i]},defaultParseWidth:"any",valueCallback:function(e){return e+1}}),month:yt({matchPatterns:{narrow:/^[efmajsond]/i,abbreviated:/^(ene|feb|mar|abr|may|jun|jul|ago|sep|oct|nov|dic)/i,wide:/^(enero|febrero|marzo|abril|mayo|junio|julio|agosto|septiembre|octubre|noviembre|diciembre)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^e/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^en/i,/^feb/i,/^mar/i,/^abr/i,/^may/i,/^jun/i,/^jul/i,/^ago/i,/^sep/i,/^oct/i,/^nov/i,/^dic/i]},defaultParseWidth:"any"}),day:yt({matchPatterns:{narrow:/^[dlmjvs]/i,short:/^(do|lu|ma|mi|ju|vi|s[áa])/i,abbreviated:/^(dom|lun|mar|mi[ée]|jue|vie|s[áa]b)/i,wide:/^(domingo|lunes|martes|mi[ée]rcoles|jueves|viernes|s[áa]bado)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^d/i,/^l/i,/^m/i,/^m/i,/^j/i,/^v/i,/^s/i],any:[/^do/i,/^lu/i,/^ma/i,/^mi/i,/^ju/i,/^vi/i,/^sa/i]},defaultParseWidth:"any"}),dayPeriod:yt({matchPatterns:{narrow:/^(a|p|mn|md|(de la|a las) (mañana|tarde|noche))/i,any:/^([ap]\.?\s?m\.?|medianoche|mediodia|(de la|a las) (mañana|tarde|noche))/i},defaultMatchWidth:"any",parsePatterns:{any:{am:/^a/i,pm:/^p/i,midnight:/^mn/i,noon:/^md/i,morning:/mañana/i,afternoon:/tarde/i,evening:/tarde/i,night:/noche/i}},defaultParseWidth:"any"})},options:{weekStartsOn:1,firstWeekContainsDate:1}};const Et=({onMenuClick:e,showMenu:t})=>{const a=n(),s=i(),{isOnline:o,lastSync:l}=Pe(),[c,d]=r.useState(new Date);r.useEffect(()=>{const e=setInterval(()=>d(new Date),1e3);return()=>clearInterval(e)},[]);return Ce.jsx("header",{className:"bg-white border-b border-gray-200 shadow-sm",children:Ce.jsxs("div",{className:"flex items-center justify-between h-16 px-6",children:[Ce.jsxs("div",{className:"flex items-center space-x-4",children:[t&&Ce.jsx("button",{onClick:e,className:"p-2 rounded-lg text-gray-600 hover:bg-gray-100 lg:hidden",children:Ce.jsx(m,{className:"w-5 h-5"})}),Ce.jsxs("div",{className:"flex items-center space-x-3",children:[Ce.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-primary-500 to-primary-600 rounded-lg flex items-center justify-center",children:Ce.jsx("span",{className:"text-white font-bold text-sm",children:"K"})}),Ce.jsx("div",{children:Ce.jsx("h1",{className:"text-xl font-bold text-gray-900",children:(()=>{switch(s.pathname){case"/":return"Punto de Venta";case"/products":return"Productos";case"/categories":return"Categorías";case"/tables":return"Mesas y Salones";case"/orders":return"Pedidos";case"/configuration":return"Configuración";default:return"KimiPOS"}})()})})]})]}),Ce.jsxs("div",{className:"hidden md:flex items-center space-x-6",children:[Ce.jsxs("div",{className:"flex items-center space-x-2",children:[o?Ce.jsx(u,{className:"w-4 h-4 text-green-600"}):Ce.jsx(x,{className:"w-4 h-4 text-red-600"}),Ce.jsx("span",{className:"text-sm font-medium "+(o?"text-green-600":"text-red-600"),children:o?"En línea":"Sin conexión"})]}),l&&Ce.jsxs("div",{className:"flex items-center space-x-2 text-gray-600",children:[Ce.jsx(h,{className:"w-4 h-4"}),Ce.jsxs("span",{className:"text-sm",children:["Sync: ",St(l,"HH:mm",{locale:Mt})]})]})]}),Ce.jsxs("div",{className:"flex items-center space-x-4",children:[Ce.jsxs("div",{className:"hidden sm:flex items-center space-x-2 text-gray-600",children:[Ce.jsx(h,{className:"w-4 h-4"}),Ce.jsx("span",{className:"text-sm font-medium",children:St(c,"HH:mm:ss",{locale:Mt})})]}),Ce.jsxs("div",{className:"flex items-center space-x-2",children:["/"!==s.pathname&&Ce.jsx("button",{onClick:()=>a("/"),className:"p-2 rounded-lg text-gray-600 hover:bg-gray-100 transition-colors",title:"Ir al POS",children:Ce.jsx(g,{className:"w-5 h-5"})}),"/configuration"!==s.pathname&&Ce.jsx("button",{onClick:()=>a("/configuration"),className:"p-2 rounded-lg text-gray-600 hover:bg-gray-100 transition-colors",title:"Configuración",children:Ce.jsx(p,{className:"w-5 h-5"})})]}),Ce.jsxs("div",{className:"flex items-center space-x-2 bg-gray-100 rounded-lg px-3 py-2",children:[Ce.jsx(b,{className:"w-4 h-4 text-gray-600"}),Ce.jsx("span",{className:"text-sm font-medium text-gray-900",children:"Administrador"})]})]})]})})},$t=({isOpen:e,onClose:t})=>{const a=i(),s=[{name:"Punto de Venta",href:"/",icon:g,description:"Interfaz principal del POS"},{name:"Productos",href:"/products",icon:f,description:"Gestión de productos"},{name:"Modificadores",href:"/modifiers",icon:y,description:"Gestión de modificadores"},{name:"Categorías",href:"/categories",icon:v,description:"Organización de categorías"},{name:"Mesas y Salones",href:"/configuration/salons",icon:j,description:"Editor de salones y mesas"},{name:"Pedidos",href:"/orders",icon:N,description:"Historial de pedidos"},{name:"Clientes",href:"/customers",icon:w,description:"Base de datos de clientes"},{name:"Incentivos de Saldo",href:"/configuration/incentives",icon:C,description:"Configuración de incentivos"},{name:"Reportes",href:"/reports",icon:k,description:"Análisis y estadísticas"},{name:"Facturas",href:"/invoices",icon:A,description:"Gestión de facturas"},{name:"Configuración",href:"/configuration",icon:p,description:"Configuración del sistema"}];return Ce.jsxs(Ce.Fragment,{children:[Ce.jsx("div",{className:"hidden lg:flex lg:flex-shrink-0",children:Ce.jsx("div",{className:"flex flex-col w-64",children:Ce.jsxs("div",{className:"flex flex-col flex-grow bg-white border-r border-gray-200 pt-5 pb-4 overflow-y-auto",children:[Ce.jsxs("div",{className:"flex items-center flex-shrink-0 px-4 mb-8",children:[Ce.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-primary-500 to-primary-600 rounded-xl flex items-center justify-center",children:Ce.jsx("span",{className:"text-white font-bold text-lg",children:"K"})}),Ce.jsxs("div",{className:"ml-3",children:[Ce.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"KimiPOS"}),Ce.jsx("p",{className:"text-sm text-gray-500",children:"Sistema de Gestión"})]})]}),Ce.jsx("nav",{className:"flex-1 px-2 space-y-1",children:s.map(e=>{const t=e.icon,s=a.pathname===e.href;return Ce.jsxs(o,{to:e.href,className:"group flex items-center px-2 py-3 text-sm font-medium rounded-lg transition-all duration-200 "+(s?"bg-primary-50 text-primary-700 border-r-2 border-primary-500":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"),children:[Ce.jsx(t,{className:"mr-3 h-5 w-5 transition-colors "+(s?"text-primary-500":"text-gray-400 group-hover:text-gray-500")}),Ce.jsxs("div",{className:"flex-1",children:[Ce.jsx("div",{className:"font-medium "+(s?"text-primary-700":""),children:e.name}),Ce.jsx("div",{className:"text-xs text-gray-500 mt-0.5",children:e.description})]})]},e.name)})})]})})}),Ce.jsx("div",{className:"lg:hidden fixed inset-y-0 left-0 z-50 w-64 bg-white transform transition-transform duration-300 ease-in-out "+(e?"translate-x-0":"-translate-x-full"),children:Ce.jsxs("div",{className:"flex flex-col h-full",children:[Ce.jsxs("div",{className:"flex items-center justify-between h-16 px-4 border-b border-gray-200",children:[Ce.jsxs("div",{className:"flex items-center",children:[Ce.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-primary-500 to-primary-600 rounded-lg flex items-center justify-center",children:Ce.jsx("span",{className:"text-white font-bold text-sm",children:"K"})}),Ce.jsx("div",{className:"ml-3",children:Ce.jsx("h2",{className:"text-lg font-bold text-gray-900",children:"KimiPOS"})})]}),Ce.jsx("button",{onClick:t,className:"p-2 rounded-lg text-gray-600 hover:bg-gray-100",children:Ce.jsx(S,{className:"w-5 h-5"})})]}),Ce.jsx("nav",{className:"flex-1 px-2 py-4 space-y-1 overflow-y-auto",children:s.map(e=>{const s=e.icon,r=a.pathname===e.href;return Ce.jsxs(o,{to:e.href,onClick:t,className:"group flex items-center px-2 py-3 text-sm font-medium rounded-lg transition-all duration-200 "+(r?"bg-primary-50 text-primary-700":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"),children:[Ce.jsx(s,{className:"mr-3 h-5 w-5 transition-colors "+(r?"text-primary-500":"text-gray-400 group-hover:text-gray-500")}),Ce.jsxs("div",{className:"flex-1",children:[Ce.jsx("div",{className:"font-medium "+(r?"text-primary-700":""),children:e.name}),Ce.jsx("div",{className:"text-xs text-gray-500 mt-0.5",children:e.description})]})]},e.name)})})]})})]})},Ft=({children:e})=>{const[t,s]=a.useState(!1),{isReady:r}=Pe(),n=i();if(!r)return Ce.jsx("div",{className:"h-full flex items-center justify-center bg-gray-50",children:Ce.jsxs("div",{className:"text-center",children:[Ce.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto mb-4"}),Ce.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Inicializando KimiPOS"}),Ce.jsx("p",{className:"text-gray-600",children:"Preparando la base de datos..."})]})});const o="/"===n.pathname;return Ce.jsxs("div",{className:"h-full flex",children:[!o&&Ce.jsxs(Ce.Fragment,{children:[Ce.jsx($t,{isOpen:t,onClose:()=>s(!1)}),t&&Ce.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40 lg:hidden",onClick:()=>s(!1)})]}),Ce.jsxs("div",{className:"flex-1 flex flex-col",children:[Ce.jsx(Et,{onMenuClick:()=>s(!t),showMenu:!o}),Ce.jsx("main",{className:"flex-1 overflow-hidden",children:e})]})]})},Ot=({visible:e,currentRotation:t,onRotationChange:s,elementRect:r})=>{const[n,i]=a.useState(!1),o=a.useRef(null);return e?Ce.jsx("div",{ref:o,className:"rotation-handle absolute z-50 w-8 h-8 bg-blue-500 hover:bg-blue-600 rounded-full flex items-center justify-center cursor-grab shadow-xl border-2 border-white transition-all duration-200 "+(n?"cursor-grabbing scale-125 bg-blue-600":"hover:scale-110"),style:{left:r.width-10,top:-10,transform:"translate(-50%, -50%)"},onMouseDown:e=>{e.preventDefault(),e.stopPropagation(),i(!0);let a=e.clientX,r=t;const n=e=>{const t=e.clientX-a;r+=1*t;s((r%360+360)%360),a=e.clientX},o=()=>{i(!1);const e=15*Math.round(r/15);s((e%360+360)%360),document.removeEventListener("mousemove",n),document.removeEventListener("mouseup",o)};document.addEventListener("mousemove",n),document.addEventListener("mouseup",o)},title:`Rotar elemento (${Math.round(t)}°)`,children:Ce.jsx(D,{className:"w-4 h-4 text-white"})}):null},zt=a.createContext(void 0),Rt=({children:e})=>{const[t,s]=a.useState([]),[r,n]=a.useState("salon-1");a.useEffect(()=>{try{const e=localStorage.getItem("kimipos_salons"),t=localStorage.getItem("kimipos_active_salon");if(e){const t=JSON.parse(e).map(e=>({...e,tables:(e.tables||[]).map(e=>({...e,rotation:e.rotation||0,occupiedSince:e.occupiedSince?new Date(e.occupiedSince):void 0})),decor:(e.decor||[]).map(e=>({id:e.id,kind:(e.kind||e.type)??"plant",x:e.x??100,y:e.y??100,rotation:e.rotation||0,width:e.width,height:e.height}))}));if(!t.some(e=>"named-accounts"===e.id)){const e={id:"named-accounts",name:"Cuentas por nombre",width:800,height:600,tables:[],decor:[]};t.push(e)}s(t)}else{s([{id:"salon-1",name:"Salón Principal",width:800,height:600,tables:[{id:"1",number:"1",name:"Entrada",status:"available",x:100,y:100,capacity:4},{id:"2",number:"2",name:"Ventana",status:"available",x:250,y:120,capacity:2},{id:"3",number:"3",name:"Central",status:"available",x:180,y:250,capacity:6},{id:"4",number:"4",name:"Terraza",status:"available",x:350,y:200,capacity:4},{id:"5",number:"5",name:"VIP",status:"available",x:120,y:350,capacity:8},{id:"6",number:"6",status:"available",x:300,y:320,capacity:2}],decor:[]},{id:"named-accounts",name:"Cuentas por nombre",width:800,height:600,tables:[],decor:[]}])}t&&n(t)}catch{}},[]),a.useEffect(()=>{if(t.length>0)try{localStorage.setItem("kimipos_salons",JSON.stringify(t)),localStorage.setItem("kimipos_active_salon",r)}catch{}},[t,r]);const[i,o]=a.useState({}),[l,c]=a.useState({});a.useEffect(()=>{try{const e=localStorage.getItem("kimipos_table_orders");if(e){const t=JSON.parse(e);o(t)}else o({2:[{productId:"1",productName:"Coca Cola",quantity:2,unitPrice:25,totalPrice:50,status:"pending"},{productId:"3",productName:"Corona",quantity:1,unitPrice:45,totalPrice:45,status:"pending"},{productId:"5",productName:"Jack Daniels",quantity:1,unitPrice:120,totalPrice:120,status:"pending"}]})}catch{}},[]),a.useEffect(()=>{if(Object.keys(i).length>0)try{localStorage.setItem("kimipos_table_orders",JSON.stringify(i))}catch{}},[i]);const d=t.find(e=>e.id===r)||t[0],m=e=>{for(const a of t){const t=a.tables.find(t=>t.id===e);if(t)return t}},u=e=>i[e]||[],x=e=>{const t=m(e);return t&&t.mergeGroup?(null==d?void 0:d.tables.filter(e=>e.mergeGroup===t.mergeGroup))||[]:[t]},h=e=>{s(t=>t.map(t=>"named-accounts"!==t.id?t:{...t,tables:t.tables.filter(t=>t.id!==e)})),o(t=>{const a={...t};return delete a[e],a})},g={salons:t,activeSalonId:r,setActiveSalon:n,tables:(null==d?void 0:d.tables)||[],decor:(null==d?void 0:d.decor)||[],addSalon:(e=`Salón ${t.length+1}`)=>{const a=`salon-${Date.now()}`;return s(t=>[...t,{id:a,name:e,width:800,height:600,tables:[],decor:[]}]),n(a),a},removeSalon:e=>{s(t=>t.filter(t=>t.id!==e)),r===e&&t.length>1&&n(t[0].id)},renameSalon:(e,t)=>{s(a=>a.map(a=>a.id===e?{...a,name:t}:a))},updateTableStatus:(e,t,a)=>{const n=e.startsWith("account-")?"named-accounts":r;s(s=>s.map(s=>s.id!==n?s:{...s,tables:s.tables.map(s=>s.id===e?{...s,status:t,occupiedSince:"occupied"===t?new Date:void 0,currentOrder:a||s.currentOrder}:s)}))},addOrderToTable:(e,t,a,n,i=!1)=>{const l=e.startsWith("account-")?"named-accounts":r,c=u(e),d=a?i?a:[...c,...a]:c,m=d.reduce((e,t)=>e+t.totalPrice,0);s(t=>t.map(t=>t.id!==l?t:{...t,tables:t.tables.map(t=>t.id===e?{...t,status:"occupied",occupiedSince:new Date,currentOrder:{id:`order-${Date.now()}`,total:m,itemCount:d.length},assignedCustomer:n||t.assignedCustomer,temporaryName:n?void 0:t.temporaryName}:t)})),a&&o(t=>({...t,[e]:d}))},clearTableOrder:e=>{const t=m(e);let a=[e];if(t&&t.mergeGroup){const t=x(e);a=t.map(e=>e.id)}if(e.startsWith("account-"))return void h(e);const n=e.startsWith("account-")?"named-accounts":r;s(e=>e.map(e=>e.id!==n?e:{...e,tables:e.tables.map(e=>a.includes(e.id)?{...e,status:"available",occupiedSince:void 0,currentOrder:void 0,temporaryName:void 0,assignedCustomer:void 0,mergedWith:void 0,isMaster:void 0,mergeGroup:void 0}:e)})),o(e=>{const t={...e};return a.forEach(e=>{delete t[e]}),t})},getTableById:m,getTableOrderItems:u,addTable:e=>{s(t=>t.map(t=>{if(t.id!==r)return t;const a=new Set(t.tables.map(e=>parseInt(e.number)).filter(e=>!Number.isNaN(e)));let s=Number.isNaN(parseInt(e.number))?1:parseInt(e.number);for(;a.has(s);)s+=1;const n=e.id||`table-${Date.now()}`;return{...t,tables:[...t.tables,{...e,id:n,number:String(s)}]}}))},removeTable:e=>{const t=m(e);return(!t||"occupied"!==t.status)&&(s(t=>t.map(t=>t.id!==r?t:{...t,tables:t.tables.filter(t=>t.id!==e)})),o(t=>{const a={...t};return delete a[e],a}),!0)},updateTablePosition:(e,t,a)=>{const n=isNaN(t)?100:t,i=isNaN(a)?100:a;s(t=>t.map(t=>t.id!==r?t:{...t,tables:t.tables.map(t=>t.id===e?{...t,x:n,y:i}:t)}))},updateTableRotation:(e,t)=>{const a=isNaN(t)?0:t;s(t=>t.map(t=>t.id!==r?t:{...t,tables:t.tables.map(t=>t.id===e?{...t,rotation:a}:t)}))},mergeTables:(e,t)=>{const a=m(e);let n=null==a?void 0:a.mergeGroup;n||(n=`merge-${e}-${Date.now()}`),s(a=>a.map(a=>a.id!==r?a:{...a,tables:a.tables.map(a=>a.id===e?{...a,mergedWith:t,isMaster:!0,mergeGroup:n}:a.id===t?{...a,mergedWith:e,isMaster:!1,mergeGroup:n}:a)}));const i=[...u(e),...u(t)];if(i.length>0){const a=i.reduce((e,t)=>e+t.totalPrice,0);s(t=>t.map(t=>t.id!==r?t:{...t,tables:t.tables.map(t=>t.id===e?{...t,status:"occupied",currentOrder:{id:`merged-order-${Date.now()}`,total:a,itemCount:i.length}}:t)})),o(a=>({...a,[e]:i,[t]:[]}))}},unmergeTables:e=>{const t=m(e);if(!t||!t.mergedWith)return;const a=t.mergedWith;s(t=>t.map(t=>t.id!==r?t:{...t,tables:t.tables.map(t=>t.id===e||t.id===a?{...t,mergedWith:void 0,isMaster:void 0,mergeGroup:void 0}:t)})),t.isMaster||o(t=>{const a={...t};return delete a[e],a})},forceUnmergeTable:e=>{s(t=>t.map(t=>t.id!==r?t:{...t,tables:t.tables.map(t=>t.id===e?{...t,mergedWith:void 0,isMaster:void 0,mergeGroup:void 0}:t)}))},getTableMergeGroup:x,updateTableTemporaryName:(e,t)=>{s(a=>a.map(a=>a.id!==r?a:{...a,tables:a.tables.map(a=>a.id===e?{...a,temporaryName:t}:a)}))},addDecor:e=>{s(t=>t.map(t=>t.id!==r?t:{...t,decor:[...t.decor,e]}))},updateDecorPosition:(e,t,a)=>{s(s=>s.map(s=>s.id!==r?s:{...s,decor:s.decor.map(s=>s.id===e?{...s,x:t,y:a}:s)}))},updateDecorRotation:(e,t)=>{const a=isNaN(t)?0:t;s(t=>t.map(t=>t.id!==r?t:{...t,decor:t.decor.map(t=>t.id===e?{...t,rotation:a}:t)}))},addNamedAccount:e=>{var a,r;if(null==(a=t.find(e=>"named-accounts"===e.id))?void 0:a.tables.find(t=>t.name===e))throw new Error(`Ya existe una cuenta para ${e}`);const n=(null==(r=t.find(e=>"named-accounts"===e.id))?void 0:r.tables)||[],i=Math.floor(n.length/4),o=n.length%4,l=`account-${Date.now()}`,c={id:l,number:e,name:e,status:"occupied",x:120+120*o,y:120+120*i,capacity:1,occupiedSince:new Date,temporaryName:e};return s(e=>e.map(e=>"named-accounts"!==e.id?e:{...e,tables:[...e.tables,c]})),l},removeNamedAccount:h,addPartialPayment:(e,t,a)=>{const s={id:`payment-${Date.now()}`,tableId:e,amount:t,paymentMethod:a,date:new Date,receiptNumber:`R${Date.now()}`};return c(t=>({...t,[e]:[...t[e]||[],s]})),s},getPartialPayments:e=>l[e]||[],getTotalPartialPayments:e=>(l[e]||[]).reduce((e,t)=>e+t.amount,0),clearPartialPayments:e=>{c(t=>{const a={...t};return delete a[e],a})},updateTableTotalAfterPartialPayment:(e,t)=>{var a;const n=e.startsWith("account-")?"named-accounts":r,i=m(e);if(!i)return;const o=(null==(a=i.currentOrder)?void 0:a.total)||0,l=Math.max(0,o-t);s(t=>t.map(t=>t.id!==n?t:{...t,tables:t.tables.map(t=>t.id===e?{...t,currentOrder:{...t.currentOrder,total:l}}:t)}))}};return Ce.jsx(zt.Provider,{value:g,children:e})},Wt=()=>{const e=a.useContext(zt);if(void 0===e)throw new Error("useTables must be used within a TableProvider");return e},Lt=({table:e,isSelected:t=!1,onClick:s,onLongPress:r,onDragStart:n,onDragEnd:i,onRotationChange:o,onDelete:l,showDeleteButton:c=!1,isDraggable:d=!1,scale:m=1})=>{const{getTotalPartialPayments:u}=Wt(),[x,g]=a.useState(!1),[p,b]=a.useState(!1),[f,y]=a.useState({x:0,y:0}),[v,j]=a.useState({x:isNaN(e.x)?100:e.x,y:isNaN(e.y)?100:e.y}),[N,C]=a.useState(e.rotation||0),k=a.useRef(null),[A,S]=a.useState(null),[D,P]=a.useState(!1);a.useEffect(()=>{j({x:isNaN(e.x)?100:e.x,y:isNaN(e.y)?100:e.y}),C(e.rotation||0)},[e.x,e.y,e.rotation]);const I=t=>{A&&clearTimeout(A);const a=setTimeout(()=>{P(!0),null==r||r(e)},1e3);S(a)},T=()=>{A&&(clearTimeout(A),S(null)),P(!1)},M=e=>{if(!x||!d)return;e.preventDefault();const t=document.querySelector(".relative");if(!t)return;const a=t.getBoundingClientRect(),s=a.width,r=a.height,n=(e.clientX-f.x)/m,i=(e.clientY-f.y)/m,o=(s-$)/m,l=(r-$)/m,c=Math.max(0,Math.min(n,o)),u=Math.max(0,Math.min(i,l));isNaN(c)||isNaN(u)||j({x:c,y:u})},E=()=>{if(x){g(!1);const t=isNaN(v.x)?100:v.x,a=isNaN(v.y)?100:v.y;null==i||i(e,t,a)}else T()},$=80*m;return a.useEffect(()=>{if(x)return document.addEventListener("mousemove",M),document.addEventListener("mouseup",E),()=>{document.removeEventListener("mousemove",M),document.removeEventListener("mouseup",E)}},[x,f,m,$,v]),a.useEffect(()=>()=>{A&&clearTimeout(A)},[A]),Ce.jsxs("div",{ref:k,className:"absolute transition-all duration-200 "+(t?"ring-4 ring-primary-500":""),style:{left:isNaN(v.x)?100:v.x*m,top:isNaN(v.y)?100:v.y*m,width:$,height:$,cursor:d?x?"grabbing":"grab":"pointer",zIndex:x?1e3:1,transform:`rotate(${N}deg)`,transformOrigin:"center"},onClick:t=>{t.stopPropagation(),D||null==s||s(e)},onMouseDown:t=>{if(!d)return void I();t.target.closest(".rotation-handle")||(t.preventDefault(),t.stopPropagation(),g(!0),y({x:t.clientX-v.x*m,y:t.clientY-v.y*m}),null==n||n(e))},onMouseUp:E,onMouseEnter:()=>b(!0),onMouseLeave:()=>b(!1),onTouchStart:e=>{d||I()},onTouchEnd:()=>{x||T()},onContextMenu:t=>{t.preventDefault(),null==r||r(e)},children:[Ce.jsxs("div",{className:`w-full h-full border-2 shadow-lg flex flex-col items-center justify-center relative ${(()=>{if(e.id.startsWith("account-"))return"bg-yellow-100 border-yellow-400 text-yellow-800";if(e.mergeGroup)return(e=>{const t=["border-purple-400 bg-purple-100 text-purple-800","border-indigo-400 bg-indigo-100 text-indigo-800","border-pink-400 bg-pink-100 text-pink-800","border-orange-400 bg-orange-100 text-orange-800","border-cyan-400 bg-cyan-100 text-cyan-800","border-emerald-400 bg-emerald-100 text-emerald-800"],a=e.split("").reduce((e,t)=>(e=(e<<5)-e+t.charCodeAt(0))&e,0);return t[Math.abs(a)%t.length]})(e.mergeGroup);switch(e.status){case"available":return"bg-green-100 border-green-300 text-green-800";case"occupied":return"bg-red-100 border-red-300 text-red-800";case"reserved":return"bg-yellow-100 border-yellow-300 text-yellow-800";default:return"bg-gray-100 border-gray-300 text-gray-800"}})()} hover:shadow-xl transition-shadow ${e.id.startsWith("account-")?"rounded-lg":"rounded-full"}`,style:{pointerEvents:"none"},children:[Ce.jsx("div",{className:"text-lg font-bold",children:e.number}),e.temporaryName?Ce.jsx("div",{className:"text-sm font-bold text-center bg-blue-100 text-blue-800 px-2 py-1 rounded",children:e.temporaryName}):e.name?Ce.jsx("div",{className:"text-sm font-bold opacity-75 text-center",children:e.name}):null,e.assignedCustomer&&Ce.jsxs("div",{className:"text-xs font-medium text-center bg-green-100 text-green-800 px-2 py-1 rounded mt-1",children:["👤 ",e.assignedCustomer.name," ",e.assignedCustomer.lastName]}),e.mergedWith&&Ce.jsxs("div",{className:"absolute -top-2 -right-2 bg-blue-600 text-white text-xs px-2 py-1 rounded-full border-2 border-white shadow-lg",children:["🔗",e.mergedWith]}),e.mergeGroup&&e.isMaster&&Ce.jsx("div",{className:"absolute -left-2 -top-2 bg-yellow-500 text-white text-xs px-1.5 py-0.5 rounded-full border border-white shadow-sm",children:"★"}),"occupied"===e.status&&Ce.jsxs(Ce.Fragment,{children:[e.occupiedSince&&(!e.mergeGroup||e.isMaster)&&Ce.jsxs("div",{className:"absolute -top-6 left-1/2 transform -translate-x-1/2 bg-gradient-to-r from-red-600 to-rose-600 text-white text-xs font-bold px-2 py-1 rounded-md shadow-md border border-white flex items-center space-x-1",children:[Ce.jsx(h,{className:"w-3 h-3"}),Ce.jsx("span",{children:(()=>{if(!e.occupiedSince)return null;const t=(new Date).getTime()-e.occupiedSince.getTime(),a=Math.floor(t/6e4),s=Math.floor(a/60);return s>0?`${s}h ${a%60}m`:`${a}m`})()})]}),e.currentOrder&&(!e.mergeGroup||e.isMaster)&&Ce.jsxs("div",{className:"absolute -bottom-6 left-1/2 transform -translate-x-1/2 bg-black text-white text-xs font-bold px-2 py-1 rounded-md shadow-md border border-white",children:["€",(()=>{if(!e.currentOrder)return 0;const t=u(e.id);return Math.max(0,e.currentOrder.total-t)})().toFixed(2)]}),e.mergeGroup&&!e.isMaster&&Ce.jsx("div",{className:"absolute -bottom-6 left-1/2 transform -translate-x-1/2 bg-blue-600 text-white text-xs px-1 py-0.5 rounded-full",children:"🔗"})]}),e.capacity&&Ce.jsx("div",{className:"absolute -right-2 -top-2 bg-gray-600 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs",children:Ce.jsx(w,{className:"w-3 h-3"})}),Ce.jsx("div",{className:"absolute -right-1 -bottom-1 w-4 h-4 rounded-full border-2 border-white "+("available"===e.status?"bg-green-500":"occupied"===e.status?"bg-red-500":"bg-yellow-500")})]}),d&&p&&!x&&o&&Ce.jsx(Ot,{visible:!0,currentRotation:N,onRotationChange:t=>{C(t),null==o||o(e,t)},elementRect:{x:0,y:0,width:$,height:$}})]})},qt=({item:e,isSelected:t,isDraggable:s=!1,onDragEnd:r,onRotationChange:n})=>{const[i,o]=a.useState(!1),[l,c]=a.useState(!1),[d,m]=a.useState({x:0,y:0}),[u,x]=a.useState(e.rotation||0),h=a.useRef(null),g=t=>{if(!i||!s)return;const a=document.querySelector(".salon-canvas");if(a){const s=a.getBoundingClientRect(),n=Math.max(0,t.clientX-s.left-d.x),i=Math.max(0,t.clientY-s.top-d.y);null==r||r(e,n,i)}},p=()=>o(!1);return a.useEffect(()=>{x(e.rotation||0)},[e.rotation]),a.useEffect(()=>{if(i)return document.addEventListener("mousemove",g),document.addEventListener("mouseup",p),()=>{document.removeEventListener("mousemove",g),document.removeEventListener("mouseup",p)}},[i,d,e,s]),Ce.jsxs("div",{ref:h,className:`absolute ${t?"ring-2 ring-primary-500":""} `,style:{left:e.x,top:e.y,transform:`rotate(${u}deg)`,transformOrigin:"center"},onMouseDown:e=>{var t;if(!s)return;if(e.target.closest(".rotation-handle"))return;e.preventDefault(),o(!0);const a=null==(t=h.current)?void 0:t.getBoundingClientRect();a&&m({x:e.clientX-a.left,y:e.clientY-a.top})},onMouseEnter:()=>c(!0),onMouseLeave:()=>c(!1),children:["plant"===e.kind?Ce.jsx("img",{src:"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2024%2024'%20fill='none'%20stroke='currentColor'%20stroke-width='2'%20stroke-linecap='round'%20stroke-linejoin='round'%3e%3cpath%20d='M12%2022c4.97%200%209-4.03%209-9-4.97%200-9%204.03-9%209z'/%3e%3cpath%20d='M5.6%2010.6c0%201.07.27%202.13.8%203.07A7%207%200%200%200%207.02%2020A7%207%200%200%200%2012%2022c0-1.07-.27-2.13-.8-3.07-.48-.84-1.16-1.55-1.97-2.09A6.98%206.98%200%200%200%205.6%2010.6z'/%3e%3c/svg%3e",alt:"Planta",style:{width:e.width||80,height:e.height||110,pointerEvents:"none"},draggable:!1,className:"select-none drop-shadow"}):Ce.jsx("img",{src:"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2024%2024'%20fill='none'%20stroke='currentColor'%20stroke-width='2'%20stroke-linecap='round'%20stroke-linejoin='round'%3e%3crect%20x='2'%20y='4'%20width='20'%20height='16'%20rx='2'/%3e%3cline%20x1='6'%20y1='8'%20x2='18'%20y2='8'/%3e%3cline%20x1='6'%20y1='12'%20x2='18'%20y2='12'/%3e%3cline%20x1='6'%20y1='16'%20x2='14'%20y2='16'/%3e%3c/svg%3e",alt:"Barra de bar",style:{width:e.width||240,height:e.height||90,pointerEvents:"none"},draggable:!1,className:"select-none drop-shadow"}),s&&l&&!i&&n&&Ce.jsx(Ot,{visible:!0,currentRotation:u,onRotationChange:t=>{x(t),null==n||n(e,t)},elementRect:{x:0,y:0,width:e.width||("plant"===e.kind?80:240),height:e.height||("plant"===e.kind?110:90)}})]})},Bt=({tables:e,scale:t=1})=>{const a=e.reduce((e,t)=>(t.mergeGroup&&(e[t.mergeGroup]||(e[t.mergeGroup]=[]),e[t.mergeGroup].push(t)),e),{});return Ce.jsx("svg",{className:"absolute inset-0 pointer-events-none",style:{zIndex:5},width:"100%",height:"100%",children:Object.entries(a).map(([e,a])=>{if(a.length<2)return null;const s=(e=>{const t=["#8b5cf6","#6366f1","#ec4899","#f97316","#06b6d4","#10b981"],a=e.split("").reduce((e,t)=>(e=(e<<5)-e+t.charCodeAt(0))&e,0);return t[Math.abs(a)%t.length]})(e),r=a.find(e=>e.isMaster),n=a.filter(e=>!e.isMaster);if(!r)return null;const i=(r.x+40)*t,o=(r.y+40)*t;return n.map((a,r)=>{const n=(a.x+40)*t,l=(a.y+40)*t,c=(i+n)/2+.2*(o-l),d=(o+l)/2+.2*(n-i);return Ce.jsxs("g",{children:[Ce.jsx("path",{d:`M ${i} ${o} Q ${c} ${d} ${n} ${l}`,stroke:s,strokeWidth:"3",fill:"none",strokeDasharray:"6,4",opacity:"0.8"}),Ce.jsx("circle",{cx:n,cy:l,r:"4",fill:s,opacity:"0.9"}),Ce.jsx("circle",{cx:i,cy:o,r:"6",fill:"#fbbf24",opacity:"0.9"}),Ce.jsx("text",{x:i,y:o+2,textAnchor:"middle",fontSize:"8",fill:"white",fontWeight:"bold",children:"★"})]},`${e}-${r}`)})})})};const Gt=new class extends xe{constructor(){super("KimiPOSDatabase"),t(this,"categories"),t(this,"products"),t(this,"posTables"),t(this,"salons"),t(this,"orders"),t(this,"orderItems"),t(this,"customers"),t(this,"configuration"),t(this,"syncLogs"),t(this,"namedAccounts"),t(this,"balanceIncentives"),this.version(1).stores({categories:"++id, name, order, isActive, syncStatus",products:"++id, name, categoryId, isActive, price, syncStatus",posTables:"++id, number, salonId, status, currentOrderId, syncStatus",salons:"++id, name, isActive, syncStatus",orders:"++id, tableId, status, createdAt, syncStatus",orderItems:"++id, orderId, productId, status",customers:"++id, name, email, phone, syncStatus",configuration:"++id, key, category, syncStatus",syncLogs:"++id, table, recordId, status, createdAt"}),this.version(2).stores({namedAccounts:"++id, name, salonId, status, syncStatus"}),this.version(3).stores({customers:"++id, name, lastName, email, phone, cardCode, syncStatus"}),this.version(4).stores({balanceIncentives:"++id, customerPayment, totalBalance, isActive, syncStatus"}),this.version(5).stores({balanceIncentives:"++id, customerPayment, totalBalance, isActive, syncStatus"}),this.categories.hook("creating",function(e,t,a){t.createdAt=new Date,t.updatedAt=new Date,t.syncStatus="pending"}),this.categories.hook("updating",function(e,t,a,s){e.updatedAt=new Date,e.syncStatus="pending"}),this.products.hook("creating",function(e,t,a){t.createdAt=new Date,t.updatedAt=new Date,t.syncStatus="pending"}),this.products.hook("updating",function(e,t,a,s){e.updatedAt=new Date,e.syncStatus="pending"}),this.posTables.hook("creating",function(e,t,a){t.createdAt=new Date,t.updatedAt=new Date,t.syncStatus="pending"}),this.posTables.hook("updating",function(e,t,a,s){e.updatedAt=new Date,e.syncStatus="pending"}),this.salons.hook("creating",function(e,t,a){t.createdAt=new Date,t.updatedAt=new Date,t.syncStatus="pending"}),this.salons.hook("updating",function(e,t,a,s){e.updatedAt=new Date,e.syncStatus="pending"}),this.customers.hook("creating",function(e,t,a){t.createdAt=new Date,t.updatedAt=new Date,t.syncStatus="pending"}),this.customers.hook("updating",function(e,t,a,s){e.updatedAt=new Date,e.syncStatus="pending"}),this.orders.hook("creating",function(e,t,a){t.createdAt=new Date,t.updatedAt=new Date,t.syncStatus="pending"}),this.orders.hook("updating",function(e,t,a,s){e.updatedAt=new Date,e.syncStatus="pending"}),this.customers.hook("creating",function(e,t,a){t.createdAt=new Date,t.updatedAt=new Date,t.syncStatus="pending"}),this.customers.hook("updating",function(e,t,a,s){e.updatedAt=new Date,e.syncStatus="pending"}),this.configuration.hook("creating",function(e,t,a){t.updatedAt=new Date,t.syncStatus="pending"}),this.configuration.hook("updating",function(e,t,a,s){e.updatedAt=new Date,e.syncStatus="pending"}),this.syncLogs.hook("creating",function(e,t,a){t.createdAt=new Date}),this.namedAccounts.hook("creating",function(e,t,a){t.createdAt=new Date,t.updatedAt=new Date,t.syncStatus="pending"}),this.namedAccounts.hook("updating",function(e,t,a,s){e.updatedAt=new Date,e.syncStatus="pending"}),this.balanceIncentives.hook("creating",function(e,t,a){t.createdAt=new Date,t.updatedAt=new Date,t.syncStatus="pending"}),this.balanceIncentives.hook("updating",function(e,t,a,s){e.updatedAt=new Date,e.syncStatus="pending"})}async addSyncLog(e,t,a,s){return await this.syncLogs.add({table:e,recordId:t,action:a,data:s,status:"pending",attempts:0,createdAt:new Date})}async getPendingSyncLogs(){return await this.syncLogs.where("status").equals("pending").toArray()}async markSyncSuccess(e){return await this.syncLogs.update(e,{status:"success",lastAttempt:new Date})}async markSyncError(e,t){const a=await this.syncLogs.get(e);if(a)return await this.syncLogs.update(e,{status:"error",error:t,attempts:a.attempts+1,lastAttempt:new Date})}},Ut=a.createContext(void 0),Yt=()=>{const e=a.useContext(Ut);if(!e)throw new Error("useCustomers must be used within a CustomerProvider");return e},Ht=({children:e})=>{const[t,s]=a.useState([]),r=async()=>{try{const e=await Gt.customers.toArray();s(e)}catch(e){P.error("Error al cargar los clientes")}};a.useEffect(()=>{r()},[]);const n={customers:t,addCustomer:async e=>{try{if(e.cardCode){if(await Gt.customers.where("cardCode").equals(e.cardCode).first())return void P.error("Ya existe un cliente con ese código de tarjeta")}const t={...e,id:Date.now().toString(),createdAt:new Date,updatedAt:new Date};await Gt.customers.add(t),await r(),P.success("Cliente agregado exitosamente")}catch(t){P.error("Error al agregar el cliente")}},updateCustomer:async(e,t)=>{try{if(t.cardCode){if(await Gt.customers.where("cardCode").equals(t.cardCode).filter(t=>t.id!==e).first())return void P.error("Ya existe un cliente con ese código de tarjeta")}const a={...t,updatedAt:new Date};await Gt.customers.update(e,a),await r(),P.success("Cliente actualizado exitosamente")}catch(a){P.error("Error al actualizar el cliente")}},deleteCustomer:async e=>{try{const t=await Gt.customers.get(e);if(t){if(await Gt.orders.where("customerName").equals(t.name).count()>0)return void P.error("No se puede eliminar el cliente porque tiene pedidos asociados")}await Gt.customers.delete(e),await r(),P.success("Cliente eliminado exitosamente")}catch(t){P.error("Error al eliminar el cliente")}},searchCustomers:e=>{if(!e.trim())return t;const a=e.toLowerCase();return t.filter(e=>e.name.toLowerCase().includes(a)||e.lastName.toLowerCase().includes(a)||e.email.toLowerCase().includes(a)||e.phone.toLowerCase().includes(a)||e.cardCode.toLowerCase().includes(a))},loadCustomers:r,refreshCustomers:async()=>{await r()},getCustomerById:e=>t.find(t=>t.id===e),getCustomerByCardCode:e=>t.find(t=>t.cardCode===e)};return Ce.jsx(Ut.Provider,{value:n,children:e})},Xt=({selectedCustomer:e,onCustomerSelect:t,placeholder:s="Seleccionar cliente..."})=>{const[r,i]=a.useState(!1),[o,l]=a.useState(""),c=a.useRef(null),{customers:d,searchCustomers:m}=Yt(),u=n(),x=o?m(o):d;a.useEffect(()=>{const e=e=>{c.current&&!c.current.contains(e.target)&&i(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]);return Ce.jsxs("div",{className:"relative",ref:c,children:[Ce.jsxs("div",{onClick:()=>{i(!r)},className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm bg-white shadow-sm transition-all duration-200 hover:shadow-md cursor-pointer flex items-center justify-between",children:[Ce.jsx("div",{className:"flex items-center space-x-3 min-w-0 flex-1",children:e?Ce.jsxs(Ce.Fragment,{children:[Ce.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0",children:Ce.jsx(b,{className:"w-4 h-4 text-blue-600"})}),Ce.jsxs("div",{className:"min-w-0 flex-1",children:[Ce.jsxs("div",{className:"font-medium text-gray-900 truncate",children:[e.name," ",e.lastName]}),Ce.jsx("div",{className:"text-xs text-gray-500 truncate",children:e.email||e.phone||e.cardCode})]})]}):Ce.jsxs(Ce.Fragment,{children:[Ce.jsx(b,{className:"w-4 h-4 text-gray-400"}),Ce.jsx("span",{className:"text-gray-500",children:s})]})}),Ce.jsxs("div",{className:"flex items-center space-x-2 flex-shrink-0",children:[e&&Ce.jsx("button",{onClick:e=>{e.stopPropagation(),t(null),i(!1),l("")},className:"p-1 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-full transition-colors",children:Ce.jsx(S,{className:"w-3 h-3"})}),Ce.jsx(I,{className:"w-4 h-4 text-gray-400 transition-transform "+(r?"rotate-180":"")}),r&&Ce.jsx("div",{className:"absolute top-full left-0 right-0 mt-1 bg-blue-500 text-white text-xs px-2 py-1 rounded",children:"Dropdown abierto"})]})]}),r&&Ce.jsxs("div",{className:"absolute top-full left-0 right-0 mt-1 bg-white border border-gray-200 rounded-xl shadow-lg z-50 max-h-80 overflow-hidden",style:{zIndex:9999},children:[Ce.jsx("div",{className:"p-3 border-b border-gray-100",children:Ce.jsxs("div",{className:"relative",children:[Ce.jsx(T,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),Ce.jsx("input",{type:"text",placeholder:"Buscar clientes...",value:o,onChange:e=>l(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",autoFocus:!0})]})}),Ce.jsx("div",{className:"max-h-60 overflow-y-auto",children:0===x.length?Ce.jsxs("div",{className:"p-4 text-center text-gray-500",children:[Ce.jsx(b,{className:"w-8 h-8 mx-auto mb-2 text-gray-300"}),Ce.jsx("p",{className:"text-sm",children:o?"No se encontraron clientes":"No hay clientes registrados"})]}):Ce.jsx("div",{className:"py-1",children:x.map(e=>Ce.jsx("div",{onClick:a=>{a.preventDefault(),a.stopPropagation(),(e=>{t(e),i(!1),l("")})(e)},className:"px-4 py-3 hover:bg-blue-50 cursor-pointer transition-colors border-b border-gray-50 last:border-b-0 active:bg-blue-100",style:{minHeight:"60px"},children:Ce.jsxs("div",{className:"flex items-center space-x-3",children:[Ce.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0",children:Ce.jsx(b,{className:"w-4 h-4 text-blue-600"})}),Ce.jsxs("div",{className:"min-w-0 flex-1",children:[Ce.jsxs("div",{className:"font-medium text-gray-900",children:[e.name," ",e.lastName]}),Ce.jsxs("div",{className:"flex items-center space-x-4 text-xs text-gray-500 mt-1",children:[e.email&&Ce.jsxs("div",{className:"flex items-center space-x-1",children:[Ce.jsx(M,{className:"w-3 h-3"}),Ce.jsx("span",{className:"truncate",children:e.email})]}),e.phone&&Ce.jsxs("div",{className:"flex items-center space-x-1",children:[Ce.jsx(E,{className:"w-3 h-3"}),Ce.jsx("span",{children:e.phone})]}),e.cardCode&&Ce.jsxs("div",{className:"flex items-center space-x-1",children:[Ce.jsx($,{className:"w-3 h-3"}),Ce.jsx("span",{children:e.cardCode})]})]})]}),e.balance>0&&Ce.jsxs("div",{className:"text-right flex-shrink-0",children:[Ce.jsx("div",{className:"text-xs text-gray-500",children:"Saldo"}),Ce.jsxs("div",{className:"text-sm font-semibold text-green-600",children:["€",e.balance.toFixed(2)]})]})]})},e.id))})}),Ce.jsx("div",{className:"p-3 border-t border-gray-100 bg-gray-50",children:Ce.jsxs("button",{onClick:()=>{i(!1),l(""),u("/customers")},className:"w-full px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors flex items-center justify-center space-x-2 text-sm font-medium",children:[Ce.jsx(F,{className:"w-4 h-4"}),Ce.jsx("span",{children:"Nuevo Cliente"})]})})]})]})},_t=({isOpen:e,onClose:t,onSelectTable:s,selectedTableId:r,forceOpen:i=!1,onTicketWithoutTable:o})=>{const[l,c]=a.useState(""),[d,m]=a.useState("all"),[u,x]=a.useState(!1),[h,g]=a.useState(null),[f,y]=a.useState(""),[v,j]=a.useState(!1),[N,w]=a.useState(""),[C,k]=a.useState(!1),[A,D]=a.useState(null),{salons:I,activeSalonId:M,setActiveSalon:E,tables:$,decor:F,updateTableTemporaryName:W,updateTableStatus:L,addNamedAccount:q}=Wt(),{customers:B,getCustomerByCardCode:G,searchCustomers:U}=Yt(),Y=n();a.useEffect(()=>{e||(x(!1),g(null),y(""))},[e]),a.useEffect(()=>{},[v,B]);const H=$.filter(e=>{var t,a;const s=!l||e.number.toLowerCase().includes(l.toLowerCase())||(null==(t=e.name)?void 0:t.toLowerCase().includes(l.toLowerCase()))||(null==(a=e.temporaryName)?void 0:a.toLowerCase().includes(l.toLowerCase())),r="all"===d||e.status===d;return s&&r}),X=e=>{if(u)return x(!1),g(null),void y("");"available"!==e.status&&"occupied"!==e.status&&"reserved"!==e.status||(c(""),s(e),t())},_=e=>{g(e),y(e.temporaryName||""),x(!0)},J=()=>{if(h){const e=f.trim()||null;W(h.id,e),x(!1),g(null),y(""),e&&setTimeout(()=>{},100)}},V=()=>{x(!1),g(null),y("")},Q=()=>{j(!1),w(""),D(null)},K=(e,t)=>{L(e.id,t)},Z=()=>{x(!1),g(null),y(""),t()};return e?Ce.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[Ce.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[Ce.jsx("div",{className:"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75",onClick:i?void 0:Z}),Ce.jsxs("div",{className:"inline-block w-full h-screen max-w-none my-0 overflow-hidden text-left align-middle transition-all transform bg-white shadow-xl rounded-none",children:[Ce.jsxs("div",{className:"p-4 border-b border-gray-200 bg-gray-50",children:[Ce.jsxs("div",{className:"flex items-center justify-between mb-3",children:[Ce.jsxs("div",{className:"flex items-center space-x-3",children:[Ce.jsx(O,{className:"w-6 h-6 text-primary-600"}),Ce.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Seleccionar Mesa"})]}),o&&Ce.jsxs("button",{onClick:o,className:"px-6 py-3 bg-gradient-to-r from-purple-600 to-violet-600 hover:from-purple-700 hover:to-violet-700 text-white font-bold rounded-xl shadow-xl hover:shadow-2xl transition-all duration-300 hover:scale-105 flex items-center space-x-2 text-base border-2 border-purple-400 ring-2 ring-purple-200",children:[Ce.jsx(z,{className:"w-5 h-5"}),Ce.jsx("span",{children:"Ticket sin Mesa"})]}),Ce.jsxs("div",{className:"flex items-center space-x-3",children:[Ce.jsxs("button",{onClick:()=>{t(),Y("/configuration")},className:"px-3 py-2 bg-gradient-to-r from-gray-600 to-gray-700 hover:from-gray-700 hover:to-gray-800 text-white font-medium rounded-lg shadow-md hover:shadow-lg transition-all duration-200 flex items-center space-x-2 text-sm",title:"Configuración",children:[Ce.jsx(p,{className:"w-4 h-4"}),Ce.jsx("span",{children:"Configuración"})]}),!i&&Ce.jsx("button",{onClick:Z,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:Ce.jsx(S,{className:"w-5 h-5"})})]})]}),Ce.jsxs("div",{className:"mb-4",children:[Ce.jsx("label",{className:"block text-xs text-gray-500 mb-2 font-medium",children:"SELECCIONAR SALÓN"}),Ce.jsx("div",{className:"flex flex-wrap gap-2",children:I.map(e=>Ce.jsx("button",{onClick:()=>{return t=e.id,void E(t);var t},className:"px-4 py-2 rounded-lg font-medium transition-all duration-200 shadow-sm hover:shadow-md "+(M===e.id?"named-accounts"===e.id?"bg-gradient-to-r from-yellow-500 to-amber-600 text-white shadow-lg transform scale-105":"bg-gradient-to-r from-blue-600 to-indigo-600 text-white shadow-lg transform scale-105":"named-accounts"===e.id?"bg-yellow-100 text-yellow-700 hover:bg-yellow-200 border border-yellow-300 hover:border-yellow-400":"bg-white text-gray-700 hover:bg-gray-50 border border-gray-200 hover:border-gray-300"),children:e.name},e.id))})]}),Ce.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 items-end",children:[Ce.jsxs("div",{className:"flex-1 relative",children:[Ce.jsx(T,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),Ce.jsx("input",{type:"text",placeholder:"Buscar mesa por número o nombre...",value:l,onChange:e=>c(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),Ce.jsxs("div",{className:"flex items-center space-x-2",children:[Ce.jsx(R,{className:"w-5 h-5 text-gray-400"}),Ce.jsxs("select",{value:d,onChange:e=>m(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[Ce.jsx("option",{value:"all",children:"Todas"}),Ce.jsx("option",{value:"available",children:"Disponibles"}),Ce.jsx("option",{value:"occupied",children:"Ocupadas"}),Ce.jsx("option",{value:"reserved",children:"Reservadas"})]})]})]})]}),Ce.jsxs("div",{className:"p-4 h-[calc(100vh-120px)]",children:[Ce.jsx("div",{className:"relative bg-gray-100 rounded-lg border-2 border-dashed border-gray-300 h-full overflow-hidden",children:Ce.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-50 to-gray-100",children:Ce.jsxs("div",{className:"salon-canvas relative w-full h-full",children:[F.map(e=>Ce.jsx(qt,{item:e},e.id)),Ce.jsx(Bt,{tables:H,scale:1}),H.map(e=>Ce.jsx(Lt,{table:e,isSelected:r===e.id,onClick:X,onLongPress:_,scale:1},e.id)),"named-accounts"===M&&0===H.length&&Ce.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:Ce.jsxs("div",{className:"text-center p-8 bg-white bg-opacity-90 rounded-xl shadow-lg max-w-md",children:[Ce.jsx("div",{className:"w-16 h-16 bg-yellow-100 rounded-full flex items-center justify-center mx-auto mb-4",children:Ce.jsx(b,{className:"w-8 h-8 text-yellow-600"})}),Ce.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No hay cuentas creadas"}),Ce.jsx("p",{className:"text-gray-600 mb-4",children:"Haz clic en el botón flotante (+) para crear tu primera cuenta por nombre"}),Ce.jsxs("button",{onClick:()=>j(!0),className:"px-6 py-3 bg-gradient-to-r from-yellow-500 to-amber-600 hover:from-yellow-600 hover:to-amber-700 text-white font-semibold rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-105 flex items-center space-x-2 mx-auto",children:[Ce.jsx(b,{className:"w-5 h-5"}),Ce.jsx("span",{children:"Crear Primera Cuenta"})]})]})})]})})}),Ce.jsxs("div",{className:"mt-4 flex flex-wrap gap-4 text-sm",children:[Ce.jsxs("div",{className:"flex items-center space-x-2",children:[Ce.jsx("div",{className:"w-4 h-4 bg-green-500 rounded-full"}),Ce.jsx("span",{children:"Disponible"})]}),Ce.jsxs("div",{className:"flex items-center space-x-2",children:[Ce.jsx("div",{className:"w-4 h-4 bg-red-500 rounded-full"}),Ce.jsx("span",{children:"Ocupada"})]}),Ce.jsxs("div",{className:"flex items-center space-x-2",children:[Ce.jsx("div",{className:"w-4 h-4 bg-yellow-500 rounded-full"}),Ce.jsx("span",{children:"Reservada"})]}),Ce.jsxs("div",{className:"flex items-center space-x-2",children:[Ce.jsx("div",{className:"w-4 h-4 bg-purple-500 rounded-full border-2 border-purple-600"}),Ce.jsx("span",{children:"Mesas Unidas"})]}),Ce.jsxs("div",{className:"flex items-center space-x-2",children:[Ce.jsx("div",{className:"w-4 h-4 bg-yellow-400 rounded-full flex items-center justify-center text-xs",children:"★"}),Ce.jsx("span",{children:"Mesa Principal"})]})]}),Ce.jsxs("div",{className:"mt-4 p-4 bg-gray-100 rounded-lg",children:[Ce.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Debug - Cambiar Estado de Mesas:"}),Ce.jsx("div",{className:"flex flex-wrap gap-2",children:H.map(e=>Ce.jsxs("div",{className:"flex items-center space-x-2",children:[Ce.jsxs("span",{className:"text-xs font-medium",children:["Mesa ",e.number,":"]}),Ce.jsx("button",{onClick:()=>K(e,"available"),className:"px-2 py-1 text-xs rounded "+("available"===e.status?"bg-green-500 text-white":"bg-gray-200"),children:"Disp"}),Ce.jsx("button",{onClick:()=>K(e,"occupied"),className:"px-2 py-1 text-xs rounded "+("occupied"===e.status?"bg-red-500 text-white":"bg-gray-200"),children:"Ocup"}),Ce.jsx("button",{onClick:()=>K(e,"reserved"),className:"px-2 py-1 text-xs rounded "+("reserved"===e.status?"bg-yellow-500 text-white":"bg-gray-200"),children:"Res"})]},e.id))})]})]}),"named-accounts"===M&&Ce.jsx("div",{className:"fixed bottom-6 right-6 z-50",children:Ce.jsxs("button",{onClick:()=>j(!0),className:"px-6 py-4 bg-gradient-to-r from-yellow-500 to-amber-600 hover:from-yellow-600 hover:to-amber-700 text-white rounded-full shadow-2xl hover:shadow-3xl transition-all duration-300 hover:scale-110 flex items-center space-x-2",title:"Crear Nueva Cuenta",children:[Ce.jsx(b,{className:"w-6 h-6"}),Ce.jsx("span",{className:"font-semibold text-sm",children:"Nueva Cuenta"})]})}),"named-accounts"===M&&Ce.jsx("div",{className:"px-4 py-3 bg-yellow-50 border-t border-yellow-200",children:Ce.jsxs("div",{className:"flex justify-between items-center",children:[Ce.jsxs("div",{className:"text-sm text-yellow-800",children:[Ce.jsx("p",{className:"font-semibold",children:"📋 Salón de Cuentas por Nombre"}),Ce.jsx("p",{className:"text-xs",children:"Haz clic en el botón flotante (+) para crear una nueva cuenta"})]}),Ce.jsxs("button",{onClick:()=>j(!0),className:"px-4 py-2 bg-gradient-to-r from-yellow-500 to-amber-600 hover:from-yellow-600 hover:to-amber-700 text-white font-medium rounded-lg shadow-md hover:shadow-lg transition-all duration-200 flex items-center space-x-2",children:[Ce.jsx(b,{className:"w-4 h-4"}),Ce.jsx("span",{children:"Nueva Cuenta"})]})]})}),Ce.jsx("div",{className:"px-4 py-3 bg-gray-50 border-t border-gray-200",children:Ce.jsxs("div",{className:"flex justify-between items-center",children:[Ce.jsxs("div",{className:"text-sm text-gray-600",children:[Ce.jsx("p",{children:"Haz clic en una mesa disponible u ocupada para seleccionarla"}),Ce.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["💡 ",Ce.jsx("strong",{children:"Pulsación sostenida (1s)"})," o ",Ce.jsx("strong",{children:"clic derecho"})," para asignar nombre temporal"]})]}),Ce.jsx("button",{onClick:Z,className:"btn btn-secondary",children:"Cancelar"})]})})]})]}),u&&h&&Ce.jsx("div",{className:"fixed inset-0 z-[55] overflow-y-auto",children:Ce.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[Ce.jsx("div",{className:"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75",onClick:V}),Ce.jsxs("div",{className:"inline-block w-full max-w-md p-6 my-8 overflow-hidden text-left align-middle transition-all transform bg-white shadow-xl rounded-2xl",children:[Ce.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[Ce.jsx(b,{className:"w-6 h-6 text-blue-600"}),Ce.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Nombre Temporal - Mesa ",h.number]})]}),Ce.jsxs("div",{className:"mb-4",children:[Ce.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nombre del cliente (opcional)"}),Ce.jsx("input",{type:"text",value:f,onChange:e=>y(e.target.value),placeholder:"Ej: Juanito, María, etc.",className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",autoFocus:!0,onKeyPress:e=>{"Enter"===e.key&&J()}}),Ce.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Este nombre se mantendrá hasta que se cierre la cuenta de la mesa"})]}),Ce.jsxs("div",{className:"flex space-x-3",children:[Ce.jsx("button",{onClick:V,className:"flex-1 px-4 py-3 border border-gray-300 rounded-xl text-gray-700 hover:bg-gray-50 transition-colors",children:"Cancelar"}),Ce.jsx("button",{onClick:J,className:"flex-1 px-4 py-3 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white rounded-xl font-medium transition-all duration-200 hover:scale-105",children:"Guardar"})]})]})]})}),v&&Ce.jsx("div",{className:"fixed inset-0 z-[55] overflow-y-auto",children:Ce.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[Ce.jsx("div",{className:"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75",onClick:Q}),Ce.jsxs("div",{className:"inline-block w-full max-w-md p-6 my-8 overflow-hidden text-left align-middle transition-all transform bg-white shadow-xl rounded-2xl",children:[Ce.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[Ce.jsx(b,{className:"w-6 h-6 text-yellow-600"}),Ce.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Nueva Cuenta por Nombre"})]}),Ce.jsxs("form",{onSubmit:e=>{if(e.preventDefault(),N.trim()||A)try{let e="",a=null;A?(e=`${A.name} ${A.lastName}`,a=A):e=N.trim();const r=q(e);P.success(`Cuenta creada para ${e}`);const n={id:r,number:e,name:e,status:"occupied",x:0,y:0,capacity:1,occupiedSince:new Date,temporaryName:e,assignedCustomer:a};j(!1),w(""),D(null),s(n),t()}catch(a){a instanceof Error&&a.message.includes("Ya existe una cuenta")?P.error(a.message):P.error("Error al crear la cuenta")}else P.error("Por favor ingresa el nombre del cliente o selecciona uno existente")},children:[A&&Ce.jsx("div",{className:"mb-4 p-3 bg-green-50 border border-green-200 rounded-lg",children:Ce.jsxs("div",{className:"flex items-center justify-between",children:[Ce.jsxs("div",{className:"flex items-center space-x-2",children:[Ce.jsx("div",{className:"w-6 h-6 bg-green-100 rounded-full flex items-center justify-center",children:Ce.jsx(b,{className:"w-4 h-4 text-green-600"})}),Ce.jsxs("div",{children:[Ce.jsx("p",{className:"text-sm font-medium text-green-900",children:"✅ Cliente seleccionado:"}),Ce.jsxs("p",{className:"text-sm text-green-700",children:[A.name," ",A.lastName]}),A.email&&Ce.jsx("p",{className:"text-xs text-green-600",children:A.email})]})]}),Ce.jsx("button",{type:"button",onClick:()=>D(null),className:"text-green-500 hover:text-green-700 p-1 hover:bg-green-100 rounded-full transition-colors",title:"Cambiar cliente",children:"✕"})]})}),!A&&Ce.jsx("div",{className:"mb-4",children:Ce.jsx("input",{type:"text",placeholder:"🔍 Escanear código de tarjeta...",className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm bg-white shadow-sm transition-all duration-200 hover:shadow-md",onKeyPress:e=>{if("Enter"===e.key){const t=e.currentTarget.value.trim();if(t){const a=G(t);a?(D(a),P.success(`Cliente ${a.name} ${a.lastName} seleccionado por código de tarjeta`),e.currentTarget.value=""):(P.error("No se encontró un cliente con ese código de tarjeta"),e.currentTarget.value="")}}}})}),!A&&Ce.jsx("div",{className:"mb-4",children:Ce.jsxs("button",{type:"button",onClick:()=>k(!0),className:"w-full px-4 py-3 border-2 border-dashed border-blue-300 rounded-xl text-blue-600 hover:border-blue-400 hover:bg-blue-50 transition-colors text-sm font-medium flex items-center justify-center space-x-2",children:[Ce.jsx(b,{className:"w-4 h-4"}),Ce.jsxs("span",{children:["📋 Seleccionar Cliente Existente (",B.length," disponibles)"]})]})}),!A&&Ce.jsxs("div",{className:"mb-4 flex items-center",children:[Ce.jsx("div",{className:"flex-1 border-t border-gray-300"}),Ce.jsx("span",{className:"px-3 text-sm text-gray-500",children:"o"}),Ce.jsx("div",{className:"flex-1 border-t border-gray-300"})]}),Ce.jsxs("div",{className:"mb-4",children:[Ce.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:A?"Nombre adicional (opcional)":"Nombre del Cliente *"}),Ce.jsx("input",{type:"text",required:!A,value:N,onChange:e=>w(e.target.value),placeholder:A?"Nombre adicional...":"Juan Pérez, María García...",className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-yellow-500 focus:border-yellow-500 text-sm",autoFocus:!A})]}),Ce.jsxs("div",{className:"flex space-x-3",children:[Ce.jsx("button",{type:"button",onClick:Q,className:"flex-1 px-4 py-3 border border-gray-300 rounded-xl text-gray-700 hover:bg-gray-50 transition-colors",children:"Cancelar"}),Ce.jsx("button",{type:"submit",className:"flex-1 px-4 py-3 bg-gradient-to-r from-yellow-500 to-amber-600 hover:from-yellow-600 hover:to-amber-700 text-white rounded-xl font-medium transition-all duration-200 hover:scale-105",children:"Crear Cuenta"})]})]})]})]})}),C&&Ce.jsx("div",{className:"fixed inset-0 z-[60] overflow-y-auto",children:Ce.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[Ce.jsx("div",{className:"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75",onClick:()=>k(!1)}),Ce.jsxs("div",{className:"inline-block w-full max-w-md p-6 my-8 overflow-hidden text-left align-middle transition-all transform bg-white shadow-xl rounded-2xl",children:[Ce.jsxs("div",{className:"flex items-center justify-between mb-4",children:[Ce.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Seleccionar Cliente"}),Ce.jsx("button",{onClick:()=>k(!1),className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:Ce.jsx(S,{className:"w-5 h-5"})})]}),Ce.jsxs("div",{className:"space-y-4",children:[Ce.jsxs("div",{className:"text-sm text-gray-600 mb-3",children:[Ce.jsxs("p",{children:["Clientes disponibles: ",Ce.jsx("strong",{children:B.length})]}),0===B.length&&Ce.jsx("p",{className:"text-orange-600 mt-1",children:'No hay clientes registrados. Primero crea algunos clientes en la sección "Clientes".'})]}),Ce.jsx(Xt,{selectedCustomer:A,onCustomerSelect:e=>{D(e),k(!1)},placeholder:"Buscar cliente por nombre, email, teléfono o código de tarjeta..."}),0===B.length&&Ce.jsxs("div",{className:"mt-4 p-3 bg-orange-50 border border-orange-200 rounded-lg",children:[Ce.jsxs("p",{className:"text-sm text-orange-800",children:[Ce.jsx("strong",{children:"💡 Sugerencia:"}),' Ve a la sección "Clientes" para crear algunos clientes primero.']}),Ce.jsx("button",{type:"button",onClick:()=>{k(!1),Y("/customers")},className:"mt-2 px-4 py-2 bg-orange-600 text-white rounded-lg text-sm hover:bg-orange-700 transition-colors",children:"Ir a Clientes"})]})]})]})]})})]}):null},Jt=a.createContext(void 0),Vt=({children:e})=>{const[t,s]=a.useState(()=>{const e=localStorage.getItem("restaurantConfig");if(e){const t=JSON.parse(e);return{restaurantName:t.restaurantName??"Mi Restaurante",currency:t.currency??"MXN",taxRate:t.taxRate??.16,modifiers:t.modifiers??{global:[],byCategory:{}}}}return{restaurantName:"Mi Restaurante",currency:"MXN",taxRate:.16,modifiers:{global:[],byCategory:{}}}}),r={config:t,updateConfig:e=>{const a={...t,...e};s(a),localStorage.setItem("restaurantConfig",JSON.stringify(a))},getCurrencySymbol:()=>{switch(t.currency){case"MXN":case"USD":default:return"$";case"EUR":return"€"}},getTaxRate:()=>t.taxRate,getModifiersForCategory:e=>{if(!t.modifiers)return[];const a=e&&t.modifiers.byCategory[e]||[],s=t.modifiers.global||[];return Array.from(new Set([...s,...a]))},updateCategoryModifiers:(e,a)=>{var r,n;const i={...t,modifiers:{global:(null==(r=t.modifiers)?void 0:r.global)||[],byCategory:{...(null==(n=t.modifiers)?void 0:n.byCategory)||{},[e]:a}}};s(i),localStorage.setItem("restaurantConfig",JSON.stringify(i))}};return Ce.jsx(Jt.Provider,{value:r,children:e})},Qt=()=>{const e=a.useContext(Jt);if(void 0===e)throw new Error("useConfig must be used within a ConfigProvider");return e},Kt=e=>e/1.21,Zt=e=>e.toFixed(2),ea=e=>e.reduce((e,t)=>{var a;return e+((a=t.unitPrice)-Kt(a))*t.quantity},0),ta=e=>{try{const t=new ue({orientation:"portrait",unit:"pt",format:[226,800]});let a=20;const s=226,r=10,n=10,i="recharge"===e.documentType,o="balance_payment"===e.documentType,l="partial_receipt"===e.documentType;t.setFontSize(14),t.setFont("helvetica","bold");const c=t.getTextWidth(e.restaurantName),d=(s-c)/2;t.text(e.restaurantName,d,a),a+=20,t.setFontSize(12),t.setFont("helvetica","bold");let m="TICKET";i?m="RECARGA DE SALDO":o?m="ALBARÁN":l&&(m="RECIBO PARCIAL");const u=t.getTextWidth(m),x=(s-u)/2;t.text(m,x,a),a+=20,t.setLineWidth(.5),t.line(r,a,s-n,a),a+=10,t.setFontSize(9),t.setFont("helvetica","normal");const h=new Date;if(t.text(`Fecha: ${h.toLocaleDateString("es-ES")}`,r,a),a+=12,t.text(`Hora: ${h.toLocaleTimeString("es-ES")}`,r,a),a+=12,i||(t.text(`Mesa: ${e.tableNumber}`,r,a),a+=15),e.selectedCustomer){t.setFontSize(9),t.setFont("helvetica","bold"),t.text("CLIENTE:",r,a),a+=12,t.setFontSize(9),t.setFont("helvetica","normal");const s=`${e.selectedCustomer.name} ${e.selectedCustomer.lastName}`;t.text(s,r,a),a+=12,e.selectedCustomer.email&&(t.text(`Email: ${e.selectedCustomer.email}`,r,a),a+=12),e.selectedCustomer.phone&&(t.text(`Tel: ${e.selectedCustomer.phone}`,r,a),a+=12),e.selectedCustomer.cardCode&&(t.text(`Tarjeta: ${e.selectedCustomer.cardCode}`,r,a),a+=12),a+=5}t.line(r,a,s-n,a),a+=10,e.orderItems.forEach(i=>{t.setFontSize(10),t.setFont("helvetica","bold"),t.text(i.productName,r,a),a+=12,t.setFontSize(9),t.setFont("helvetica","normal");const o=`${i.quantity} x ${e.currencySymbol}${i.unitPrice.toFixed(2)}`,l=`${e.currencySymbol}${i.totalPrice.toFixed(2)}`;t.text(o,r,a);const c=t.getTextWidth(l);t.text(l,s-n-c,a),a+=15}),t.line(r,a,s-n,a),a+=10,t.setFontSize(10),t.setFont("helvetica","normal");const g=`Subtotal: ${e.currencySymbol}${e.subtotal.toFixed(2)}`,p=t.getTextWidth(g);t.text(g,s-n-p,a),a+=12;const b=`IVA: ${e.currencySymbol}${e.tax.toFixed(2)}`,f=t.getTextWidth(b);t.text(b,s-n-f,a),a+=12,t.setFontSize(12),t.setFont("helvetica","bold");const y=`TOTAL: ${e.currencySymbol}${e.total.toFixed(2)}`,v=t.getTextWidth(y);if(t.text(y,s-n-v,a),a+=20,l){t.line(r,a,s-n,a),a+=10,t.setFontSize(11),t.setFont("helvetica","bold"),t.text("COBRO PARCIAL",r,a),a+=15,t.setFontSize(9),t.setFont("helvetica","normal");const i=`Total de la cuenta: ${e.currencySymbol}${e.total.toFixed(2)}`,o=t.getTextWidth(i);t.text(i,s-n-o,a),a+=12;const l=`Monto cobrado: ${e.currencySymbol}${e.total.toFixed(2)}`,c=t.getTextWidth(l);t.text(l,s-n-c,a),a+=12;const d=e.total-e.total,m=`Monto pendiente: ${e.currencySymbol}${d.toFixed(2)}`,u=t.getTextWidth(m);t.text(m,s-n-u,a),a+=15,t.setFontSize(8),t.setFont("helvetica","italic"),t.text("Este es un recibo parcial. El ticket fiscal se generará al liquidar la cuenta completa.",r,a),a+=15}if(e.partialPayments&&e.partialPayments.length>0){t.line(r,a,s-n,a),a+=10,t.setFontSize(11),t.setFont("helvetica","bold"),t.text("PAGOS PREVIOS REALIZADOS",r,a),a+=15,t.setFontSize(9),t.setFont("helvetica","normal");const i=e.total+(e.totalPartialPayments||0),o=`Total de la cuenta: ${e.currencySymbol}${i.toFixed(2)}`;if(t.text(o,r,a),a+=12,e.partialPayments.forEach((s,n)=>{const i=`${new Date(s.date).toLocaleDateString("es-ES")} ${new Date(s.date).toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit"})} - ${"cash"===s.paymentMethod?"Efectivo":"Tarjeta"}: ${e.currencySymbol}${s.amount.toFixed(2)}`;t.text(i,r,a),a+=12}),e.totalPartialPayments){a+=5,t.setFont("helvetica","bold");const r=`Total pagado anteriormente: ${e.currencySymbol}${e.totalPartialPayments.toFixed(2)}`,i=t.getTextWidth(r);t.text(r,s-n-i,a),a+=12;const o=`Pago final realizado: ${e.currencySymbol}${e.total.toFixed(2)}`,l=t.getTextWidth(o);t.text(o,s-n-l,a),a+=15}}if(e.useBalance&&e.balanceAmount&&e.balanceAmount>0){t.line(r,a,s-n,a),a+=10,t.setFontSize(11),t.setFont("helvetica","bold"),t.text("PAGO CON SALDO",r,a),a+=15,t.setFontSize(9),t.setFont("helvetica","normal");const i=`Saldo usado: ${e.currencySymbol}${e.balanceAmount.toFixed(2)}`,o=t.getTextWidth(i);if(t.text(i,s-n-o,a),a+=12,e.selectedCustomer){const r=e.selectedCustomer.balance-e.balanceAmount,i=`Saldo restante: ${e.currencySymbol}${r.toFixed(2)}`,o=t.getTextWidth(i);t.text(i,s-n-o,a),a+=12}if(e.remainingAmount&&e.remainingAmount>0){const r=`Resto pagado con: ${"cash"===e.remainingPaymentMethod?"Efectivo":"Tarjeta"}`,i=t.getTextWidth(r);t.text(r,s-n-i,a),a+=12}a+=10}if(t.line(r,a,s-n,a),a+=10,!e.useBalance||e.remainingAmount&&e.remainingAmount>0){t.setFontSize(9),t.setFont("helvetica","normal");const s="cash"===e.paymentMethod?"Efectivo":"Tarjeta";t.text(`Pago: ${s}`,r,a),a+=20}if(i&&e.selectedCustomer){a+=10,t.setFontSize(10),t.setFont("helvetica","bold"),t.text("Saldo actualizado:",r,a),a+=12,t.setFontSize(10),t.setFont("helvetica","normal");const s=e.selectedCustomer.balance+e.total;t.text(`${e.currencySymbol}${s.toFixed(2)}`,r,a),a+=12}t.setFontSize(10),t.setFont("helvetica","bold");const j="¡Gracias por su visita!",N=t.getTextWidth(j),w=(s-N)/2;return t.text(j,w,a),t.output("dataurlstring")}catch(t){throw new Error("No se pudo generar el ticket PDF")}},aa=(e,t="ticket")=>{var a;try{const s=window.open("","_blank","width=800,height=1000,scrollbars=yes,resizable=yes");s?(s.document.write(`\n        <!DOCTYPE html>\n        <html>\n          <head>\n            <title>Ticket - ${t}</title>\n            <style>\n              body { \n                margin: 0; \n                padding: 20px; \n                font-family: Arial, sans-serif;\n                background: #f5f5f5;\n              }\n              .container {\n                max-width: 800px;\n                margin: 0 auto;\n                background: white;\n                padding: 20px;\n                border-radius: 8px;\n                box-shadow: 0 2px 10px rgba(0,0,0,0.1);\n              }\n              .header {\n                text-align: center;\n                margin-bottom: 20px;\n                padding-bottom: 10px;\n                border-bottom: 2px solid #333;\n              }\n              .actions {\n                text-align: center;\n                margin-bottom: 20px;\n              }\n              .btn {\n                background: #007bff;\n                color: white;\n                padding: 10px 20px;\n                border: none;\n                border-radius: 5px;\n                cursor: pointer;\n                margin: 0 10px;\n                text-decoration: none;\n                display: inline-block;\n              }\n              .btn:hover {\n                background: #0056b3;\n              }\n              .pdf-container {\n                text-align: center;\n              }\n              iframe {\n                border: 1px solid #ddd;\n                border-radius: 5px;\n              }\n            </style>\n          </head>\n          <body>\n            <div class="container">\n              <div class="header">\n                <h2>Ticket de Compra</h2>\n                <p>Mesa: ${t.includes("mesa")?null==(a=t.split("-mesa-")[1])?void 0:a.split("-")[0]:"N/A"}</p>\n              </div>\n              <div class="actions">\n                <button class="btn" onclick="window.print()">🖨️ Imprimir</button>\n                <a class="btn" href="${e}" download="${t}.pdf">💾 Descargar PDF</a>\n                <button class="btn" onclick="window.close()">❌ Cerrar</button>\n              </div>\n              <div class="pdf-container">\n                <iframe src="${e}" width="100%" height="800px" type="application/pdf">\n                  <p>Tu navegador no puede mostrar PDFs. <a href="${e}" download="${t}.pdf">Haz clic aquí para descargar</a></p>\n                </iframe>\n              </div>\n            </div>\n          </body>\n        </html>\n      `),s.document.close()):sa(e,t)}catch(s){sa(e,t)}},sa=(e,t)=>{const a=document.createElement("a");a.href=e,a.download=`${t}.pdf`,document.body.appendChild(a),a.click(),document.body.removeChild(a)},ra=({value:e,onConfirm:t,onCancel:s,currencySymbol:r="$"})=>{const[n,i]=a.useState(e.toString()),o=e=>{if("0"===n&&"."!==e)i(e);else{if("."===e&&n.includes("."))return;if(n.length>=10)return;i(n+e)}};return Ce.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:Ce.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-sm w-full overflow-hidden",children:[Ce.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-600 p-4",children:Ce.jsxs("div",{className:"flex items-center justify-between",children:[Ce.jsx("h3",{className:"text-white font-semibold text-lg",children:"Editar Precio (IVA incl.)"}),Ce.jsx("button",{onClick:()=>{s()},className:"text-white hover:text-gray-200 p-2 rounded-lg hover:bg-white/20 transition-colors",children:Ce.jsx(S,{className:"w-5 h-5"})})]})}),Ce.jsx("div",{className:"p-6 bg-gray-50",children:Ce.jsx("div",{className:"bg-white rounded-xl p-4 border-2 border-gray-200",children:Ce.jsxs("div",{className:"text-right",children:[Ce.jsx("div",{className:"text-sm text-gray-500 mb-1",children:"Precio por unidad (IVA incluido)"}),Ce.jsxs("div",{className:"text-3xl font-bold text-gray-900",children:[r,n]})]})})}),Ce.jsxs("div",{className:"p-4 bg-gray-100",children:[Ce.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[Ce.jsx("button",{onClick:()=>o("7"),className:"bg-white hover:bg-gray-50 text-gray-800 font-semibold text-xl py-4 rounded-xl shadow-sm hover:shadow-md transition-all duration-200 active:scale-95",children:"7"}),Ce.jsx("button",{onClick:()=>o("8"),className:"bg-white hover:bg-gray-50 text-gray-800 font-semibold text-xl py-4 rounded-xl shadow-sm hover:shadow-md transition-all duration-200 active:scale-95",children:"8"}),Ce.jsx("button",{onClick:()=>o("9"),className:"bg-white hover:bg-gray-50 text-gray-800 font-semibold text-xl py-4 rounded-xl shadow-sm hover:shadow-md transition-all duration-200 active:scale-95",children:"9"}),Ce.jsx("button",{onClick:()=>o("4"),className:"bg-white hover:bg-gray-50 text-gray-800 font-semibold text-xl py-4 rounded-xl shadow-sm hover:shadow-md transition-all duration-200 active:scale-95",children:"4"}),Ce.jsx("button",{onClick:()=>o("5"),className:"bg-white hover:bg-gray-50 text-gray-800 font-semibold text-xl py-4 rounded-xl shadow-sm hover:shadow-md transition-all duration-200 active:scale-95",children:"5"}),Ce.jsx("button",{onClick:()=>o("6"),className:"bg-white hover:bg-gray-50 text-gray-800 font-semibold text-xl py-4 rounded-xl shadow-sm hover:shadow-md transition-all duration-200 active:scale-95",children:"6"}),Ce.jsx("button",{onClick:()=>o("1"),className:"bg-white hover:bg-gray-50 text-gray-800 font-semibold text-xl py-4 rounded-xl shadow-sm hover:shadow-md transition-all duration-200 active:scale-95",children:"1"}),Ce.jsx("button",{onClick:()=>o("2"),className:"bg-white hover:bg-gray-50 text-gray-800 font-semibold text-xl py-4 rounded-xl shadow-sm hover:shadow-md transition-all duration-200 active:scale-95",children:"2"}),Ce.jsx("button",{onClick:()=>o("3"),className:"bg-white hover:bg-gray-50 text-gray-800 font-semibold text-xl py-4 rounded-xl shadow-sm hover:shadow-md transition-all duration-200 active:scale-95",children:"3"}),Ce.jsx("button",{onClick:()=>o("0"),className:"bg-white hover:bg-gray-50 text-gray-800 font-semibold text-xl py-4 rounded-xl shadow-sm hover:shadow-md transition-all duration-200 active:scale-95",children:"0"}),Ce.jsx("button",{onClick:()=>o("."),className:"bg-white hover:bg-gray-50 text-gray-800 font-semibold text-xl py-4 rounded-xl shadow-sm hover:shadow-md transition-all duration-200 active:scale-95",children:"."}),Ce.jsx("button",{onClick:()=>{1===n.length?i("0"):i(n.slice(0,-1))},className:"bg-red-500 hover:bg-red-600 text-white font-semibold text-xl py-4 rounded-xl shadow-sm hover:shadow-md transition-all duration-200 active:scale-95",children:"←"})]}),Ce.jsxs("div",{className:"grid grid-cols-2 gap-3 mt-3",children:[Ce.jsxs("button",{onClick:()=>{i("0")},className:"bg-gray-500 hover:bg-gray-600 text-white font-semibold py-4 rounded-xl shadow-sm hover:shadow-md transition-all duration-200 active:scale-95 flex items-center justify-center space-x-2",children:[Ce.jsx(W,{className:"w-5 h-5"}),Ce.jsx("span",{children:"Limpiar"})]}),Ce.jsx("button",{onClick:()=>{const e=parseFloat(n)||0;t(e)},className:"bg-green-500 hover:bg-green-600 text-white font-semibold py-4 rounded-xl shadow-sm hover:shadow-md transition-all duration-200 active:scale-95",children:"Confirmar"})]})]})]})})},na=({isOpen:e,onClose:t,onPaymentComplete:s,orderItems:r,tableNumber:n,customerName:i,subtotal:o,tax:l,total:c,mergedTableNumber:d,titleOverride:m,skipDbSave:u=!1,defaultPaymentMethod:x="cash",originalOrderItems:h,originalSubtotal:g,originalTax:p,originalTotal:b,selectedCustomer:f,allowPartialPayment:y=!1,onPartialPayment:v,partialPayments:j=[],totalPartialPayments:N=0,isTicketWithoutTable:w=!1})=>{const[C,k]=a.useState(x),[D,P]=a.useState(""),[I,T]=a.useState(!1),[M,E]=a.useState(0),[F,O]=a.useState(0),[R,W]=a.useState("cash"),[B,G]=a.useState(""),[U,Y]=a.useState(!1),[H,X]=a.useState(null),{getCurrencySymbol:_,getTaxRate:J,config:V}=Qt(),{refreshCustomers:Q}=Yt(),K=(null==f?void 0:f.balance)||0,Z=K>0,ee=localStorage.getItem("rechargeData");let te=r,ae=o,se=l,re=c,ne=i,ie=n;if(ee)try{const e=JSON.parse(ee);e.customer&&e.amount&&(te=e.orderItems||r,ae=e.subtotal||o,se=e.tax||l,re=e.total||c,ne=e.customer.name+" "+e.customer.lastName,ie="RECARGA")}catch(xe){}if(a.useEffect(()=>{if(I&&Z){const e=Math.min(K,re);E(e);const t=re-e;O(t),k(t>0?"mixed":"balance")}else E(0),O(0),k(x)},[I,K,re,x,Z]),a.useEffect(()=>{ee&&T(!1)},[ee]),a.useEffect(()=>{if(e){T(!1),E(0),O(0),W("cash"),G(""),P(""),k(x);const e=localStorage.getItem("rechargeData");if(e)try{const t=JSON.parse(e);t.customer&&t.amount&&(T(!1),k("cash"))}catch(xe){}}},[e,x]),!e)return null;const oe=_(),le=parseFloat(D)-re,ce=re<0||te.some(e=>e.productName.includes("(-)")),de=te.some(e=>"diff"===e.productId),me=parseFloat(B)-F,ue=()=>{try{const e=h||te,t=void 0!==g?g:ae,a=void 0!==p?p:se,s=void 0!==b?b:re,r=localStorage.getItem("rechargeData");let i="ticket";r?i="recharge":I&&M>0&&(i="balance_payment");const o={restaurantName:V.restaurantName||"Restaurante",tableNumber:ie,customerName:ne,mergedTableNumber:d,orderItems:e,subtotal:t,tax:a,total:s,paymentMethod:"balance"===C?"card":"mixed"===C?R:C,cashReceived:"cash"===C||"mixed"===C&&"cash"===R?I?B:D:void 0,currencySymbol:oe,selectedCustomer:f,useBalance:I,balanceAmount:M,remainingAmount:F,remainingPaymentMethod:R,documentType:i};if(y&&v&&!w){if(re-parseFloat(D||"0")<=0){const e={...o,partialPayments:j,totalPartialPayments:N},t=ta(e),a=`ticket-final-mesa-${n}-${(new Date).toISOString().slice(0,10)}`;aa(t,a)}}else{const e=ta(o),t=`ticket-mesa-${n}-${(new Date).toISOString().slice(0,10)}`;aa(e,t)}}catch(xe){alert(`Error al generar el ticket PDF: ${xe instanceof Error?xe.message:"Error desconocido"}`)}};return Ce.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[Ce.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[Ce.jsx("div",{className:"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75",onClick:t}),Ce.jsxs("div",{className:"inline-block w-full max-w-2xl my-8 overflow-hidden text-left align-middle transition-all transform bg-white shadow-xl rounded-lg",children:[Ce.jsxs("div",{className:"flex items-center justify-between p-6 border-b "+(ce?"border-red-200 bg-red-50":"border-gray-200"),children:[Ce.jsxs("div",{className:"flex items-center space-x-3",children:[Ce.jsx(A,{className:"w-6 h-6 "+(ce?"text-red-600":"text-primary-600")}),Ce.jsx("h2",{className:"text-xl font-semibold "+(ce?"text-red-700":"text-gray-900"),children:ce?"⚠️ DEVOLUCIÓN":de?"Cobro de Diferencia":m||`Cobro - Mesa ${n}`})]}),Ce.jsx("button",{onClick:t,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:Ce.jsx(S,{className:"w-5 h-5"})})]}),Ce.jsxs("div",{className:"p-6",children:[Ce.jsxs("div",{className:"mb-6",children:[Ce.jsx("h3",{className:"text-lg font-semibold mb-3",children:"Resumen del Pedido"}),Ce.jsx("div",{className:"bg-gray-50 rounded-lg p-4 max-h-48 overflow-y-auto",children:r.map((e,t)=>{const a=e.productName.includes("(-)");return Ce.jsxs("div",{className:"flex justify-between items-center py-1",children:[Ce.jsxs("span",{className:"text-sm "+(a?"text-red-700 font-medium":""),children:[e.quantity,"x ",e.productName]}),Ce.jsxs("span",{className:"text-sm font-medium "+(a?"text-red-700":""),children:[a?"-":"",oe,Math.abs(e.totalPrice).toFixed(2)]})]},t)})})]}),Z&&Ce.jsx("div",{className:"mb-6",children:Ce.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[Ce.jsxs("div",{className:"flex items-center justify-between mb-3",children:[Ce.jsx("h3",{className:"text-lg font-semibold text-blue-800",children:"Cliente con Saldo"}),Ce.jsxs("div",{className:"text-right",children:[Ce.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:[oe,K.toFixed(2)]}),Ce.jsx("div",{className:"text-sm text-blue-600",children:"Saldo disponible"})]})]}),Ce.jsxs("div",{className:"space-y-3",children:[Ce.jsxs("div",{className:"flex items-center space-x-3",children:[Ce.jsx("input",{type:"checkbox",id:"useBalance",checked:I,onChange:e=>T(e.target.checked),disabled:null!==ee,className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500 "+(null!==ee?"opacity-50 cursor-not-allowed":"")}),Ce.jsxs("label",{htmlFor:"useBalance",className:"text-sm font-medium "+(null!==ee?"text-gray-500":"text-blue-800"),children:["Usar saldo del cliente",null!==ee&&Ce.jsx("span",{className:"block text-xs text-gray-400 mt-1",children:"No disponible para recargas"})]})]}),I&&Ce.jsx("div",{className:"bg-white rounded-lg p-3 border border-blue-200",children:Ce.jsxs("div",{className:"space-y-2",children:[Ce.jsxs("div",{className:"flex justify-between",children:[Ce.jsx("span",{className:"text-sm text-gray-600",children:"Total a pagar:"}),Ce.jsxs("span",{className:"font-medium",children:[oe,c.toFixed(2)]})]}),Ce.jsxs("div",{className:"flex justify-between",children:[Ce.jsx("span",{className:"text-sm text-gray-600",children:"Saldo a usar:"}),Ce.jsxs("span",{className:"font-medium text-blue-600",children:[oe,M.toFixed(2)]})]}),F>0&&Ce.jsxs(Ce.Fragment,{children:[Ce.jsxs("div",{className:"flex justify-between",children:[Ce.jsx("span",{className:"text-sm text-gray-600",children:"Restante a pagar:"}),Ce.jsxs("span",{className:"font-medium text-orange-600",children:[oe,F.toFixed(2)]})]}),Ce.jsxs("div",{className:"pt-2 border-t border-gray-200",children:[Ce.jsx("div",{className:"text-sm text-gray-600 mb-2",children:"Método para el resto:"}),Ce.jsxs("div",{className:"flex space-x-2",children:[Ce.jsx("button",{onClick:()=>W("cash"),className:"flex-1 py-2 px-3 rounded text-sm font-medium transition-colors "+("cash"===R?"bg-green-100 text-green-800 border border-green-300":"bg-gray-100 text-gray-700 border border-gray-300 hover:bg-gray-200"),children:"Efectivo"}),Ce.jsx("button",{onClick:()=>W("card"),className:"flex-1 py-2 px-3 rounded text-sm font-medium transition-colors "+("card"===R?"bg-blue-100 text-blue-800 border border-blue-300":"bg-gray-100 text-gray-700 border border-gray-300 hover:bg-gray-200"),children:"Tarjeta"})]})]})]})]})})]})]})}),Ce.jsx("div",{className:"rounded-lg p-4 mb-6 "+(ce?"bg-red-50 border-2 border-red-200":"bg-gray-50"),children:Ce.jsxs("div",{className:"space-y-2",children:[Ce.jsxs("div",{className:"flex justify-between",children:[Ce.jsx("span",{children:"Subtotal (sin IVA):"}),Ce.jsxs("span",{className:ce?"text-red-700":"",children:[ce&&ae<0?"-":"",oe,Zt(Math.abs(ae))]})]}),Ce.jsxs("div",{className:"flex justify-between",children:[Ce.jsx("span",{children:"IVA (21%):"}),Ce.jsxs("span",{className:ce?"text-red-700":"",children:[ce&&l<0?"-":"",oe,Zt(Math.abs(l))]})]}),Ce.jsxs("div",{className:"flex justify-between text-lg font-semibold border-t pt-2",children:[Ce.jsx("span",{children:"TOTAL (IVA incl.):"}),Ce.jsxs("span",{className:""+(ce?"text-red-700 font-bold":"text-primary-600"),children:[ce&&re<0?"-":"",oe,Zt(Math.abs(re))]})]}),I&&Z&&Ce.jsxs("div",{className:"border-t pt-2 space-y-1",children:[Ce.jsxs("div",{className:"flex justify-between text-sm",children:[Ce.jsx("span",{className:"text-blue-600",children:"Pagado con saldo:"}),Ce.jsxs("span",{className:"text-blue-600 font-medium",children:["-",oe,M.toFixed(2)]})]}),F>0&&Ce.jsxs("div",{className:"flex justify-between text-sm",children:[Ce.jsxs("span",{className:"text-orange-600",children:["Restante (","cash"===R?"Efectivo":"Tarjeta","):"]}),Ce.jsxs("span",{className:"text-orange-600 font-medium",children:[oe,F.toFixed(2)]})]})]}),ce&&Ce.jsx("div",{className:"mt-3 p-3 bg-red-100 border border-red-300 rounded-lg",children:Ce.jsxs("p",{className:"text-red-800 text-sm font-medium",children:["🔴 ATENCIÓN: Debe devolver ",oe,Zt(Math.abs(c))," al cliente"]})})]})}),(!I||F>0)&&Ce.jsxs("div",{className:"mb-6",children:[Ce.jsx("h3",{className:"text-lg font-semibold mb-3",children:I?"Método para el Resto":"Método de Pago"}),Ce.jsxs("div",{className:"flex space-x-4",children:[Ce.jsxs("button",{onClick:()=>I?W("cash"):k("cash"),className:"flex-1 flex items-center justify-center space-x-2 p-3 rounded-lg border-2 transition-colors "+("cash"===(I?R:C)?"border-primary-500 bg-primary-50 text-primary-700":"border-gray-300 hover:border-gray-400"),children:[Ce.jsx(z,{className:"w-5 h-5"}),Ce.jsx("span",{children:"Efectivo"})]}),Ce.jsxs("button",{onClick:()=>I?W("card"):k("card"),className:"flex-1 flex items-center justify-center space-x-2 p-3 rounded-lg border-2 transition-colors "+("card"===(I?R:C)?"border-primary-500 bg-primary-50 text-primary-700":"border-gray-300 hover:border-gray-400"),children:[Ce.jsx($,{className:"w-5 h-5"}),Ce.jsx("span",{children:"Tarjeta"})]})]})]}),(!I&&"cash"===C||I&&"cash"===R&&F>0)&&Ce.jsxs("div",{className:"mb-6",children:[Ce.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:I?"Cantidad Recibida (Resto)":"Cantidad Recibida"}),Ce.jsxs("button",{onClick:()=>(X(I?"remaining":"cash"),void Y(!0)),className:"w-full px-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-left bg-white hover:bg-gray-50 transition-colors",children:[Ce.jsx("span",{className:I?B?"text-gray-900":"text-gray-500":D?"text-gray-900":"text-gray-500",children:I?B||"0.00":D||"0.00"}),Ce.jsx("span",{className:"text-gray-400 ml-2",children:"€"})]}),parseFloat(I?B:D)>0&&Ce.jsxs("div",{className:"mt-2 text-sm",children:[Ce.jsx("span",{className:"text-gray-600",children:"Cambio: "}),Ce.jsxs("span",{className:"font-semibold "+((I?me:le)>=0?"text-green-600":"text-red-600"),children:[oe,(I?me:le).toFixed(2)]})]}),!I&&D&&parseFloat(D)<c&&!w&&Ce.jsxs("div",{className:"mt-2 p-2 bg-yellow-50 border border-yellow-200 rounded text-yellow-800 text-xs",children:["⚠️ Cobro parcial: Quedarán ",oe,(c-parseFloat(D)).toFixed(2)," pendientes"]}),!I&&D&&parseFloat(D)<c&&w&&Ce.jsxs("div",{className:"mt-2 p-2 bg-red-50 border border-red-200 rounded text-red-800 text-xs",children:["❌ Se requiere el pago completo de ",oe,c.toFixed(2)]})]}),Ce.jsxs("div",{className:"space-y-3",children:[Ce.jsxs("button",{onClick:ue,className:"w-full bg-blue-600 hover:bg-blue-700 text-white py-3 px-4 rounded-lg flex items-center justify-center space-x-2 transition-colors",children:[Ce.jsx(L,{className:"w-4 h-4"}),Ce.jsx("span",{children:"Previsualizar Ticket PDF"})]}),Ce.jsxs("button",{onClick:async()=>{const e=parseFloat(D||"0");if(w&&e<re)return void alert(`Para tickets sin mesa se requiere el pago completo de ${oe}${re.toFixed(2)}`);if(y&&v&&e<re&&!w){const a=re-e,s=`¿Confirmar cobro parcial?\n\nMesa: ${n}\nMonto cobrado: ${oe}${e.toFixed(2)}\nMonto pendiente: ${oe}${a.toFixed(2)}\n\nLa cuenta quedará abierta con ${oe}${a.toFixed(2)} pendientes por pagar.`;if(!confirm(s))return;const r={orderItems:te,tableNumber:ie,customerName:ne,subtotal:ae,tax:se,total:e,paymentMethod:"balance"===C?"cash":C,cashReceived:D||e.toString(),mergedTableNumber:d,selectedCustomer:f,restaurantName:V.restaurantName,currencySymbol:_(),documentType:"partial_receipt"};try{return await ta(r),v(e,"balance"===C?"cash":C),void t()}catch(xe){return}}const a=localStorage.getItem("rechargeData");if(a)try{const e=JSON.parse(a);if(e.customer&&e.amount){const t=e.customer.balance+e.amount+e.bonus;await Gt.customers.update(e.customer.id,{balance:t,updatedAt:new Date}),await Q(),localStorage.removeItem("rechargeData")}}catch(xe){}else if(I&&f&&M>0)try{const e=K-M;await Gt.customers.update(f.id,{balance:e,updatedAt:new Date}),await Q()}catch(m){}if(ue(),I&&F>0)try{const e={orderItems:r,tableNumber:n,customerName:i,subtotal:o,tax:l,total:F,paymentMethod:R,cashReceived:B||F.toString(),mergedTableNumber:d,selectedCustomer:f,useBalance:!1,balanceAmount:0,remainingAmount:0,remainingPaymentMethod:R,restaurantName:V.restaurantName,currencySymbol:_(),documentType:"ticket"};await ta(e)}catch(xe){}if(!u)try{await Gt.orders.add({tableId:n?parseInt(n):void 0,customerName:i||void 0,status:"paid",items:r.map(e=>({productId:0,productName:e.productName,quantity:e.quantity,unitPrice:e.unitPrice,totalPrice:e.totalPrice,status:"delivered"})),subtotal:o,tax:l,discount:0,total:c,createdAt:new Date,updatedAt:new Date,closedAt:new Date})}catch(m){}s(),t()},disabled:!I&&"cash"===C&&!D||I&&F>0&&"cash"===R&&!B,className:"w-full bg-green-600 hover:bg-green-700 disabled:bg-gray-400 text-white py-4 px-6 rounded-lg flex items-center justify-center space-x-2 font-semibold text-lg transition-colors disabled:cursor-not-allowed",children:[Ce.jsx(q,{className:"w-5 h-5"}),Ce.jsx("span",{children:I&&0===F?"Completar Cobro con Saldo e Imprimir PDF":"Completar Cobro e Imprimir PDF"})]})]})]})]})]}),U&&H&&Ce.jsx(ra,{value:"cash"===H?parseFloat(D||"0"):parseFloat(B||"0"),onConfirm:e=>{"cash"===H?P(e.toString()):"remaining"===H&&G(e.toString()),Y(!1),X(null)},onCancel:()=>{Y(!1),X(null)},currencySymbol:oe})]})},ia=({isOpen:e,onClose:t})=>{const[s,r]=a.useState([]),{tables:n,mergeTables:i,getTableOrderItems:o}=Wt(),l=n.filter(e=>("available"===e.status||"occupied"===e.status)&&!e.mergedWith);return e?Ce.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:Ce.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[Ce.jsx("div",{className:"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75",onClick:t}),Ce.jsxs("div",{className:"inline-block w-full max-w-2xl my-8 overflow-hidden text-left align-middle transition-all transform bg-white shadow-xl rounded-lg",children:[Ce.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[Ce.jsxs("div",{className:"flex items-center space-x-3",children:[Ce.jsx(B,{className:"w-6 h-6 text-blue-600"}),Ce.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Unir Mesas"})]}),Ce.jsx("button",{onClick:t,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:Ce.jsx(S,{className:"w-5 h-5"})})]}),Ce.jsx("div",{className:"p-6",children:l.length<2?Ce.jsxs("div",{className:"text-center py-8",children:[Ce.jsx(G,{className:"w-12 h-12 mx-auto mb-4 text-yellow-500"}),Ce.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No hay suficientes mesas para unir"}),Ce.jsx("p",{className:"text-gray-600",children:"Necesitas al menos 2 mesas disponibles u ocupadas (que no estén ya unidas) para poder unirlas."})]}):Ce.jsxs(Ce.Fragment,{children:[Ce.jsxs("div",{className:"mb-6",children:[Ce.jsx("p",{className:"text-gray-600 mb-4",children:"Selecciona las mesas que quieres unir. La primera mesa seleccionada será la principal. Puedes unir mesas disponibles u ocupadas."}),Ce.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-4",children:Ce.jsxs("div",{className:"flex",children:[Ce.jsx(G,{className:"w-5 h-5 text-yellow-600 mr-2 mt-0.5"}),Ce.jsxs("div",{className:"text-sm text-yellow-800",children:[Ce.jsx("p",{className:"font-medium mb-1",children:"Importante:"}),Ce.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[Ce.jsx("li",{children:"Los pedidos se combinarán en la mesa principal"}),Ce.jsx("li",{children:"La primera mesa seleccionada será la principal"}),Ce.jsx("li",{children:"Puedes unir múltiples mesas a la vez"}),Ce.jsx("li",{children:"Las mesas mostrarán indicadores visuales de unión"})]})]})]})})]}),Ce.jsxs("div",{children:[Ce.jsxs("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:["Mesas Seleccionadas (",s.length,")"]}),Ce.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:l.map(e=>{const t=s.some(t=>t.id===e.id),a=s.length>0&&s[0].id===e.id;return Ce.jsx("div",{onClick:()=>(e=>{r(t=>t.some(t=>t.id===e.id)?t.filter(t=>t.id!==e.id):[...t,e])})(e),className:"p-4 border rounded-lg cursor-pointer transition-all "+(t?a?"border-blue-500 bg-blue-50 ring-2 ring-blue-200":"border-green-500 bg-green-50 ring-2 ring-green-200":"border-gray-200 hover:border-gray-300 hover:bg-gray-50"),children:Ce.jsxs("div",{className:"flex items-center justify-between",children:[Ce.jsxs("div",{className:"flex items-center space-x-3",children:[Ce.jsxs("div",{children:[Ce.jsxs("div",{className:"font-medium",children:["Mesa ",e.number]}),e.name&&Ce.jsx("div",{className:"text-sm text-gray-600",children:e.name}),Ce.jsxs("div",{className:"text-xs text-gray-500",children:[o(e.id).length," productos"]})]}),t&&Ce.jsx("div",{className:"text-sm font-medium",children:a?"⭐ Principal":"🔗 Unir"})]}),Ce.jsx("div",{className:"w-4 h-4 rounded-full "+("available"===e.status?"bg-green-500":"bg-red-500")})]})},e.id)})})]}),s.length>=2&&Ce.jsxs("div",{className:"mt-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[Ce.jsx("h4",{className:"text-sm font-medium text-blue-900 mb-2",children:"Resumen de la Unión"}),Ce.jsxs("div",{className:"text-sm text-blue-800",children:[Ce.jsxs("p",{children:[Ce.jsx("strong",{children:"Mesa Principal:"})," Mesa ",s[0].number,"(",o(s[0].id).length," productos)"]}),Ce.jsxs("p",{children:[Ce.jsx("strong",{children:"Mesas a Unir:"})," ",s.slice(1).map(e=>`Mesa ${e.number} (${o(e.id).length} productos)`).join(", ")]}),Ce.jsxs("p",{className:"mt-2",children:[Ce.jsx("strong",{children:"Total después de unir:"})," ",s.reduce((e,t)=>e+o(t.id).length,0)," productos"]})]})]})]})}),l.length>=2&&Ce.jsxs("div",{className:"px-6 py-4 bg-gray-50 border-t border-gray-200 flex space-x-3",children:[Ce.jsx("button",{onClick:()=>{r([])},className:"flex-1 px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Limpiar Selección"}),Ce.jsx("button",{onClick:t,className:"flex-1 px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancelar"}),Ce.jsxs("button",{onClick:()=>{if(s.length<2)return void P.error("Debes seleccionar al menos dos mesas para unir");if(new Set(s.map(e=>e.id)).size!==s.length)return void P.error("No puedes seleccionar la misma mesa más de una vez");const e=s[0],a=s.slice(1),n=s.reduce((e,t)=>e+o(t.id).length,0),l=s.map(e=>e.number).join(", ");a.map(e=>e.number).join(", "),window.confirm(`¿Estás seguro de que quieres unir las mesas ${l}?\n\nSe combinarán ${n} productos en total.\nLa mesa ${e.number} será la mesa principal.`)&&(a.forEach(t=>{i(e.id,t.id)}),P.success(`Mesas ${l} unidas exitosamente`),t(),r([]))},disabled:s.length<2,className:"flex-1 px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:["Unir ",s.length," Mesa",1!==s.length?"s":""]})]})]})]})}):null},oa=({isOpen:e,onClose:t,productName:a,tariffs:s,onSelectTariff:r,currencySymbol:n="€"})=>{if(!e)return null;return Ce.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:Ce.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[Ce.jsx("div",{className:"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75",onClick:t}),Ce.jsxs("div",{className:"inline-block align-bottom bg-white rounded-2xl text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:[Ce.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-600 px-6 py-4",children:[Ce.jsxs("div",{className:"flex items-center justify-between",children:[Ce.jsx("h3",{className:"text-lg font-semibold text-white",children:"Seleccionar Tarifa"}),Ce.jsx("button",{onClick:t,className:"text-white hover:text-gray-200 p-2 rounded-lg hover:bg-white/20 transition-colors",children:Ce.jsx(S,{className:"w-5 h-5"})})]}),Ce.jsx("p",{className:"text-blue-100 text-sm mt-1",children:a})]}),Ce.jsxs("div",{className:"px-6 py-6",children:[Ce.jsx("div",{className:"space-y-3",children:s.map(e=>Ce.jsx("button",{onClick:()=>(e=>{r(e),t()})(e),className:"w-full p-4 border-2 border-gray-200 rounded-xl hover:border-blue-300 hover:bg-blue-50 transition-all duration-200 text-left group",children:Ce.jsxs("div",{className:"flex items-center justify-between",children:[Ce.jsxs("div",{className:"flex-1",children:[Ce.jsxs("div",{className:"flex items-center space-x-2",children:[Ce.jsx("span",{className:"font-medium text-gray-900",children:e.name}),e.isDefault&&Ce.jsx("span",{className:"text-xs bg-blue-100 text-blue-600 px-2 py-1 rounded-full",children:"Predeterminada"})]}),Ce.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[a," - ",e.name]})]}),Ce.jsxs("div",{className:"flex items-center space-x-3",children:[Ce.jsxs("span",{className:"text-lg font-bold text-gray-900",children:[n,e.price.toFixed(2)]}),Ce.jsx("div",{className:"w-6 h-6 border-2 border-gray-300 rounded-full group-hover:border-blue-500 transition-colors flex items-center justify-center",children:Ce.jsx(U,{className:"w-4 h-4 text-white opacity-0 group-hover:opacity-100 transition-opacity"})})]})]})},e.id))}),Ce.jsx("div",{className:"mt-6 pt-4 border-t border-gray-200",children:Ce.jsx("button",{onClick:t,className:"w-full px-4 py-2 text-gray-600 hover:text-gray-800 font-medium rounded-lg hover:bg-gray-100 transition-colors",children:"Cancelar"})})]})]})]})})},la=({isOpen:e,onClose:t,baseProduct:s,combinations:r,availableProducts:n,onConfirmCombination:i,currencySymbol:o="€"})=>{const[l,c]=a.useState([]);if(!e)return null;const d=n.filter(e=>r.some(t=>!(!t.productId||t.productId!==e.id||!t.isActive)||!(!t.categoryId||t.categoryId!==e.categoryId||!t.isActive))),m=e=>{const t=r.find(t=>t.productId===e.id);if(t)return t.additionalPrice;const a=r.find(t=>t.categoryId===e.categoryId);return(null==a?void 0:a.additionalPrice)||0},u=()=>{c([]),t()};return Ce.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:Ce.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[Ce.jsx("div",{className:"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75",onClick:u}),Ce.jsxs("div",{className:"inline-block align-bottom bg-white rounded-2xl text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-4xl sm:w-full",children:[Ce.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-600 px-6 py-4",children:[Ce.jsxs("div",{className:"flex items-center justify-between",children:[Ce.jsx("h3",{className:"text-lg font-semibold text-white",children:"Combinar Producto"}),Ce.jsx("button",{onClick:u,className:"text-white hover:text-gray-200 p-2 rounded-lg hover:bg-white/20 transition-colors",children:Ce.jsx(S,{className:"w-5 h-5"})})]}),Ce.jsxs("p",{className:"text-blue-100 text-sm mt-1",children:[s.name," - Selecciona productos para combinar"]})]}),Ce.jsxs("div",{className:"px-6 py-6",children:[Ce.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[Ce.jsxs("div",{children:[Ce.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"Productos Disponibles"}),Ce.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:d.map(e=>{const t=m(e);return Ce.jsx("button",{onClick:()=>(e=>{const t=l.find(t=>t.product.id===e.id);c(t?l.map(t=>t.product.id===e.id?{...t,quantity:t.quantity+1}:t):[...l,{product:e,quantity:1}])})(e),className:"w-full p-3 border border-gray-200 rounded-lg hover:border-blue-300 hover:bg-blue-50 transition-all duration-200 text-left group",children:Ce.jsxs("div",{className:"flex items-center justify-between",children:[Ce.jsxs("div",{className:"flex-1",children:[Ce.jsxs("div",{className:"flex items-center space-x-2",children:[Ce.jsx("span",{className:"font-medium text-gray-900",children:e.name}),Ce.jsxs("span",{className:"text-xs px-2 py-1 rounded "+(t>0?"bg-green-100 text-green-600":t<0?"bg-red-100 text-red-600":"bg-gray-100 text-gray-600"),children:[t>0?"+":"",o,t.toFixed(2)]})]}),Ce.jsx("p",{className:"text-sm text-gray-500 mt-1",children:e.description||"Sin descripción"})]}),Ce.jsxs("div",{className:"flex items-center space-x-2",children:[Ce.jsxs("span",{className:"text-sm text-gray-600",children:[o,e.price.toFixed(2)]}),Ce.jsx(F,{className:"w-4 h-4 text-blue-500 opacity-0 group-hover:opacity-100 transition-opacity"})]})]})},e.id)})})]}),Ce.jsxs("div",{children:[Ce.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"Productos Seleccionados"}),Ce.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:0===l.length?Ce.jsxs("div",{className:"text-center py-8 text-gray-500",children:[Ce.jsx("p",{children:"No hay productos seleccionados"}),Ce.jsx("p",{className:"text-sm mt-1",children:"Selecciona productos de la lista para combinarlos"})]}):l.map(({product:e,quantity:t})=>{const a=m(e);return Ce.jsx("div",{className:"p-3 border border-gray-200 rounded-lg bg-gray-50",children:Ce.jsxs("div",{className:"flex items-center justify-between",children:[Ce.jsxs("div",{className:"flex-1",children:[Ce.jsxs("div",{className:"flex items-center space-x-2",children:[Ce.jsx("span",{className:"font-medium text-gray-900",children:e.name}),Ce.jsxs("span",{className:"text-xs bg-green-100 text-green-600 px-2 py-1 rounded",children:["x",t]})]}),Ce.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[a>0?"+":"",o,a.toFixed(2)," por unidad"]})]}),Ce.jsxs("div",{className:"flex items-center space-x-2",children:[Ce.jsxs("span",{className:"text-sm font-medium "+(a*t>0?"text-green-600":a*t<0?"text-red-600":"text-gray-600"),children:[a*t>0?"+":"",o,(a*t).toFixed(2)]}),Ce.jsx("button",{onClick:()=>(e=>{const t=l.find(t=>t.product.id===e);t&&t.quantity>1?c(l.map(t=>t.product.id===e?{...t,quantity:t.quantity-1}:t)):c(l.filter(t=>t.product.id!==e))})(e.id),className:"p-1 text-red-600 hover:bg-red-50 rounded",children:Ce.jsx(Y,{className:"w-4 h-4"})})]})]})},e.id)})})]})]}),Ce.jsx("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:Ce.jsxs("div",{className:"flex items-center justify-between",children:[Ce.jsxs("div",{children:[Ce.jsx("p",{className:"text-sm text-gray-600",children:"Precio base:"}),Ce.jsx("p",{className:"text-sm text-gray-600",children:"Precio combinaciones:"}),Ce.jsx("p",{className:"font-medium text-gray-900",children:"Total:"})]}),Ce.jsxs("div",{className:"text-right",children:[Ce.jsxs("p",{className:"text-sm text-gray-600",children:[o,s.price.toFixed(2)]}),Ce.jsxs("p",{className:"text-sm text-gray-600",children:["+",o,l.reduce((e,t)=>e+m(t.product)*t.quantity,0).toFixed(2)]}),Ce.jsxs("p",{className:"font-medium text-lg text-gray-900",children:[o,(s.price+l.reduce((e,t)=>e+m(t.product)*t.quantity,0)).toFixed(2)]})]})]})}),Ce.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[Ce.jsx("button",{onClick:u,className:"px-4 py-2 text-gray-600 hover:text-gray-800 font-medium rounded-lg hover:bg-gray-100 transition-colors",children:"Cancelar"}),Ce.jsx("button",{onClick:()=>{i(s,l),c([]),t()},disabled:0===l.length,className:"px-6 py-2 bg-blue-600 text-white font-medium rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Confirmar Combinación"})]})]})]})]})})},ca=({isOpen:e,onClose:t,title:s="Seleccionar modificadores",options:r,selected:n,onSave:i,allowCustomText:o=!0})=>{const[l,c]=a.useState(n),[d,m]=a.useState("");if(a.useEffect(()=>{c(n)},[n,e]),!e)return null;return Ce.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:Ce.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[Ce.jsx("div",{className:"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75",onClick:t}),Ce.jsxs("div",{className:"inline-block align-bottom bg-white rounded-2xl text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:[Ce.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-600 px-6 py-4",children:[Ce.jsxs("div",{className:"flex items-center justify-between",children:[Ce.jsx("h3",{className:"text-lg font-semibold text-white",children:s}),Ce.jsx("button",{onClick:t,className:"text-white hover:text-gray-200 p-2 rounded-lg hover:bg-white/20 transition-colors",children:Ce.jsx(S,{className:"w-5 h-5"})})]}),Ce.jsx("p",{className:"text-blue-100 text-sm mt-1",children:"Selecciona las opciones que apliquen. No alteran el precio."})]}),Ce.jsxs("div",{className:"px-6 py-6",children:[0===r.length?Ce.jsx("div",{className:"text-center text-gray-500 py-8",children:"No hay modificadores disponibles para este producto."}):Ce.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:r.map(e=>{const t=l.includes(e);return Ce.jsxs("button",{onClick:()=>(e=>{c(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])})(e),className:"flex items-center justify-between w-full px-4 py-3 rounded-lg border transition-all duration-200 "+(t?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-200 hover:border-blue-300 hover:bg-blue-50/50 text-gray-700"),children:[Ce.jsx("span",{className:"text-sm font-medium",children:e}),t&&Ce.jsx(U,{className:"w-4 h-4"})]},e)})}),o&&Ce.jsxs("div",{className:"mt-4",children:[Ce.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Añadir nota/modificador específico"}),Ce.jsx("input",{type:"text",value:d,onChange:e=>m(e.target.value),placeholder:"Escribe algo como: Sin pepinillos, punto de la carne, etc.",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),Ce.jsxs("div",{className:"px-6 pb-6 flex items-center justify-between",children:[Ce.jsx("button",{onClick:()=>{c([])},className:"px-4 py-2 text-gray-600 hover:text-gray-800 font-medium rounded-lg hover:bg-gray-100 transition-colors",children:"Limpiar"}),Ce.jsxs("div",{className:"space-x-3",children:[Ce.jsx("button",{onClick:t,className:"px-4 py-2 text-gray-600 hover:text-gray-800 font-medium rounded-lg hover:bg-gray-100 transition-colors",children:"Cancelar"}),Ce.jsx("button",{onClick:()=>{const e=d.trim()?Array.from(new Set([...l,d.trim()])):l;i(e),t()},className:"px-6 py-2 bg-blue-600 text-white font-medium rounded-lg hover:bg-blue-700 transition-colors",children:"Guardar"})]})]})]})]})})},da=({isOpen:e,onClose:t,onConfirm:a,title:s,message:r,type:n="danger"})=>{if(!e)return null;const i=(()=>{switch(n){case"danger":return{icon:H,iconColor:"text-red-600",bgColor:"bg-red-50",borderColor:"border-red-200",buttonColor:"bg-red-600 hover:bg-red-700"};case"warning":return{icon:G,iconColor:"text-yellow-600",bgColor:"bg-yellow-50",borderColor:"border-yellow-200",buttonColor:"bg-yellow-600 hover:bg-yellow-700"};default:return{icon:G,iconColor:"text-blue-600",bgColor:"bg-blue-50",borderColor:"border-blue-200",buttonColor:"bg-blue-600 hover:bg-blue-700"}}})(),o=i.icon;return Ce.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:Ce.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-md w-full",children:[Ce.jsxs("div",{className:`flex items-center justify-between p-6 ${i.bgColor} ${i.borderColor} border-b rounded-t-xl`,children:[Ce.jsxs("div",{className:"flex items-center space-x-3",children:[Ce.jsx("div",{className:`w-10 h-10 ${i.bgColor} rounded-full flex items-center justify-center`,children:Ce.jsx(o,{className:`w-5 h-5 ${i.iconColor}`})}),Ce.jsx("div",{children:Ce.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:s})})]}),Ce.jsx("button",{onClick:t,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:Ce.jsx(S,{className:"w-5 h-5"})})]}),Ce.jsx("div",{className:"p-6",children:Ce.jsx("p",{className:"text-gray-700 leading-relaxed",children:r})}),Ce.jsxs("div",{className:"flex items-center justify-end space-x-3 p-6 border-t border-gray-200",children:[Ce.jsx("button",{onClick:t,className:"px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:"Cancelar"}),Ce.jsxs("button",{onClick:a,className:`px-6 py-2 text-white font-medium rounded-lg transition-colors flex items-center space-x-2 ${i.buttonColor}`,children:[Ce.jsx(H,{className:"w-4 h-4"}),Ce.jsx("span",{children:"Confirmar"})]})]})]})})},ma=a.createContext(void 0),ua=({children:e})=>{const[t,s]=a.useState([]),[r,n]=a.useState([]);a.useEffect(()=>{try{const e=localStorage.getItem("kimipos_products"),t=localStorage.getItem("kimipos_categories");if(e){const t=JSON.parse(e).map(e=>({...e,createdAt:new Date(e.createdAt),updatedAt:new Date(e.updatedAt)}));s(t)}else{s([{id:"1",name:"Coca Cola",price:25,categoryId:"cat-1",description:"Refresco de cola 350ml",backgroundColor:"#dc2626",tariffs:[{id:"1-1",name:"350ml",price:25,isDefault:!0}],isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"2",name:"Sprite",price:25,categoryId:"cat-1",description:"Refresco de limón 350ml",backgroundColor:"#16a34a",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"3",name:"Fanta Naranja",price:25,categoryId:"cat-1",description:"Refresco de naranja 350ml",backgroundColor:"#ea580c",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"4",name:"Pepsi",price:23,categoryId:"cat-1",description:"Refresco de cola 350ml",backgroundColor:"#2563eb",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"5",name:"7UP",price:25,categoryId:"cat-1",description:"Refresco de lima-limón 350ml",backgroundColor:"#65a30d",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"6",name:"Mirinda",price:25,categoryId:"cat-1",description:"Refresco de naranja 350ml",backgroundColor:"#ea580c",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"7",name:"Mountain Dew",price:28,categoryId:"cat-1",description:"Refresco cítrico 350ml",backgroundColor:"#65a30d",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"8",name:"Dr Pepper",price:30,categoryId:"cat-1",description:"Refresco de cereza 350ml",backgroundColor:"#dc2626",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"9",name:"Agua Mineral",price:15,categoryId:"cat-1",description:"Agua mineral 500ml",backgroundColor:"#0891b2",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"10",name:"Agua con Gas",price:18,categoryId:"cat-1",description:"Agua carbonatada 500ml",backgroundColor:"#0891b2",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"11",name:"Jugo de Naranja",price:35,categoryId:"cat-1",description:"Jugo natural 300ml",backgroundColor:"#ea580c",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"12",name:"Jugo de Manzana",price:35,categoryId:"cat-1",description:"Jugo natural 300ml",backgroundColor:"#16a34a",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"13",name:"Limonada",price:30,categoryId:"cat-1",description:"Limonada natural 400ml",backgroundColor:"#ca8a04",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"14",name:"Té Helado",price:25,categoryId:"cat-1",description:"Té helado 350ml",backgroundColor:"#92400e",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"15",name:"Café Americano",price:20,categoryId:"cat-1",description:"Café americano 250ml",backgroundColor:"#92400e",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"16",name:"Café Expresso",price:18,categoryId:"cat-1",description:"Café expresso 30ml",backgroundColor:"#92400e",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"17",name:"Café Capuccino",price:25,categoryId:"cat-1",description:"Café capuccino 200ml",backgroundColor:"#92400e",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"18",name:"Café Latte",price:28,categoryId:"cat-1",description:"Café latte 250ml",backgroundColor:"#92400e",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"19",name:"Chocolate Caliente",price:30,categoryId:"cat-1",description:"Chocolate caliente 250ml",backgroundColor:"#92400e",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"20",name:"Té Verde",price:22,categoryId:"cat-1",description:"Té verde 250ml",backgroundColor:"#16a34a",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"21",name:"Corona",price:45,categoryId:"cat-2",description:"Cerveza 355ml",backgroundColor:"#fbbf24",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"22",name:"Heineken",price:50,categoryId:"cat-2",description:"Cerveza premium 355ml",backgroundColor:"#16a34a",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"23",name:"Budweiser",price:40,categoryId:"cat-2",description:"Cerveza 355ml",backgroundColor:"#dc2626",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"24",name:"Miller Lite",price:42,categoryId:"cat-2",description:"Cerveza light 355ml",backgroundColor:"#fbbf24",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"25",name:"Coors Light",price:43,categoryId:"cat-2",description:"Cerveza light 355ml",backgroundColor:"#0891b2",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"26",name:"Stella Artois",price:55,categoryId:"cat-2",description:"Cerveza belga 330ml",backgroundColor:"#fbbf24",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"27",name:"Dos Equis",price:48,categoryId:"cat-2",description:"Cerveza mexicana 355ml",backgroundColor:"#fbbf24",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"28",name:"Tecate",price:35,categoryId:"cat-2",description:"Cerveza mexicana 355ml",backgroundColor:"#dc2626",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"29",name:"Modelo Especial",price:45,categoryId:"cat-2",description:"Cerveza mexicana 355ml",backgroundColor:"#fbbf24",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"30",name:"Pacifico",price:42,categoryId:"cat-2",description:"Cerveza mexicana 355ml",backgroundColor:"#0891b2",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"31",name:"Sol",price:38,categoryId:"cat-2",description:"Cerveza mexicana 355ml",backgroundColor:"#fbbf24",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"32",name:"Victoria",price:40,categoryId:"cat-2",description:"Cerveza mexicana 355ml",backgroundColor:"#fbbf24",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"33",name:"Indio",price:35,categoryId:"cat-2",description:"Cerveza mexicana 355ml",backgroundColor:"#92400e",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"34",name:"Bohemia",price:45,categoryId:"cat-2",description:"Cerveza mexicana 355ml",backgroundColor:"#fbbf24",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"35",name:"Negra Modelo",price:48,categoryId:"cat-2",description:"Cerveza oscura 355ml",backgroundColor:"#92400e",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"36",name:"Guinness",price:65,categoryId:"cat-2",description:"Cerveza stout 330ml",backgroundColor:"#18181b",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"37",name:"Blue Moon",price:58,categoryId:"cat-2",description:"Cerveza de trigo 355ml",backgroundColor:"#0891b2",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"38",name:"Samuel Adams",price:52,categoryId:"cat-2",description:"Cerveza artesanal 355ml",backgroundColor:"#fbbf24",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"39",name:"Sierra Nevada",price:55,categoryId:"cat-2",description:"Cerveza IPA 355ml",backgroundColor:"#16a34a",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"40",name:"Lagunitas",price:58,categoryId:"cat-2",description:"Cerveza IPA 355ml",backgroundColor:"#fbbf24",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"41",name:"Jack Daniels",price:120,categoryId:"cat-3",description:"Whisky 50ml",backgroundColor:"#92400e",combinations:[{id:"comb-41-1",productId:"1",additionalPrice:25,isActive:!0},{id:"comb-41-2",productId:"2",additionalPrice:20,isActive:!0},{id:"comb-41-3",categoryId:"cat-1",additionalPrice:-1,isActive:!0}],isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"42",name:"Jim Beam",price:95,categoryId:"cat-3",description:"Whisky bourbon 50ml",backgroundColor:"#92400e",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"43",name:"Maker's Mark",price:140,categoryId:"cat-3",description:"Whisky bourbon 50ml",backgroundColor:"#dc2626",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"44",name:"Wild Turkey",price:110,categoryId:"cat-3",description:"Whisky bourbon 50ml",backgroundColor:"#92400e",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"45",name:"Bulleit",price:130,categoryId:"cat-3",description:"Whisky bourbon 50ml",backgroundColor:"#92400e",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"46",name:"Johnnie Walker Red",price:100,categoryId:"cat-3",description:"Whisky escocés 50ml",backgroundColor:"#dc2626",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"47",name:"Johnnie Walker Black",price:180,categoryId:"cat-3",description:"Whisky escocés 50ml",backgroundColor:"#18181b",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"48",name:"Chivas Regal",price:160,categoryId:"cat-3",description:"Whisky escocés 50ml",backgroundColor:"#fbbf24",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"49",name:"Glenfiddich",price:220,categoryId:"cat-3",description:"Whisky single malt 50ml",backgroundColor:"#fbbf24",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"50",name:"Macallan",price:350,categoryId:"cat-3",description:"Whisky single malt 50ml",backgroundColor:"#92400e",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"51",name:"Jameson",price:110,categoryId:"cat-3",description:"Whisky irlandés 50ml",backgroundColor:"#16a34a",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"52",name:"Bushmills",price:105,categoryId:"cat-3",description:"Whisky irlandés 50ml",backgroundColor:"#16a34a",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"53",name:"Crown Royal",price:125,categoryId:"cat-3",description:"Whisky canadiense 50ml",backgroundColor:"#7c3aed",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"54",name:"Canadian Club",price:90,categoryId:"cat-3",description:"Whisky canadiense 50ml",backgroundColor:"#92400e",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"55",name:"Suntory Toki",price:140,categoryId:"cat-3",description:"Whisky japonés 50ml",backgroundColor:"#0891b2",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"56",name:"Nikka",price:160,categoryId:"cat-3",description:"Whisky japonés 50ml",backgroundColor:"#0891b2",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"57",name:"Yamazaki",price:280,categoryId:"cat-3",description:"Whisky japonés 50ml",backgroundColor:"#0891b2",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"58",name:"Hibiki",price:320,categoryId:"cat-3",description:"Whisky japonés 50ml",backgroundColor:"#0891b2",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"59",name:"Evan Williams",price:75,categoryId:"cat-3",description:"Whisky bourbon 50ml",backgroundColor:"#92400e",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"60",name:"Old Grand-Dad",price:85,categoryId:"cat-3",description:"Whisky bourbon 50ml",backgroundColor:"#92400e",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"61",name:"Bacardi Blanco",price:85,categoryId:"cat-4",description:"Ron blanco 50ml",backgroundColor:"#fbbf24",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"62",name:"Bacardi Dorado",price:90,categoryId:"cat-4",description:"Ron dorado 50ml",backgroundColor:"#fbbf24",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"63",name:"Havana Club",price:95,categoryId:"cat-4",description:"Ron cubano 50ml",backgroundColor:"#fbbf24",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"64",name:"Captain Morgan",price:88,categoryId:"cat-4",description:"Ron especiado 50ml",backgroundColor:"#92400e",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"65",name:"Malibu",price:95,categoryId:"cat-4",description:"Ron con coco 50ml",backgroundColor:"#fbbf24",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"66",name:"Kraken",price:110,categoryId:"cat-4",description:"Ron especiado 50ml",backgroundColor:"#18181b",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"67",name:"Mount Gay",price:105,categoryId:"cat-4",description:"Ron barbadense 50ml",backgroundColor:"#fbbf24",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"68",name:"Appleton Estate",price:115,categoryId:"cat-4",description:"Ron jamaicano 50ml",backgroundColor:"#92400e",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"69",name:"Goslings",price:100,categoryId:"cat-4",description:"Ron bermudeño 50ml",backgroundColor:"#92400e",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"70",name:"Zacapa",price:180,categoryId:"cat-4",description:"Ron guatemalteco 50ml",backgroundColor:"#92400e",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"71",name:"Flor de Caña",price:95,categoryId:"cat-4",description:"Ron nicaragüense 50ml",backgroundColor:"#fbbf24",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"72",name:"Brugal",price:85,categoryId:"cat-4",description:"Ron dominicano 50ml",backgroundColor:"#fbbf24",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"73",name:"Barceló",price:90,categoryId:"cat-4",description:"Ron dominicano 50ml",backgroundColor:"#fbbf24",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"74",name:"Matusalem",price:110,categoryId:"cat-4",description:"Ron dominicano 50ml",backgroundColor:"#92400e",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"75",name:"Don Q",price:88,categoryId:"cat-4",description:"Ron puertorriqueño 50ml",backgroundColor:"#fbbf24",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"76",name:"Ron Abuelo",price:120,categoryId:"cat-4",description:"Ron panameño 50ml",backgroundColor:"#92400e",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"77",name:"Diplomatico",price:160,categoryId:"cat-4",description:"Ron venezolano 50ml",backgroundColor:"#92400e",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"78",name:"Santa Teresa",price:140,categoryId:"cat-4",description:"Ron venezolano 50ml",backgroundColor:"#92400e",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"79",name:"Pampero",price:95,categoryId:"cat-4",description:"Ron venezolano 50ml",backgroundColor:"#92400e",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"80",name:"Cacique",price:85,categoryId:"cat-4",description:"Ron venezolano 50ml",backgroundColor:"#fbbf24",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"81",name:"Bombay Sapphire",price:110,categoryId:"cat-5",description:"Ginebra premium 50ml",backgroundColor:"#0891b2",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"82",name:"Tanqueray",price:105,categoryId:"cat-5",description:"Ginebra londinense 50ml",backgroundColor:"#16a34a",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"83",name:"Beefeater",price:95,categoryId:"cat-5",description:"Ginebra londinense 50ml",backgroundColor:"#16a34a",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"84",name:"Gordon's",price:75,categoryId:"cat-5",description:"Ginebra 50ml",backgroundColor:"#16a34a",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"85",name:"Hendrick's",price:140,categoryId:"cat-5",description:"Ginebra premium 50ml",backgroundColor:"#16a34a",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"86",name:"Plymouth",price:125,categoryId:"cat-5",description:"Ginebra inglesa 50ml",backgroundColor:"#16a34a",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"87",name:"Sipsmith",price:130,categoryId:"cat-5",description:"Ginebra artesanal 50ml",backgroundColor:"#16a34a",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"88",name:"Monkey 47",price:180,categoryId:"cat-5",description:"Ginebra alemana 50ml",backgroundColor:"#16a34a",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"89",name:"Malfy",price:115,categoryId:"cat-5",description:"Ginebra italiana 50ml",backgroundColor:"#0891b2",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"90",name:"Citadelle",price:120,categoryId:"cat-5",description:"Ginebra francesa 50ml",backgroundColor:"#16a34a",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"91",name:"Nolet's",price:200,categoryId:"cat-5",description:"Ginebra holandesa 50ml",backgroundColor:"#16a34a",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"92",name:"Botanist",price:160,categoryId:"cat-5",description:"Ginebra escocesa 50ml",backgroundColor:"#16a34a",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"93",name:"Martin Miller's",price:135,categoryId:"cat-5",description:"Ginebra premium 50ml",backgroundColor:"#16a34a",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"94",name:"Fords",price:110,categoryId:"cat-5",description:"Ginebra londinense 50ml",backgroundColor:"#16a34a",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"95",name:"Broker's",price:100,categoryId:"cat-5",description:"Ginebra londinense 50ml",backgroundColor:"#16a34a",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"96",name:"Hayman's",price:105,categoryId:"cat-5",description:"Ginebra familiar 50ml",backgroundColor:"#16a34a",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"97",name:"Boodles",price:115,categoryId:"cat-5",description:"Ginebra británica 50ml",backgroundColor:"#16a34a",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"98",name:"Plymouth Navy Strength",price:140,categoryId:"cat-5",description:"Ginebra de alta graduación 50ml",backgroundColor:"#16a34a",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"99",name:"Sloe Gin",price:95,categoryId:"cat-5",description:"Ginebra de endrinas 50ml",backgroundColor:"#ec4899",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"100",name:"Old Raj",price:150,categoryId:"cat-5",description:"Ginebra con azafrán 50ml",backgroundColor:"#ca8a04",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"101",name:"Drumshanbo",price:145,categoryId:"cat-5",description:"Ginebra irlandesa 50ml",backgroundColor:"#16a34a",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"102",name:"Bertha's Revenge",price:155,categoryId:"cat-5",description:"Ginebra irlandesa 50ml",backgroundColor:"#16a34a",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"103",name:"Dingle",price:165,categoryId:"cat-5",description:"Ginebra irlandesa 50ml",backgroundColor:"#16a34a",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"104",name:"Gunpowder",price:125,categoryId:"cat-5",description:"Ginebra irlandesa 50ml",backgroundColor:"#16a34a",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"105",name:"Shortcross",price:135,categoryId:"cat-5",description:"Ginebra irlandesa 50ml",backgroundColor:"#16a34a",isActive:!0,createdAt:new Date,updatedAt:new Date}])}if(t){const e=JSON.parse(t).map(e=>({...e,createdAt:new Date(e.createdAt),updatedAt:new Date(e.updatedAt)}));n(e)}else{n([{id:"cat-1",name:"Bebidas",color:"#3b82f6",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"cat-2",name:"Cervezas",color:"#f59e0b",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"cat-3",name:"Whisky",color:"#8b5cf6",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"cat-4",name:"Rones",color:"#ef4444",isActive:!0,createdAt:new Date,updatedAt:new Date},{id:"cat-5",name:"Ginebras",color:"#10b981",isActive:!0,createdAt:new Date,updatedAt:new Date}])}}catch(e){}},[]),a.useEffect(()=>{if(t.length>0)try{localStorage.setItem("kimipos_products",JSON.stringify(t))}catch(e){}},[t]),a.useEffect(()=>{if(r.length>0)try{localStorage.setItem("kimipos_categories",JSON.stringify(r))}catch(e){}},[r]);const i={products:t,categories:r,addProduct:e=>{const t={...e,id:`product-${Date.now()}`,createdAt:new Date,updatedAt:new Date};s(e=>[...e,t])},updateProduct:(e,t)=>{s(a=>a.map(a=>a.id===e?{...a,...t,updatedAt:new Date}:a))},deleteProduct:e=>{s(t=>t.filter(t=>t.id!==e))},getProductById:e=>t.find(t=>t.id===e),getProductsByCategory:e=>t.filter(t=>t.categoryId===e&&t.isActive),addCategory:e=>{const t={...e,id:`cat-${Date.now()}`,isActive:e.isActive??!0,createdAt:new Date,updatedAt:new Date};n(e=>[...e,t])},updateCategory:(e,t)=>{n(a=>a.map(a=>a.id===e?{...a,...t,updatedAt:new Date}:a))},deleteCategory:e=>{if(t.some(t=>t.categoryId===e))throw new Error("No se puede eliminar una categoría que tiene productos asignados");n(t=>t.filter(t=>t.id!==e))},getCategoryById:e=>r.find(t=>t.id===e)};return Ce.jsx(ma.Provider,{value:i,children:e})},xa=()=>{const e=a.useContext(ma);if(void 0===e)throw new Error("useProducts must be used within a ProductProvider");return e},ha=a.createContext(void 0),ga=()=>{const e=a.useContext(ha);if(void 0===e)throw new Error("useBalanceIncentives must be used within a BalanceIncentiveProvider");return e},pa=({children:e})=>{const[t,s]=a.useState(!1),r=he(async()=>{try{return(await Gt.balanceIncentives.toArray()).filter(e=>!0===e.isActive)}catch(e){return[]}},[])||[],n=he(async()=>{try{return await Gt.balanceIncentives.toArray()}catch(e){return[]}},[])||[];a.useEffect(()=>{(async()=>{try{if(await Gt.balanceIncentives.count(),0===await Gt.balanceIncentives.count()){const e=[{customerPayment:50,totalBalance:65,bonusAmount:15,isActive:!0,createdAt:new Date,updatedAt:new Date,syncStatus:"pending"},{customerPayment:100,totalBalance:140,bonusAmount:40,isActive:!0,createdAt:new Date,updatedAt:new Date,syncStatus:"pending"},{customerPayment:200,totalBalance:300,bonusAmount:100,isActive:!0,createdAt:new Date,updatedAt:new Date,syncStatus:"pending"}];for(const t of e)await Gt.balanceIncentives.add(t)}}catch(e){}})()},[]);const i={incentives:r,allIncentives:n,isLoading:t,addIncentive:async e=>{try{s(!0);const t=e.totalBalance-e.customerPayment,a={...e,bonusAmount:t,createdAt:new Date,updatedAt:new Date,syncStatus:"pending"};await Gt.balanceIncentives.add(a),P.success("Incentivo agregado exitosamente")}catch(t){P.error("Error al agregar el incentivo")}finally{s(!1)}},updateIncentive:async(e,t)=>{try{if(s(!0),void 0!==t.customerPayment||void 0!==t.totalBalance){const a=await Gt.balanceIncentives.get(e);if(a){const e=t.customerPayment??a.customerPayment,s=t.totalBalance??a.totalBalance;t.bonusAmount=s-e}}await Gt.balanceIncentives.update(e,{...t,updatedAt:new Date,syncStatus:"pending"}),P.success("Incentivo actualizado exitosamente")}catch(a){P.error("Error al actualizar el incentivo")}finally{s(!1)}},deleteIncentive:async e=>{try{s(!0),await Gt.balanceIncentives.delete(e),P.success("Incentivo eliminado exitosamente")}catch(t){P.error("Error al eliminar el incentivo")}finally{s(!1)}},getIncentiveForPayment:e=>r.find(t=>t.customerPayment===e)||null,refreshIncentives:()=>{}};return Ce.jsx(ha.Provider,{value:i,children:e})},ba=({isOpen:e,onClose:t,customer:s,onSave:r})=>{const[n,i]=a.useState({name:"",lastName:"",email:"",phone:"",address:"",cardCode:"",balance:0,notes:""}),[o,l]=a.useState({});a.useEffect(()=>{i(s||{name:"",lastName:"",email:"",phone:"",address:"",cardCode:"",balance:0,notes:""}),l({})},[s,e]);const c=(e,t)=>{i(a=>({...a,[e]:t})),o[e]&&l(t=>({...t,[e]:void 0}))};return e?Ce.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:Ce.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[Ce.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[Ce.jsxs("div",{className:"flex items-center space-x-3",children:[Ce.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:Ce.jsx(b,{className:"w-5 h-5 text-blue-600"})}),Ce.jsxs("div",{children:[Ce.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:s?"Editar Cliente":"Nuevo Cliente"}),Ce.jsx("p",{className:"text-sm text-gray-600",children:s?"Modifica la información del cliente":"Agrega un nuevo cliente al sistema"})]})]}),Ce.jsx("button",{onClick:t,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:Ce.jsx(S,{className:"w-5 h-5"})})]}),Ce.jsxs("form",{onSubmit:e=>{e.preventDefault(),(()=>{const e={};return n.name.trim()||(e.name="El nombre es obligatorio"),n.lastName.trim()||(e.lastName="El apellido es obligatorio"),n.email&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(n.email)&&(e.email="Email inválido"),n.phone&&!/^[\+]?[0-9\s\-\(\)]{9,}$/.test(n.phone)&&(e.phone="Teléfono inválido"),l(e),0===Object.keys(e).length})()&&(r({...n,id:null==s?void 0:s.id}),t())},className:"p-6 space-y-6",children:[Ce.jsxs("div",{children:[Ce.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Información Personal"}),Ce.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[Ce.jsxs("div",{children:[Ce.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nombre *"}),Ce.jsxs("div",{className:"relative",children:[Ce.jsx(b,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),Ce.jsx("input",{type:"text",value:n.name,onChange:e=>c("name",e.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent "+(o.name?"border-red-300":"border-gray-300"),placeholder:"Nombre del cliente"})]}),o.name&&Ce.jsx("p",{className:"text-red-500 text-sm mt-1",children:o.name})]}),Ce.jsxs("div",{children:[Ce.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Apellido *"}),Ce.jsx("input",{type:"text",value:n.lastName,onChange:e=>c("lastName",e.target.value),className:"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent "+(o.lastName?"border-red-300":"border-gray-300"),placeholder:"Apellido del cliente"}),o.lastName&&Ce.jsx("p",{className:"text-red-500 text-sm mt-1",children:o.lastName})]})]})]}),Ce.jsxs("div",{children:[Ce.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Información de Contacto"}),Ce.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[Ce.jsxs("div",{children:[Ce.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),Ce.jsxs("div",{className:"relative",children:[Ce.jsx(M,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),Ce.jsx("input",{type:"email",value:n.email,onChange:e=>c("email",e.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent "+(o.email?"border-red-300":"border-gray-300"),placeholder:"email@ejemplo.com"})]}),o.email&&Ce.jsx("p",{className:"text-red-500 text-sm mt-1",children:o.email})]}),Ce.jsxs("div",{children:[Ce.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Teléfono"}),Ce.jsxs("div",{className:"relative",children:[Ce.jsx(E,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),Ce.jsx("input",{type:"tel",value:n.phone,onChange:e=>c("phone",e.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent "+(o.phone?"border-red-300":"border-gray-300"),placeholder:"+34 600 000 000"})]}),o.phone&&Ce.jsx("p",{className:"text-red-500 text-sm mt-1",children:o.phone})]})]}),Ce.jsxs("div",{className:"mt-4",children:[Ce.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Dirección"}),Ce.jsxs("div",{className:"relative",children:[Ce.jsx(O,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),Ce.jsx("input",{type:"text",value:n.address,onChange:e=>c("address",e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Dirección completa"})]})]})]}),Ce.jsxs("div",{children:[Ce.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Información de Tarjeta y Saldo"}),Ce.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[Ce.jsxs("div",{children:[Ce.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Código de Tarjeta"}),Ce.jsxs("div",{className:"relative",children:[Ce.jsx($,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),Ce.jsx("input",{type:"text",value:n.cardCode,onChange:e=>c("cardCode",e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Código de tarjeta o barras"})]}),Ce.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Para identificación por NFC o código de barras"})]}),Ce.jsxs("div",{children:[Ce.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Saldo (€)"}),Ce.jsxs("div",{className:"relative",children:[Ce.jsx(z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),Ce.jsx("input",{type:"number",step:"0.01",min:"0",value:n.balance,onChange:e=>c("balance",parseFloat(e.target.value)||0),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"0.00"})]}),Ce.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Saldo positivo a favor del cliente"})]})]})]}),Ce.jsxs("div",{children:[Ce.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notas"}),Ce.jsxs("div",{className:"relative",children:[Ce.jsx(L,{className:"absolute left-3 top-3 text-gray-400 w-4 h-4"}),Ce.jsx("textarea",{value:n.notes,onChange:e=>c("notes",e.target.value),rows:3,className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Información adicional sobre el cliente..."})]})]}),Ce.jsxs("div",{className:"flex items-center justify-end space-x-3 pt-6 border-t border-gray-200",children:[Ce.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:"Cancelar"}),Ce.jsxs("button",{type:"submit",className:"px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors flex items-center space-x-2",children:[Ce.jsx(X,{className:"w-4 h-4"}),Ce.jsx("span",{children:s?"Guardar Cambios":"Crear Cliente"})]})]})]})]})}):null},fa=({isOpen:e,onClose:t,customer:s,incentives:r,onRecharge:n,onOpenPaymentModal:i})=>{const{getCurrencySymbol:o}=Qt(),l=o(),[c,d]=a.useState("");return e?Ce.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:Ce.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[Ce.jsx("div",{className:"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75",onClick:t}),Ce.jsxs("div",{className:"inline-block w-full max-w-md my-8 overflow-hidden text-left align-middle transition-all transform bg-white shadow-xl rounded-lg",children:[Ce.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 bg-gradient-to-r from-green-50 to-emerald-50",children:[Ce.jsxs("div",{className:"flex items-center space-x-3",children:[Ce.jsx(z,{className:"w-6 h-6 text-green-600"}),Ce.jsxs("div",{children:[Ce.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Recargar Saldo"}),Ce.jsxs("p",{className:"text-sm text-gray-600",children:[s.name," ",s.lastName]})]})]}),Ce.jsx("button",{onClick:t,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:Ce.jsx(S,{className:"w-5 h-5"})})]}),Ce.jsxs("div",{className:"p-6",children:[Ce.jsx("div",{className:"mb-6 p-4 bg-blue-50 rounded-lg border border-blue-200",children:Ce.jsxs("div",{className:"flex justify-between items-center",children:[Ce.jsx("span",{className:"text-sm font-medium text-blue-800",children:"Saldo actual:"}),Ce.jsxs("span",{className:"text-lg font-bold text-blue-900",children:[l,s.balance.toFixed(2)]})]})}),r.length>0&&Ce.jsxs("div",{className:"mb-6",children:[Ce.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[Ce.jsx(C,{className:"w-5 h-5 text-green-600 mr-2"}),"Incentivos Disponibles"]}),Ce.jsx("div",{className:"space-y-3",children:r.map(e=>Ce.jsx("button",{onClick:()=>(e=>{i(e.customerPayment,e.bonusAmount),t()})(e),className:"w-full p-4 border border-green-200 rounded-lg hover:border-green-300 hover:bg-green-50 transition-all duration-200 text-left group",children:Ce.jsxs("div",{className:"flex justify-between items-center",children:[Ce.jsxs("div",{children:[Ce.jsxs("div",{className:"font-semibold text-gray-900",children:["Paga ",l,e.customerPayment.toFixed(2)]}),Ce.jsxs("div",{className:"text-sm text-gray-600",children:["Recibe ",l,e.totalBalance.toFixed(2)]})]}),Ce.jsxs("div",{className:"text-right",children:[Ce.jsxs("div",{className:"text-green-600 font-bold",children:["+",l,e.bonusAmount.toFixed(2)]}),Ce.jsx("div",{className:"text-xs text-green-600",children:"Regalo"})]})]})},e.id))})]}),Ce.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[Ce.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[Ce.jsx(F,{className:"w-5 h-5 text-blue-600 mr-2"}),"Recarga Personalizada"]}),Ce.jsxs("div",{className:"flex space-x-3",children:[Ce.jsx("div",{className:"flex-1",children:Ce.jsx("input",{type:"number",step:"0.01",min:"0",value:c,onChange:e=>d(e.target.value),placeholder:"0.00",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors"})}),Ce.jsx("button",{onClick:()=>{const e=parseFloat(c);e>0&&(i(e,0),t())},disabled:!c||parseFloat(c)<=0,className:"px-6 py-3 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed text-white rounded-lg font-medium transition-colors",children:"Recargar"})]})]})]})]})]})}):null},ya=({isOpen:e,onClose:t,customer:s,tables:r,onTransfer:n})=>{const[i,o]=a.useState(null);if(!e)return null;const l=r.filter(e=>"occupied"===e.status&&"virtual"!==e.id);return Ce.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:Ce.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[Ce.jsx("div",{className:"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75",onClick:t}),Ce.jsxs("div",{className:"inline-block w-full max-w-md my-8 overflow-hidden text-left align-middle transition-all transform bg-white shadow-xl rounded-lg",children:[Ce.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 bg-gradient-to-r from-blue-50 to-indigo-50",children:[Ce.jsxs("div",{className:"flex items-center space-x-3",children:[Ce.jsx(B,{className:"w-6 h-6 text-blue-600"}),Ce.jsxs("div",{children:[Ce.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Trasladar Cuenta"}),Ce.jsxs("p",{className:"text-sm text-gray-600",children:[s.name," ",s.lastName]})]})]}),Ce.jsx("button",{onClick:t,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:Ce.jsx(S,{className:"w-5 h-5"})})]}),Ce.jsxs("div",{className:"p-6",children:[Ce.jsx("div",{className:"mb-6 p-4 bg-blue-50 rounded-lg border border-blue-200",children:Ce.jsxs("div",{className:"flex items-center space-x-3",children:[Ce.jsx(b,{className:"w-5 h-5 text-blue-600"}),Ce.jsxs("div",{children:[Ce.jsx("p",{className:"font-medium text-blue-900",children:"Cliente seleccionado:"}),Ce.jsxs("p",{className:"text-sm text-blue-700",children:[s.name," ",s.lastName]}),s.balance>0&&Ce.jsxs("p",{className:"text-sm text-green-600 font-medium",children:["Saldo disponible: €",s.balance.toFixed(2)]})]})]})}),Ce.jsxs("div",{className:"mb-6",children:[Ce.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[Ce.jsx(O,{className:"w-5 h-5 text-gray-600 mr-2"}),"Seleccionar Mesa para Trasladar"]}),0===l.length?Ce.jsxs("div",{className:"text-center py-8 text-gray-500",children:[Ce.jsx(O,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),Ce.jsx("p",{children:"No hay mesas ocupadas"}),Ce.jsx("p",{className:"text-sm",children:"Todas las mesas están libres"})]}):Ce.jsx("div",{className:"space-y-3 max-h-64 overflow-y-auto",children:l.map(e=>Ce.jsx("button",{onClick:()=>o(e),className:"w-full p-4 border rounded-lg text-left transition-all duration-200 "+((null==i?void 0:i.id)===e.id?"border-blue-500 bg-blue-50 shadow-md":"border-gray-200 hover:border-blue-300 hover:bg-blue-50"),children:Ce.jsxs("div",{className:"flex justify-between items-center",children:[Ce.jsxs("div",{children:[Ce.jsxs("div",{className:"font-semibold text-gray-900",children:["Mesa ",e.number]}),e.name&&Ce.jsx("div",{className:"text-sm text-gray-600",children:e.name}),e.temporaryName&&Ce.jsx("div",{className:"text-sm text-blue-600",children:e.temporaryName})]}),Ce.jsx("div",{className:"text-right",children:Ce.jsx("div",{className:"w-3 h-3 rounded-full bg-red-500"})})]})},e.id))})]}),Ce.jsx("div",{className:"mb-6 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:Ce.jsxs("div",{className:"flex items-start space-x-3",children:[Ce.jsx(G,{className:"w-5 h-5 text-yellow-600 mt-0.5"}),Ce.jsxs("div",{children:[Ce.jsx("p",{className:"text-sm font-medium text-yellow-800",children:"Importante:"}),Ce.jsx("p",{className:"text-sm text-yellow-700",children:"Al trasladar la cuenta, la mesa quedará libre y todos los productos se moverán a la cuenta por nombre del cliente."})]})]})}),Ce.jsxs("div",{className:"flex space-x-3",children:[Ce.jsx("button",{onClick:t,className:"flex-1 px-4 py-3 border border-gray-300 rounded-xl text-gray-700 hover:bg-gray-50 transition-colors",children:"Cancelar"}),Ce.jsx("button",{onClick:()=>{i?(n(i,s),t()):P.error("Por favor selecciona una mesa para trasladar")},disabled:!i,className:"flex-1 px-4 py-3 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 disabled:from-gray-300 disabled:to-gray-400 disabled:cursor-not-allowed text-white rounded-xl font-medium transition-all duration-200",children:"Trasladar Cuenta"})]})]})]})]})})},va=()=>{var e,t;const[s,n]=a.useState(null),[i,o]=a.useState(""),[l,c]=a.useState([]),[d,m]=a.useState(null),[u,x]=a.useState(null),[h,g]=a.useState(!1),[p,f]=a.useState(!1),[y,v]=a.useState(!1),[j,w]=a.useState(!1),[C,k]=a.useState(!1),[D,I]=a.useState(null),[M,E]=a.useState(!1),[R,W]=a.useState(null),[L,q]=a.useState(!1),[G,U]=a.useState(null),[X,J]=a.useState(null),[V,Q]=a.useState(null),[K,Z]=a.useState(!1),[ee,te]=a.useState(!1),[ae,se]=a.useState(null),[re,ne]=a.useState(!1),[ie,oe]=a.useState(null),[le,ce]=a.useState(!1),[de,me]=a.useState(!1),[ue,xe]=a.useState(null),[he,ge]=a.useState(null),[pe,be]=a.useState(null),{addOrderToTable:fe,getTableOrderItems:ye,clearTableOrder:ve,tables:je,removeNamedAccount:Ne,addNamedAccount:we,updateTableStatus:ke,salons:Ae,addPartialPayment:Se,getPartialPayments:De,getTotalPartialPayments:Pe,clearPartialPayments:Ie,updateTableTotalAfterPartialPayment:Te}=Wt(),{getCurrencySymbol:Me,getTaxRate:Ee,getModifiersForCategory:$e,config:Fe}=Qt(),{products:Oe,categories:ze}=xa(),{customers:Re,updateCustomer:We,getCustomerByCardCode:Le}=Yt(),{incentives:qe}=ga(),Be=Oe.filter(e=>e.isActive),Ge=ze.filter(e=>e.isActive),Ue=Be.filter(e=>{const t=!s||e.categoryId===s,a=!i||e.name.toLowerCase().includes(i.toLowerCase());return t&&a}),Ye=(e,t)=>{var a;if(l.find(a=>a.productId===e.id||a.productName===e.name||a.productName===`${e.name}${t?` - ${t.name}`:""}`))c(l.map(a=>a.productId===e.id||a.productName===e.name||a.productName===`${e.name}${t?` - ${t.name}`:""}`?{...a,quantity:a.quantity+1,totalPrice:(a.quantity+1)*a.unitPrice}:a));else{const s=t||(null==(a=e.tariffs)?void 0:a.find(e=>e.isDefault))||{price:e.price},r={productId:e.id,productName:`${e.name}${t?` - ${t.name}`:""}`,quantity:1,unitPrice:s.price,totalPrice:s.price,status:"pending",modifiers:[]};c([...l,r])}};r.useEffect(()=>{(async()=>{const e=localStorage.getItem("orderToEdit");if(e)try{const t=await Gt.orders.get(Number(e));if(t){const e=t.items.map((e,t)=>({productId:String(e.productId??`edit-${t}`),productName:e.productName||`Producto ${t+1}`,quantity:e.quantity||1,unitPrice:e.unitPrice||0,totalPrice:e.totalPrice||0,status:"pending",modifiers:[]}));c(e),xe(t.id||null),ge(t.total||0),P.success(`Editando ticket #${t.id}`),g(!1)}}catch(t){g(!0)}else g(!0)})()},[]);const He=()=>{xe(null),ge(null),be(null),c([]),x(null),f(!1),localStorage.removeItem("orderToEdit"),g(!0),P.success("Dashboard limpiado, selecciona una nueva mesa")},Xe=(e,t)=>{c(l.map(a=>{if(a.productId===e){const e=Math.max(0,a.quantity+t);return 0===e?null:{...a,quantity:e,totalPrice:e*a.unitPrice}}return a}).filter(Boolean))},_e=()=>{const e=l.reduce((e,t)=>e+Kt(t.unitPrice)*t.quantity,0);const t=ea(l),a=(e=>e.reduce((e,t)=>e+t.unitPrice*t.quantity,0))(l);if(u){const s=Pe(u.id);return{subtotal:e,tax:t,total:Math.max(0,a-s)}}return{subtotal:e,tax:t,total:a}},{subtotal:Je,tax:Ve,total:Qe}=_e();return Ce.jsxs("div",{className:"h-full flex bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100",children:[Ce.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[Ce.jsx("div",{className:"bg-white/80 backdrop-blur-sm border-b border-gray-200/50 p-4 shadow-sm",children:Ce.jsxs("div",{className:"flex items-center space-x-4",children:[Ce.jsxs("div",{className:"flex-1 relative",children:[Ce.jsx(T,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),Ce.jsx("input",{type:"text",placeholder:"Buscar productos...",value:i,onChange:e=>o(e.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white shadow-sm transition-all duration-200 hover:shadow-md"})]}),d&&Ce.jsxs("div",{className:"flex items-center space-x-2 bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 px-4 py-2 rounded-xl shadow-sm",children:[Ce.jsx(b,{className:"w-4 h-4 text-blue-600"}),Ce.jsxs("span",{className:"text-sm font-medium text-blue-700",children:[d.name," ",d.lastName]})]})]})}),Ce.jsx("div",{className:"bg-white/70 backdrop-blur-sm border-b border-gray-200/50 p-4 shadow-sm",children:Ce.jsxs("div",{className:"flex space-x-2 overflow-x-auto pb-2",children:[Ce.jsx("button",{onClick:()=>n(null),className:"px-6 py-4 rounded-xl font-medium whitespace-nowrap transition-all duration-200 shadow-sm min-h-[56px] flex items-center justify-center text-base "+(null===s?"bg-gradient-to-r from-blue-600 to-indigo-600 text-white shadow-lg transform scale-105":"bg-white text-gray-700 hover:bg-gray-50 hover:shadow-md border border-gray-200"),children:"Todas"}),Ge.map(e=>Ce.jsx("button",{onClick:()=>n(e.id),style:{backgroundColor:s===e.id?e.color:void 0,color:s===e.id?"white":void 0,borderColor:s===e.id?e.color:void 0},className:"px-6 py-4 rounded-xl font-medium whitespace-nowrap transition-all duration-200 shadow-sm min-h-[56px] flex items-center justify-center text-base "+(s===e.id?"text-white shadow-lg transform scale-105 border-2":"bg-white text-gray-700 hover:bg-gray-50 hover:shadow-md border border-gray-200 hover:border-gray-300"),children:e.name},e.id))]})}),Ce.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[!u&&!p&&Ce.jsx("div",{className:"mb-6 p-4 bg-yellow-50 border border-yellow-200 rounded-xl text-center",children:Ce.jsxs("div",{className:"flex items-center justify-center space-x-2 text-yellow-700",children:[Ce.jsx(O,{className:"w-5 h-5"}),Ce.jsx("span",{className:"font-medium",children:"Selecciona una mesa para comenzar a agregar productos"})]})}),p&&Ce.jsx("div",{className:"mb-6 p-4 bg-blue-50 border border-blue-200 rounded-xl text-center",children:Ce.jsxs("div",{className:"flex items-center justify-center space-x-2 text-blue-700",children:[Ce.jsx(A,{className:"w-5 h-5"}),Ce.jsx("span",{className:"font-medium",children:"Modo ticket sin mesa - Agrega productos para cobrar directamente"})]})}),Ce.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-6",children:Ue.map(e=>Ce.jsx("div",{onClick:()=>(e=>{if(!u&&!p)return P.error("Debes seleccionar una mesa antes de agregar productos"),void g(!0);e.combinations&&e.combinations.some(e=>e.isActive)?(U(e),q(!0)):e.tariffs&&e.tariffs.length>1?(W(e),E(!0)):Ye(e)})(e),className:"product-card cursor-pointer p-6 rounded-2xl shadow-md border border-gray-200/50 transition-all duration-300 hover:shadow-xl hover:scale-105 backdrop-blur-sm min-h-[120px] flex flex-col justify-center",style:{background:e.backgroundColor?`linear-gradient(135deg, ${e.backgroundColor}15, ${e.backgroundColor}25, ${e.backgroundColor}15)`:"linear-gradient(135deg, #ffffff, #f8fafc, #ffffff)",borderColor:e.backgroundColor?`${e.backgroundColor}40`:"#e5e7eb"},onMouseEnter:t=>{e.backgroundColor&&(t.currentTarget.style.background=`linear-gradient(135deg, ${e.backgroundColor}25, ${e.backgroundColor}35, ${e.backgroundColor}25)`,t.currentTarget.style.borderColor=`${e.backgroundColor}60`)},onMouseLeave:t=>{e.backgroundColor&&(t.currentTarget.style.background=`linear-gradient(135deg, ${e.backgroundColor}15, ${e.backgroundColor}25, ${e.backgroundColor}15)`,t.currentTarget.style.borderColor=`${e.backgroundColor}40`)},children:Ce.jsxs("div",{className:"text-center",children:[Ce.jsx("h3",{className:"font-semibold text-gray-900 text-lg mb-3 line-clamp-2 leading-tight",children:e.name}),Ce.jsxs("p",{className:"text-xl font-bold",style:{color:e.backgroundColor||"#3b82f6"},children:[Me(),e.price.toFixed(2)]})]})},e.id))})]})]}),Ce.jsxs("div",{className:"w-[32rem] bg-white/90 backdrop-blur-sm border-l border-gray-200/50 flex flex-col shadow-xl",children:[Ce.jsx("div",{className:"p-6 border-b border-gray-200/50 bg-gradient-to-r from-blue-50 to-indigo-50",children:Ce.jsxs("div",{className:"space-y-2",children:[Ce.jsx("div",{className:"relative",children:Ce.jsx("input",{type:"text",placeholder:"🔍 Escanear código de tarjeta...",className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm bg-white shadow-sm transition-all duration-200 hover:shadow-md",onKeyPress:e=>{if("Enter"===e.key){const t=e.currentTarget.value.trim();if(t){const a=Le(t);a?(m(a),P.success(`Cliente ${a.name} ${a.lastName} seleccionado por código de tarjeta`),e.currentTarget.value=""):(P.error("No se encontró un cliente con ese código de tarjeta"),e.currentTarget.value="")}}}})}),Ce.jsx(Xt,{selectedCustomer:d,onCustomerSelect:m,placeholder:"Seleccionar cliente (opcional)"}),d&&Ce.jsxs("div",{className:"space-y-2",children:[Ce.jsxs("div",{className:"flex space-x-2",children:[Ce.jsxs("button",{onClick:()=>{d&&ce(!0)},className:"flex-1 bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 text-white py-3 px-4 rounded-xl font-medium flex items-center justify-center space-x-2 transition-all duration-200 hover:shadow-lg hover:scale-105 text-sm",children:[Ce.jsx(z,{className:"w-4 h-4"}),Ce.jsx("span",{children:"Recargar Saldo"})]}),Ce.jsx("button",{onClick:()=>m(null),className:"px-4 py-3 border border-gray-300 rounded-xl hover:bg-gray-50 transition-all duration-200 text-gray-500 hover:text-red-500 hover:border-red-300 shadow-sm hover:shadow-md min-w-[48px] min-h-[48px] flex items-center justify-center text-lg font-bold",title:"Quitar cliente",children:"✕"})]}),Ce.jsxs("button",{onClick:()=>{d&&me(!0)},className:"w-full bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700 text-white py-3 px-4 rounded-xl font-medium flex items-center justify-center space-x-2 transition-all duration-200 hover:shadow-lg hover:scale-105 text-sm",children:[Ce.jsx(B,{className:"w-4 h-4"}),Ce.jsx("span",{children:"Trasladar Cuenta a Cliente"})]})]}),Ce.jsxs("div",{className:"flex space-x-2",children:[Ce.jsxs("button",{onClick:()=>g(!0),className:"flex-1 px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm text-left flex items-center justify-between hover:bg-gray-50 transition-all duration-200 hover:shadow-md bg-white shadow-sm",children:[Ce.jsxs("div",{className:"flex items-center space-x-2",children:[Ce.jsx(O,{className:"w-4 h-4 text-blue-500"}),Ce.jsxs("div",{className:"flex flex-col",children:[Ce.jsx("span",{className:u?"text-gray-900":"text-gray-500",children:u?`Mesa ${u.number}${u.name?` - ${u.name}`:""}`:"Seleccionar mesa"}),u&&Pe(u.id)>0&&Ce.jsxs("span",{className:"text-xs text-yellow-600 font-medium",children:["⚠️ Cobros parciales: ",Me(),Zt(Pe(u.id))]})]})]}),u&&Ce.jsx("div",{className:"w-3 h-3 rounded-full "+("available"===u.status?"bg-green-500":"occupied"===u.status?"bg-red-500":"reserved"===u.status?"bg-yellow-500":"bg-blue-500")})]}),u&&Ce.jsx("button",{onClick:()=>{x(null),c([]),m(null),g(!0)},className:"px-4 py-3 border border-gray-300 rounded-xl hover:bg-gray-50 transition-all duration-200 text-gray-500 hover:text-red-500 hover:border-red-300 shadow-sm hover:shadow-md min-w-[48px] min-h-[48px] flex items-center justify-center text-lg font-bold",title:"Cambiar mesa",children:"✕"})]})]})}),Ce.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:0===l.length?Ce.jsxs("div",{className:"text-center text-gray-500 mt-8",children:[Ce.jsx(N,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),Ce.jsx("p",{children:"No hay productos en el pedido"}),Ce.jsx("p",{className:"text-sm",children:"Selecciona productos para agregar"})]}):Ce.jsx("div",{className:"space-y-2",children:l.map(e=>{var t,a;return Ce.jsxs("div",{className:"bg-gradient-to-r from-white to-gray-50 rounded-lg p-3 border border-gray-200/50 shadow-sm hover:shadow-md transition-all duration-200",children:[Ce.jsxs("div",{className:"flex items-center gap-4",children:[Ce.jsx("button",{onClick:()=>{return t=e.productId,void c(l.filter(e=>e.productId!==t));var t},className:"p-2 text-red-600 hover:bg-red-100 rounded-lg transition-all duration-200 hover:scale-110 flex-shrink-0",children:Ce.jsx(H,{className:"w-4 h-4"})}),Ce.jsx("div",{className:"flex-1 min-w-0",children:Ce.jsx("h4",{className:"font-semibold text-gray-900 text-lg leading-tight",children:e.productName})}),Ce.jsx("div",{className:"flex-shrink-0",children:Ce.jsxs("button",{onClick:()=>{return t=e.productId,I(t),void k(!0);var t},className:"text-base font-semibold hover:underline cursor-pointer flex items-center "+(e.unitPrice!==(null==(t=Oe.find(t=>t.id===e.productId))?void 0:t.price)?"text-blue-600":"text-gray-700"),title:"Haz clic para editar el precio (IVA incluido)",children:[Me(),Zt(e.unitPrice)," c/u",Ce.jsx(z,{className:"w-4 h-4 ml-1 opacity-50"})]})}),Ce.jsxs("div",{className:"flex-shrink-0",children:[Ce.jsx("button",{onClick:()=>{return t=e.productId,Q(t),void Z(!0);var t},className:"text-xs text-gray-500 hover:text-blue-600 px-2 py-1 rounded hover:bg-blue-50",title:"Añadir modificadores",children:"Mods"}),e.unitPrice!==(null==(a=Oe.find(t=>t.id===e.productId))?void 0:a.price)&&Ce.jsx("button",{onClick:()=>(e=>{const t=Oe.find(t=>t.id===e);t&&c(l.map(a=>a.productId===e?{...a,unitPrice:t.price,totalPrice:a.quantity*t.price}:a))})(e.productId),className:"text-xs text-gray-400 hover:text-blue-600 p-1 rounded hover:bg-blue-50 ml-1",title:"Restaurar precio original",children:"↺"})]}),Ce.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[Ce.jsx("button",{onClick:()=>Xe(e.productId,-1),className:"p-1 rounded bg-gray-200 hover:bg-blue-500 hover:text-white transition-all duration-200 hover:scale-110 min-w-[24px] min-h-[24px] flex items-center justify-center",children:Ce.jsx(Y,{className:"w-3 h-3"})}),Ce.jsx("span",{className:"w-6 text-center font-semibold text-gray-800 text-sm",children:e.quantity}),Ce.jsx("button",{onClick:()=>Xe(e.productId,1),className:"p-1 rounded bg-gray-200 hover:bg-blue-500 hover:text-white transition-all duration-200 hover:scale-110 min-w-[24px] min-h-[24px] flex items-center justify-center",children:Ce.jsx(F,{className:"w-3 h-3"})})]})]}),e.modifiers&&e.modifiers.length>0&&Ce.jsx("div",{className:"mt-2 flex flex-wrap gap-1",children:e.modifiers.map((e,t)=>Ce.jsx("span",{className:"text-[10px] px-2 py-0.5 bg-gray-100 text-gray-600 rounded",children:e},t))})]},e.productId)})})}),(l.length>0||ue)&&Ce.jsxs("div",{className:"border-t border-gray-200/50 p-6 space-y-4 bg-gradient-to-r from-blue-50/50 to-indigo-50/50",children:[l.length>0?Ce.jsxs("div",{className:"space-y-2",children:[Ce.jsxs("div",{className:"flex justify-between text-sm",children:[Ce.jsx("span",{children:"Subtotal (sin IVA):"}),Ce.jsxs("span",{children:[Me(),Zt(Je)]})]}),Ce.jsxs("div",{className:"flex justify-between text-sm",children:[Ce.jsx("span",{children:"IVA (21%):"}),Ce.jsxs("span",{children:[Me(),Zt(Ve)]})]}),u&&Pe(u.id)>0&&Ce.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3 space-y-2",children:[Ce.jsxs("div",{className:"flex justify-between text-sm text-yellow-800",children:[Ce.jsx("span",{className:"font-medium",children:"Total original:"}),Ce.jsxs("span",{children:[Me(),Zt(Qe+Pe(u.id))]})]}),Ce.jsxs("div",{className:"flex justify-between text-sm text-yellow-700",children:[Ce.jsx("span",{children:"Ya cobrado:"}),Ce.jsxs("span",{className:"font-medium",children:[Me(),Zt(Pe(u.id))]})]}),Ce.jsxs("div",{className:"flex justify-between text-sm text-yellow-800 font-semibold border-t border-yellow-300 pt-1",children:[Ce.jsx("span",{children:"Pendiente por cobrar:"}),Ce.jsxs("span",{children:[Me(),Zt(Qe)]})]})]}),Ce.jsxs("div",{className:"flex justify-between text-xl font-bold border-t pt-3 border-gray-300",children:[Ce.jsx("span",{className:"text-gray-800",children:"Total (IVA incl.):"}),Ce.jsxs("span",{className:"bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent",children:[Me(),Zt(Qe)]})]})]}):ue&&Ce.jsxs("div",{className:"text-center text-gray-600 py-4",children:[Ce.jsx("p",{className:"text-sm font-medium",children:"Ticket vacío"}),Ce.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Puedes guardar el ticket sin productos o cancelar la edición"})]}),Ce.jsxs("div",{className:"space-y-2",children:[ue?Ce.jsxs("div",{className:"space-y-2",children:[Ce.jsxs("button",{onClick:async()=>{if(!ue)return;const{subtotal:e,tax:t,total:a}=_e();if(null!==he){const s=parseFloat((a-he).toFixed(2));if(Math.abs(s)>.001)return be({amount:Math.abs(s),isIncrease:s>0,newTotal:a,newSubtotal:e,newTax:t}),void v(!0)}try{await Gt.orders.update(ue,{items:l.map(e=>({productId:e.productId,productName:e.productName,quantity:e.quantity,unitPrice:e.unitPrice,totalPrice:e.totalPrice,modifiers:e.modifiers||[]})),subtotal:e,tax:t,total:a,updatedAt:new Date}),P.success("Ticket actualizado sin cambios en el total"),He()}catch(s){P.error("No se pudo guardar el ticket")}},className:"w-full bg-gradient-to-r from-amber-500 to-orange-600 hover:from-amber-600 hover:to-orange-700 text-white py-4 px-6 rounded-xl font-semibold flex items-center justify-center space-x-2 shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-105",children:[Ce.jsx(A,{className:"w-5 h-5"}),Ce.jsx("span",{children:"Guardar Cambios"})]}),Ce.jsxs("button",{onClick:He,className:"w-full bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 text-white py-3 px-6 rounded-xl font-medium flex items-center justify-center space-x-2 shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-105",children:[Ce.jsx(S,{className:"w-4 h-4"}),Ce.jsx("span",{children:"Cancelar Edición"})]})]}):Ce.jsx("div",{className:"grid grid-cols-2 gap-3",children:Ce.jsxs("button",{onClick:async()=>{if(0===l.length)return void P.error("El pedido está vacío");if(!u)return void P.error("Debes seleccionar una mesa antes de procesar el pedido");const{total:e,subtotal:t,tax:a}=_e(),s=localStorage.getItem("orderToEdit");if(s){const r=await Gt.orders.get(Number(s));r&&(await Gt.orders.update(r.id,{items:l.map(e=>({productId:0,productName:e.productName,quantity:e.quantity,unitPrice:e.unitPrice,totalPrice:e.totalPrice,status:"delivered"})),subtotal:t,tax:a,total:e,updatedAt:new Date}),localStorage.removeItem("orderToEdit"))}fe(u.id,e,l,d,!0),u.id.startsWith("account-")?P.success(`Pedido procesado exitosamente para ${u.name}`):P.success(`Pedido procesado exitosamente para Mesa ${u.number}`),c([]),m(null),x(null),g(!0)},className:"bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white py-3 px-4 rounded-xl font-semibold flex items-center justify-center space-x-2 shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-105 text-sm",children:[Ce.jsx(A,{className:"w-4 h-4"}),Ce.jsx("span",{children:"Procesar"})]})}),Ce.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[Ce.jsxs("button",{className:"bg-gray-100 hover:bg-gray-200 text-gray-700 py-3 px-2 rounded-xl font-medium flex items-center justify-center space-x-1 transition-all duration-200 hover:shadow-md text-sm",children:[Ce.jsx(_,{className:"w-4 h-4"}),Ce.jsx("span",{children:"Dividir"})]}),Ce.jsxs("button",{className:"bg-gray-100 hover:bg-gray-200 text-gray-700 py-3 px-2 rounded-xl font-medium flex items-center justify-center space-x-1 transition-all duration-200 hover:shadow-md text-sm",children:[Ce.jsx($,{className:"w-4 h-4"}),Ce.jsx("span",{children:"Tarjeta"})]}),Ce.jsxs("button",{onClick:()=>w(!0),className:"bg-blue-100 hover:bg-blue-200 text-blue-700 py-3 px-2 rounded-xl font-medium flex items-center justify-center space-x-1 transition-all duration-200 hover:shadow-md text-sm",children:[Ce.jsx(B,{className:"w-4 h-4"}),Ce.jsx("span",{children:"Unir"})]})]}),u&&"occupied"===u.status||p?Ce.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[Ce.jsxs("button",{onClick:()=>v(!0),className:"bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 text-white py-3 px-4 rounded-xl font-bold flex items-center justify-center space-x-2 shadow-xl hover:shadow-2xl transition-all duration-300 hover:scale-105 text-base border-2 border-green-400 ring-2 ring-green-200 animate-pulse",children:[Ce.jsx(z,{className:"w-5 h-5"}),Ce.jsx("span",{children:"Cobrar"})]}),u&&Ce.jsxs("button",{onClick:()=>{if(!u)return void P.error("Debes seleccionar una mesa primero");if("occupied"!==u.status)return void P.error("La mesa no tiene pedidos activos");const e=u.id.startsWith("account-");((e,t,a,s="danger")=>{se({title:e,message:t,onConfirm:a,type:s}),te(!0)})(e?"Eliminar Cuenta":"Vaciar Ticket Mesa",e?`¿Estás seguro de que quieres eliminar la cuenta de "${u.name}"?`:`¿Estás seguro de que quieres vaciar completamente el ticket de la Mesa ${u.number}?`,()=>{e?(Ne(u.id),P.success(`Cuenta de ${u.name} eliminada exitosamente`),c([]),m(null),x(null),setTimeout(()=>{g(!0)},100)):(ve(u.id),x({...u,status:"available",occupiedSince:void 0,currentOrder:void 0}),P.success(`Mesa ${u.number} vaciada y liberada exitosamente`),c([]),m(null))},"danger")},className:"bg-gradient-to-r from-red-600 to-rose-600 hover:from-red-700 hover:to-rose-700 text-white py-3 px-4 rounded-xl font-semibold flex items-center justify-center space-x-2 shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-105 text-sm",children:[Ce.jsx(H,{className:"w-4 h-4"}),Ce.jsx("span",{children:"Vaciar"})]})]}):null]})]})]}),Ce.jsx(_t,{isOpen:h,onClose:()=>g(!1),onSelectTable:e=>{const t=d?{...e,assignedCustomer:{id:d.id,name:d.name,lastName:d.lastName,email:d.email,phone:d.phone},temporaryName:void 0}:e;if(x(t),f(!1),e.assignedCustomer&&!d){const t=Re.find(t=>t.id===e.assignedCustomer.id);t&&(m(t),P.success(`Cliente ${t.name} ${t.lastName} cargado de la mesa ${e.number}`))}if(d&&P.success(`Cliente ${d.name} ${d.lastName} asignado a la mesa ${e.number}`),"occupied"===e.status){const t=ye(e.id);if(t.length>0){c(t);const a=Pe(e.id),s=t.reduce((e,t)=>e+t.totalPrice,0)-a,r=e.id.startsWith("account-")?`Cargados ${t.length} productos de la cuenta de ${e.name}`:`Cargados ${t.length} productos de la mesa ${e.number}`;a>0?P.success(`${r}. Total pendiente: ${Me()}${s.toFixed(2)} (ya cobrado: ${Me()}${a.toFixed(2)})`):P.success(r)}else c([])}else c([]);g(!1)},selectedTableId:null==u?void 0:u.id,forceOpen:!u&&!p&&!ue,onTicketWithoutTable:()=>{x(null),f(!0),c([]),m(null),g(!1),P.success("Modo ticket sin mesa activado. Puedes agregar productos y cobrarlos directamente.")}}),Ce.jsx(na,{isOpen:y,onClose:()=>v(!1),allowPartialPayment:!(d||!u||p)&&"occupied"===u.status,partialPayments:u&&!p?De(u.id):[],totalPartialPayments:u&&!p?Pe(u.id):0,isTicketWithoutTable:p,onPartialPayment:u&&!p?(e,t)=>{Se(u.id,e,t),Te(u.id,e),P.success(`Cobro parcial de ${Me()}${e.toFixed(2)} registrado`)}:void 0,onPaymentComplete:async()=>{if(pe&&ue)try{await Gt.orders.update(ue,{items:l.map(e=>({productId:e.productId,productName:e.productName,quantity:e.quantity,unitPrice:e.unitPrice,totalPrice:e.totalPrice,modifiers:e.modifiers||[]})),subtotal:pe.newSubtotal||0,tax:pe.newTax||0,total:pe.newTotal||0,updatedAt:new Date}),ge(pe.newTotal||0),P.success(pe.isIncrease?"Diferencia cobrada y ticket actualizado":"Devolución procesada y ticket actualizado"),He()}catch(e){P.error("Error al guardar el ticket actualizado")}else if(u){De(u.id).length>0&&Ie(u.id),ve(u.id),c([]),m(null),x(null),g(!0),u.mergedWith?P.success("Cuenta de mesas unidas cobrada exitosamente. Las mesas han sido liberadas y desunidas. Selecciona una nueva mesa."):u.id.startsWith("account-")?P.success(`Cuenta de ${u.name} cobrada y cerrada exitosamente. Selecciona una nueva mesa.`):P.success(`Mesa ${u.number} cobrada y liberada exitosamente. Selecciona una nueva mesa.`)}else p&&(c([]),m(null),f(!1),g(!0),P.success("Ticket sin mesa cobrado exitosamente. Selecciona una nueva mesa."));v(!1),be(null)},orderItems:pe?[{productId:"diff",productName:pe.isIncrease?"Diferencia a cobrar (+)":"Devolución al cliente (-)",quantity:1,unitPrice:pe.isIncrease?pe.amount:-pe.amount,totalPrice:pe.isIncrease?pe.amount:-pe.amount,status:"pending"}]:l,tableNumber:(null==u?void 0:u.number)||"",customerName:d?`${d.name} ${d.lastName}`:"",subtotal:pe?pe.isIncrease?pe.amount:-pe.amount:Je,tax:pe?0:Ve,total:pe?pe.isIncrease?pe.amount:-pe.amount:Qe,mergedTableNumber:null==u?void 0:u.mergedWith,titleOverride:localStorage.getItem("orderToEdit")?pe?"Cobro de diferencia":"Actualizar Ticket":void 0,skipDbSave:!!localStorage.getItem("orderToEdit"),defaultPaymentMethod:"cash",originalOrderItems:pe?l:void 0,originalSubtotal:pe?pe.newSubtotal:void 0,originalTax:pe?pe.newTax:void 0,originalTotal:pe?pe.newTotal:void 0,selectedCustomer:d}),Ce.jsx(ia,{isOpen:j,onClose:()=>w(!1)}),C&&D&&Ce.jsx(ra,{value:(null==(e=l.find(e=>e.productId===D))?void 0:e.unitPrice)||0,onConfirm:e=>{D&&((e,t)=>{c(l.map(a=>a.productId===e?{...a,unitPrice:t,totalPrice:a.quantity*t}:a))})(D,e),k(!1),I(null)},onCancel:()=>{k(!1),I(null)},currencySymbol:Me()}),M&&R&&Ce.jsx(oa,{isOpen:M,onClose:()=>{E(!1),W(null),J(null)},productName:R.name,tariffs:R.tariffs||[],onSelectTariff:e=>{if(!u&&!p)return P.error("Debes seleccionar una mesa antes de agregar productos"),void g(!0);if(X&&R&&X.baseProduct.id===R.id){const{baseProduct:t,combinationNames:a,additionalPrice:s}=X,r=`${t.name} con ${a} - ${e.name}`,n=e.price+s,i={productId:t.id,productName:r,quantity:1,unitPrice:n,totalPrice:n,status:"pending",modifiers:[]};return c([...l,i]),void J(null)}R&&Ye(R,e)},currencySymbol:Me()}),L&&G&&Ce.jsx(la,{isOpen:L,onClose:()=>{q(!1),U(null)},baseProduct:G,combinations:G.combinations||[],availableProducts:Be,onConfirmCombination:(e,t)=>{if(!u&&!p)return P.error("Debes seleccionar una mesa antes de agregar productos"),void g(!0);const a=t.map(e=>`${e.product.name}${e.quantity>1?` (x${e.quantity})`:""}`).join(" + "),s=t.reduce((t,a)=>{const s=e.combinations.find(e=>e.productId===a.product.id);if(s)return t+s.additionalPrice*a.quantity;const r=e.combinations.find(e=>e.categoryId===a.product.categoryId);return t+((null==r?void 0:r.additionalPrice)||0)*a.quantity},0);if(e.tariffs&&e.tariffs.length>1)return J({baseProduct:e,selectedProducts:t,combinationNames:a,additionalPrice:s}),W(e),void E(!0);const r=`${e.name} con ${a}`,n=e.price+s,i={productId:e.id,productName:r,quantity:1,unitPrice:n,totalPrice:n,status:"pending"};c([...l,i])},currencySymbol:Me()}),K&&V&&Ce.jsx(ca,{isOpen:K,onClose:()=>{Z(!1),Q(null)},title:"Seleccionar modificadores",options:(e=>{const t=Oe.find(t=>t.id===e);return t?$e(t.categoryId):[]})(V),selected:(null==(t=l.find(e=>e.productId===V))?void 0:t.modifiers)||[],onSave:e=>{return t=V,a=e,void c(l.map(e=>e.productId===t?{...e,modifiers:a}:e));var t,a}}),ee&&ae&&Ce.jsx(da,{isOpen:ee,onClose:()=>te(!1),onConfirm:ae.onConfirm,title:ae.title,message:ae.message,type:ae.type}),re&&ie&&Ce.jsx(ba,{isOpen:re,onClose:()=>{ne(!1),oe(null)},customer:ie,onSave:async e=>{try{await We(e.id,e),m(e),P.success(`Saldo de ${e.name} ${e.lastName} actualizado a ${Me()}${e.balance.toFixed(2)}`)}catch(t){P.error("Error al actualizar el saldo del cliente")}}}),le&&d&&Ce.jsx(fa,{isOpen:le,onClose:()=>ce(!1),customer:d,incentives:qe,onRecharge:async(e,t,a)=>{try{const s=e.balance+t+a,r={...e,balance:s};await We(e.id,r),m(r);const n=t+a;a>0?P.success(`¡Recarga exitosa! ${e.name} pagó ${Me()}${t.toFixed(2)} y recibió ${Me()}${n.toFixed(2)} (${Me()}${a.toFixed(2)} de regalo)`):P.success(`Recarga exitosa! ${e.name} ahora tiene ${Me()}${s.toFixed(2)}`)}catch(s){P.error("Error al recargar el saldo del cliente")}},onOpenPaymentModal:(e,t)=>{const a=[{productId:"recharge",productName:"Recarga de Saldo"+(t>0?` + ${Me()}${t.toFixed(2)} regalo`:""),quantity:1,unitPrice:e,totalPrice:e,status:"pending"}],s=e,r=e;v(!0),localStorage.setItem("rechargeData",JSON.stringify({customer:d,amount:e,bonus:t,orderItems:a,subtotal:s,tax:0,total:r}))}}),de&&d&&Ce.jsx(ya,{isOpen:de,onClose:()=>me(!1),customer:d,tables:je,onTransfer:(e,t)=>{try{const s=Ae.flatMap(e=>e.tables),r=s.find(a=>{var s;return a.id!==e.id&&(null==(s=a.assignedCustomer)?void 0:s.id)===t.id});let n;if(r)n=r.id;else{const r=`${t.name} ${t.lastName}`,i=s.find(t=>t.name===r&&t.id!==e.id);if(i)n=i.id;else try{n=we(r)}catch(a){return void P.error("Error al crear la cuenta por nombre")}}const i=ye(e.id);if(0===i.length)return ve(e.id),ke(e.id,"available"),P.success(`Cuenta del cliente ${t.name} ${t.lastName} creada/abierta. Mesa ${e.number} liberada.`),m(null),x(null),c([]),void me(!1);const o=`${t.name} ${t.lastName}`,l=i.reduce((e,t)=>e+t.totalPrice,0);try{fe(n,l,i,t),ve(e.id),ke(e.id,"available"),P.success(`Cuenta trasladada exitosamente de Mesa ${e.number} a ${o}`),m(null),x(null),c([]),me(!1)}catch(a){return void P.error("Error durante el traslado de la cuenta")}}catch(a){P.error("Error al trasladar la cuenta")}}})]})},ja=({value:e,onChange:t,label:s="Color de fondo",className:r=""})=>{const[n,i]=a.useState(!1);return Ce.jsxs("div",{className:`space-y-3 ${r}`,children:[Ce.jsx("label",{className:"block text-sm font-medium text-gray-700",children:s}),Ce.jsxs("div",{className:"flex items-center space-x-3",children:[Ce.jsx("div",{className:"w-12 h-12 rounded-lg border-2 border-gray-300 shadow-sm",style:{backgroundColor:e},title:e}),Ce.jsx("input",{type:"text",value:e,onChange:e=>t(e.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent font-mono text-sm",placeholder:"#3b82f6"}),Ce.jsx("button",{type:"button",onClick:()=>i(!n),className:"p-2 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-lg transition-colors",title:"Selector de color personalizado",children:Ce.jsx(J,{className:"w-5 h-5"})})]}),n&&Ce.jsxs("div",{className:"space-y-3",children:[Ce.jsx("input",{type:"color",value:e,onChange:e=>t(e.target.value),className:"w-full h-12 border border-gray-300 rounded-lg cursor-pointer"}),Ce.jsxs("div",{children:[Ce.jsx("p",{className:"text-xs text-gray-600 mb-2",children:"Colores sugeridos:"}),Ce.jsx("div",{className:"grid grid-cols-10 gap-2",children:["#dc2626","#ea580c","#d97706","#ca8a04","#65a30d","#16a34a","#0d9488","#0891b2","#0284c7","#2563eb","#4f46e5","#7c3aed","#9333ea","#c026d3","#ec4899","#be123c","#92400e","#78716c","#52525b","#18181b"].map(a=>Ce.jsx("button",{type:"button",onClick:()=>t(a),className:"w-8 h-8 rounded-lg border-2 transition-all hover:scale-110 "+(e===a?"border-gray-800 scale-110":"border-gray-300"),style:{backgroundColor:a},title:a},a))})]})]}),Ce.jsx("p",{className:"text-xs text-gray-500",children:"Este color se mostrará en el botón del producto en el dashboard"})]})},Na=({tariffs:e,onChange:t})=>{const[s,r]=a.useState(null),[n,i]=a.useState({name:"",price:0}),o=(a,s)=>{const n=e.map(e=>e.id===a?{...e,...s}:e);t(n),r(null)};return Ce.jsxs("div",{className:"space-y-4",children:[Ce.jsxs("div",{className:"flex items-center justify-between",children:[Ce.jsx("h4",{className:"text-sm font-medium text-gray-700",children:"Tarifas del Producto"}),Ce.jsxs("span",{className:"text-xs text-gray-500",children:[e.length,"/4 tarifas"]})]}),Ce.jsx("div",{className:"space-y-2",children:e.map(a=>Ce.jsx("div",{className:"flex items-center space-x-2 p-3 bg-gray-50 rounded-lg",children:s===a.id?Ce.jsxs("div",{className:"flex-1 flex items-center space-x-2",children:[Ce.jsx("input",{type:"text",value:a.name,onChange:e=>o(a.id,{name:e.target.value}),className:"flex-1 px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",placeholder:"Nombre de la tarifa"}),Ce.jsx("input",{type:"number",step:"0.01",min:"0",value:a.price,onChange:e=>o(a.id,{price:parseFloat(e.target.value)||0}),className:"w-20 px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",placeholder:"Precio"}),Ce.jsx("button",{onClick:()=>r(null),className:"p-1 text-green-600 hover:bg-green-50 rounded",children:Ce.jsx(U,{className:"w-4 h-4"})})]}):Ce.jsxs("div",{className:"flex-1 flex items-center justify-between",children:[Ce.jsxs("div",{className:"flex items-center space-x-3",children:[Ce.jsxs("span",{className:"text-sm font-medium "+(a.isDefault?"text-blue-600":"text-gray-700"),children:[a.name,a.isDefault&&Ce.jsx("span",{className:"ml-1 text-xs bg-blue-100 text-blue-600 px-1 rounded",children:"Por defecto"})]}),Ce.jsxs("span",{className:"text-sm text-gray-600",children:["€",a.price.toFixed(2)]})]}),Ce.jsxs("div",{className:"flex items-center space-x-1",children:[!a.isDefault&&Ce.jsx("button",{onClick:()=>(a=>{const s=e.map(e=>({...e,isDefault:e.id===a}));t(s)})(a.id),className:"p-1 text-blue-600 hover:bg-blue-50 rounded text-xs",title:"Establecer como predeterminada",children:"⭐"}),Ce.jsx("button",{onClick:()=>r(a.id),className:"p-1 text-gray-600 hover:bg-gray-100 rounded",title:"Editar tarifa",children:Ce.jsx(V,{className:"w-4 h-4"})}),e.length>1&&Ce.jsx("button",{onClick:()=>(a=>{const s=e.find(e=>e.id===a);if((null==s?void 0:s.isDefault)&&e.length>1){const s=e.filter(e=>e.id!==a).map((e,t)=>({...e,isDefault:0===t}));t(s)}else t(e.filter(e=>e.id!==a))})(a.id),className:"p-1 text-red-600 hover:bg-red-50 rounded",title:"Eliminar tarifa",children:Ce.jsx(H,{className:"w-4 h-4"})})]})]})},a.id))}),e.length<4&&Ce.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-4",children:[Ce.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[Ce.jsx(F,{className:"w-4 h-4 text-gray-500"}),Ce.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Agregar Nueva Tarifa"})]}),Ce.jsxs("div",{className:"flex items-center space-x-2",children:[Ce.jsx("input",{type:"text",value:n.name,onChange:e=>i({...n,name:e.target.value}),className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Nombre (ej: Tapa, Ración, Media Ración)"}),Ce.jsx("input",{type:"number",step:"0.01",min:"0",value:n.price,onChange:e=>i({...n,price:parseFloat(e.target.value)||0}),className:"w-24 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Precio"}),Ce.jsx("button",{onClick:()=>{if(e.length>=4)return void alert("No puedes agregar más de 4 tarifas por producto");if(!n.name.trim()||n.price<=0)return void alert("Por favor completa el nombre y precio de la tarifa");const a={id:`tariff-${Date.now()}`,name:n.name.trim(),price:n.price,isDefault:0===e.length};t([...e,a]),i({name:"",price:0})},className:"px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-lg hover:bg-blue-700 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors",children:"Agregar"})]})]}),0===e.length&&Ce.jsxs("div",{className:"text-center py-4 text-gray-500 text-sm",children:[Ce.jsx("p",{children:"No hay tarifas configuradas."}),Ce.jsx("p",{className:"mt-1",children:"Agrega al menos una tarifa para que el producto sea visible en el dashboard."})]}),e.length>0&&Ce.jsxs("div",{className:"text-xs text-gray-500 bg-blue-50 p-3 rounded-lg",children:[Ce.jsx("p",{children:Ce.jsx("strong",{children:"Información:"})}),Ce.jsxs("ul",{className:"mt-1 space-y-1",children:[Ce.jsx("li",{children:"• La primera tarifa será la predeterminada"}),Ce.jsx("li",{children:"• Puedes cambiar la tarifa predeterminada haciendo clic en ⭐"}),Ce.jsx("li",{children:"• En el dashboard, si hay múltiples tarifas, se mostrará un selector"}),Ce.jsx("li",{children:"• Si solo hay una tarifa, se agregará directamente al pedido"})]})]})]})},wa=({isOpen:e,onClose:t,categoryId:s,categoryName:r,products:n,baseCombinationPrice:i,onSave:o,currencySymbol:l="€"})=>{const[c,d]=a.useState({}),[m,u]=a.useState(!1),[x,h]=a.useState(!1),[g,p]=a.useState(null);a.useEffect(()=>{if(e){const e={};n.forEach(t=>{e[t.id]=i}),d(e),u(!1)}},[e,n,i]);const b=()=>{u(!1),t()};return e?Ce.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[Ce.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[Ce.jsx("div",{className:"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75",onClick:b}),Ce.jsxs("div",{className:"inline-block align-bottom bg-white rounded-2xl text-left overflow-hidden shadow-xl transform transition-all sm:my-4 sm:align-middle sm:max-w-7xl sm:w-full",children:[Ce.jsx("div",{className:"bg-gradient-to-r from-purple-600 to-indigo-600 px-6 py-4",children:Ce.jsxs("div",{className:"flex items-center justify-between",children:[Ce.jsxs("div",{children:[Ce.jsxs("h3",{className:"text-lg font-semibold text-white",children:["Detalle de Productos - ",r]}),Ce.jsxs("p",{className:"text-purple-100 text-sm mt-1",children:["Precio base de categoría: ",i>0?"+":"",l,i.toFixed(2)]})]}),Ce.jsx("button",{onClick:b,className:"text-white hover:text-gray-200 p-2 rounded-lg hover:bg-white/20 transition-colors",children:Ce.jsx(S,{className:"w-5 h-5"})})]})}),Ce.jsxs("div",{className:"px-6 py-6",children:[Ce.jsxs("div",{className:"flex items-center justify-between mb-6",children:[Ce.jsxs("div",{className:"flex items-center space-x-4",children:[Ce.jsxs("span",{className:"text-sm text-gray-600",children:[n.length," productos en ",r]}),Ce.jsxs("button",{onClick:()=>{const e={};n.forEach(t=>{e[t.id]=i}),d(e),u(!0)},className:"flex items-center space-x-2 px-3 py-2 text-sm bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors",children:[Ce.jsx(Q,{className:"w-4 h-4"}),Ce.jsx("span",{children:"Restablecer a precio base"})]})]}),m&&Ce.jsx("span",{className:"text-sm text-orange-600 bg-orange-50 px-3 py-1 rounded-full",children:"Cambios sin guardar"})]}),Ce.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4 max-h-[70vh] overflow-y-auto",children:n.map(e=>Ce.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:border-purple-300 transition-colors",children:[Ce.jsxs("div",{className:"flex items-center justify-between mb-3",children:[Ce.jsxs("div",{className:"flex-1",children:[Ce.jsx("h4",{className:"font-medium text-gray-900 text-sm",children:e.name}),Ce.jsx("p",{className:"text-xs text-gray-500",children:e.description||"Sin descripción"})]}),Ce.jsx("div",{className:"w-4 h-4 rounded-full ml-2",style:{backgroundColor:e.backgroundColor||"#6b7280"}})]}),Ce.jsxs("div",{className:"space-y-2",children:[Ce.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[Ce.jsx("span",{children:"Precio base:"}),Ce.jsxs("span",{children:[l,e.price.toFixed(2)]})]}),Ce.jsxs("div",{className:"flex items-center space-x-2",children:[Ce.jsx("label",{className:"text-sm font-medium text-gray-700 flex-1",children:"Precio combinación:"}),Ce.jsxs("div",{className:"relative",children:[Ce.jsx("button",{type:"button",onClick:()=>{return t=e.id,p(t),void h(!0);var t},className:"w-24 px-3 py-2 text-sm border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-right cursor-pointer hover:bg-gray-50 transition-colors "+(c[e.id]>0?"border-green-300 bg-green-50 hover:bg-green-100":c[e.id]<0?"border-red-300 bg-red-50 hover:bg-red-100":"border-gray-300 hover:bg-gray-50"),children:(c[e.id]||0).toFixed(2)}),Ce.jsx("span",{className:"absolute right-2 top-2 text-xs text-gray-400 pointer-events-none",children:"€"})]})]}),Ce.jsxs("div",{className:"flex items-center justify-between text-xs",children:[Ce.jsx("span",{className:"text-gray-500",children:"Precio final:"}),Ce.jsxs("span",{className:"font-medium "+(e.price+(c[e.id]||0)>e.price?"text-green-600":e.price+(c[e.id]||0)<e.price?"text-red-600":"text-gray-600"),children:[l,(e.price+(c[e.id]||0)).toFixed(2)]})]})]})]},e.id))}),Ce.jsx("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:Ce.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[Ce.jsxs("div",{children:[Ce.jsx("span",{className:"text-gray-500",children:"Productos con precio +:"}),Ce.jsx("div",{className:"font-medium text-green-600",children:n.filter(e=>(c[e.id]||0)>0).length})]}),Ce.jsxs("div",{children:[Ce.jsx("span",{className:"text-gray-500",children:"Productos con descuento:"}),Ce.jsx("div",{className:"font-medium text-red-600",children:n.filter(e=>(c[e.id]||0)<0).length})]}),Ce.jsxs("div",{children:[Ce.jsx("span",{className:"text-gray-500",children:"Sin cambio:"}),Ce.jsx("div",{className:"font-medium text-gray-600",children:n.filter(e=>0===(c[e.id]||0)).length})]}),Ce.jsxs("div",{children:[Ce.jsx("span",{className:"text-gray-500",children:"Total productos:"}),Ce.jsx("div",{className:"font-medium text-gray-900",children:n.length})]})]})}),Ce.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[Ce.jsx("button",{onClick:b,className:"px-4 py-2 text-gray-600 hover:text-gray-800 font-medium rounded-lg hover:bg-gray-100 transition-colors",children:"Cancelar"}),Ce.jsxs("button",{onClick:()=>{const e=n.map(e=>({id:`comb-${s}-${e.id}`,productId:e.id,additionalPrice:c[e.id],isActive:!0}));o(e),u(!1),t()},disabled:!m,className:"px-6 py-2 bg-purple-600 text-white font-medium rounded-lg hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[Ce.jsx(X,{className:"w-4 h-4 inline mr-2"}),"Guardar Cambios"]})]})]})]})]}),x&&g&&Ce.jsx(ra,{value:c[g]||i,onConfirm:e=>{var t,a;g&&(t=g,a=e,d(e=>({...e,[t]:a})),u(!0)),h(!1),p(null)},onCancel:()=>{h(!1),p(null)},currencySymbol:l})]}):null},Ca=({combinations:e,categories:t,products:s,onChange:r})=>{const[n,i]=a.useState(null),[o,l]=a.useState({productId:"",categoryId:"",additionalPrice:0,combinationType:"product"}),[c,d]=a.useState({isOpen:!1,categoryId:"",categoryName:"",basePrice:0}),m=(t,a)=>{const s=e.map(e=>e.id===t?{...e,...a}:e);r(s),i(null)},u=e=>{var a;return(null==(a=t.find(t=>t.id===e))?void 0:a.name)||"Categoría no encontrada"};return Ce.jsxs("div",{className:"space-y-4",children:[Ce.jsxs("div",{className:"flex items-center justify-between",children:[Ce.jsx("h4",{className:"text-sm font-medium text-gray-700",children:"Combinaciones Disponibles"}),Ce.jsxs("span",{className:"text-xs text-gray-500",children:[e.length," combinaciones"]})]}),Ce.jsx("div",{className:"space-y-2",children:e.map(a=>{return Ce.jsx("div",{className:"flex items-center space-x-2 p-3 bg-gray-50 rounded-lg",children:n===a.id?Ce.jsxs("div",{className:"flex-1 flex items-center space-x-2",children:[Ce.jsxs("select",{value:a.categoryId,onChange:e=>m(a.id,{categoryId:e.target.value}),className:"flex-1 px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",children:[Ce.jsx("option",{value:"",children:"Seleccionar categoría"}),t.map(e=>Ce.jsx("option",{value:e.id,children:e.name},e.id))]}),Ce.jsx("input",{type:"number",step:"0.01",min:"0",value:a.additionalPrice,onChange:e=>m(a.id,{additionalPrice:parseFloat(e.target.value)||0}),className:"w-24 px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",placeholder:"Precio +"}),Ce.jsx("button",{onClick:()=>i(null),className:"p-1 text-green-600 hover:bg-green-50 rounded",children:Ce.jsx(U,{className:"w-4 h-4"})})]}):Ce.jsxs("div",{className:"flex-1 flex items-center justify-between",children:[Ce.jsxs("div",{className:"flex items-center space-x-3",children:[Ce.jsxs("div",{className:"flex items-center space-x-2",children:[Ce.jsx(K,{className:"w-4 h-4 text-blue-500"}),Ce.jsx("span",{className:"text-sm font-medium "+(a.isActive?"text-gray-700":"text-gray-400"),children:a.productId?(o=a.productId,(null==(l=s.find(e=>e.id===o))?void 0:l.name)||"Producto no encontrado"):u(a.categoryId)}),a.productId&&Ce.jsx("span",{className:"text-xs bg-purple-100 text-purple-600 px-1 rounded",children:"Producto"}),a.categoryId&&Ce.jsx("span",{className:"text-xs bg-blue-100 text-blue-600 px-1 rounded",children:"Categoría"}),!a.isActive&&Ce.jsx("span",{className:"text-xs bg-gray-100 text-gray-500 px-1 rounded",children:"Inactiva"})]}),Ce.jsxs("span",{className:"text-sm font-medium "+(a.additionalPrice>0?"text-green-600":a.additionalPrice<0?"text-red-600":"text-gray-600"),children:[a.additionalPrice>0?"+":"","€",a.additionalPrice.toFixed(2)]})]}),Ce.jsxs("div",{className:"flex items-center space-x-1",children:[Ce.jsx("button",{onClick:()=>(t=>{const a=e.map(e=>e.id===t?{...e,isActive:!e.isActive}:e);r(a)})(a.id),className:"p-1 rounded text-xs "+(a.isActive?"text-green-600 hover:bg-green-50":"text-gray-400 hover:bg-gray-100"),title:a.isActive?"Desactivar":"Activar",children:a.isActive?"✓":"○"}),Ce.jsx("button",{onClick:()=>i(a.id),className:"p-1 text-gray-600 hover:bg-gray-100 rounded",title:"Editar combinación",children:Ce.jsx(V,{className:"w-4 h-4"})}),Ce.jsx("button",{onClick:()=>{return t=a.id,void r(e.filter(e=>e.id!==t));var t},className:"p-1 text-red-600 hover:bg-red-50 rounded",title:"Eliminar combinación",children:Ce.jsx(H,{className:"w-4 h-4"})})]})]})},a.id);var o,l})}),Ce.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-4",children:[Ce.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[Ce.jsx(F,{className:"w-4 h-4 text-gray-500"}),Ce.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Agregar Nueva Combinación"})]}),Ce.jsxs("div",{className:"space-y-3",children:[Ce.jsxs("div",{className:"p-3 bg-blue-50 rounded-lg border border-blue-200",children:[Ce.jsxs("div",{className:"flex items-center justify-between mb-2",children:[Ce.jsx("span",{className:"text-sm font-medium text-blue-800",children:"Categoría completa (recomendado)"}),Ce.jsx("span",{className:"text-xs bg-blue-100 text-blue-600 px-2 py-1 rounded",children:"Nuevo"})]}),Ce.jsxs("div",{className:"flex items-center space-x-2",children:[Ce.jsxs("select",{value:o.categoryId,onChange:e=>l({...o,categoryId:e.target.value}),className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[Ce.jsx("option",{value:"",children:"Seleccionar categoría"}),t.map(e=>Ce.jsx("option",{value:e.id,children:e.name},e.id))]}),Ce.jsx("input",{type:"number",step:"0.01",value:o.additionalPrice,onChange:e=>l({...o,additionalPrice:parseFloat(e.target.value)||0}),className:"w-32 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Precio ±"}),Ce.jsxs("button",{onClick:()=>{if(o.categoryId&&""!==o.categoryId){const r=t.find(e=>e.id===o.categoryId);r&&(e=r.id,a=r.name,s=o.additionalPrice,d({isOpen:!0,categoryId:e,categoryName:a,basePrice:s}))}var e,a,s},disabled:!o.categoryId,className:"px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors",children:[Ce.jsx(p,{className:"w-4 h-4 inline mr-1"}),"Detalle"]}),Ce.jsxs("button",{onClick:()=>{if(!o.categoryId)return void alert("Selecciona una categoría");const t=s.filter(e=>e.categoryId===o.categoryId);if(0===t.length)return void alert("La categoría seleccionada no tiene productos");const a=t.map(e=>({id:`comb-${o.categoryId}-${e.id}`,productId:e.id,additionalPrice:o.additionalPrice,isActive:!0})),n=new Set(t.map(e=>e.id)),i=e.filter(e=>!(e.productId&&n.has(e.productId))&&e.categoryId!==o.categoryId);r([...i,...a])},disabled:!o.categoryId,className:"px-4 py-2 bg-green-600 text-white text-sm font-medium rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transition-colors",title:"Guardar directo para toda la categoría",children:[Ce.jsx(X,{className:"w-4 h-4 inline mr-1"}),"Guardar"]})]}),Ce.jsx("p",{className:"text-xs text-blue-600 mt-1",children:"💡 Establece un precio base y luego personaliza cada producto individualmente"})]}),Ce.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg border border-gray-200",children:[Ce.jsxs("div",{className:"flex items-center justify-between mb-2",children:[Ce.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Producto específico"}),Ce.jsx("span",{className:"text-xs bg-gray-100 text-gray-600 px-2 py-1 rounded",children:"Legacy"})]}),Ce.jsxs("div",{className:"flex items-center space-x-2",children:[Ce.jsxs("select",{value:o.productId,onChange:e=>l({...o,productId:e.target.value}),className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[Ce.jsx("option",{value:"",children:"Seleccionar producto específico"}),s.map(e=>Ce.jsxs("option",{value:e.id,children:[e.name," - ",e.price.toFixed(2),"€"]},e.id))]}),Ce.jsx("input",{type:"number",step:"0.01",value:o.additionalPrice,onChange:e=>l({...o,additionalPrice:parseFloat(e.target.value)||0}),className:"w-32 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Precio ±"}),Ce.jsx("button",{onClick:()=>{if("product"===o.combinationType&&!o.productId)return void alert("Por favor selecciona un producto");if("category"===o.combinationType&&!o.categoryId)return void alert("Por favor selecciona una categoría");if(e.some(e=>"product"===o.combinationType&&e.productId===o.productId||"category"===o.combinationType&&e.categoryId===o.categoryId))return void alert("Ya existe una combinación con este elemento");const t={id:`combination-${Date.now()}`,productId:"product"===o.combinationType?o.productId:void 0,categoryId:"category"===o.combinationType?o.categoryId:void 0,additionalPrice:o.additionalPrice,isActive:!0};r([...e,t]),l({productId:"",categoryId:"",additionalPrice:0,combinationType:"product"})},disabled:!o.productId,className:"px-4 py-2 bg-gray-600 text-white text-sm font-medium rounded-lg hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 transition-colors",children:"Agregar"})]})]})]}),Ce.jsxs("div",{className:"mt-3 text-xs text-gray-500",children:[Ce.jsx("p",{children:"💡 Puedes usar precios negativos para descuentos (ej: -1.00€)"}),Ce.jsx("p",{children:"💡 Precio 0.00€ = sin costo adicional"})]})]}),0===e.length&&Ce.jsxs("div",{className:"text-center py-4 text-gray-500 text-sm",children:[Ce.jsx("p",{children:"No hay combinaciones configuradas."}),Ce.jsx("p",{className:"mt-1",children:"Agrega combinaciones para permitir que este producto se combine con otros de categorías específicas."})]}),e.length>0&&Ce.jsxs("div",{className:"text-xs text-gray-500 bg-blue-50 p-3 rounded-lg",children:[Ce.jsx("p",{children:Ce.jsx("strong",{children:"Información sobre combinaciones:"})}),Ce.jsxs("ul",{className:"mt-1 space-y-1",children:[Ce.jsxs("li",{children:["• ",Ce.jsx("strong",{children:"Categoría completa (recomendado):"})," Establece un precio base y personaliza cada producto"]}),Ce.jsxs("li",{children:["• ",Ce.jsx("strong",{children:"Producto específico:"})," Combinación directa con un producto individual"]}),Ce.jsxs("li",{children:["• ",Ce.jsx("strong",{children:"Precio positivo (+):"})," Se suma al precio base del producto"]}),Ce.jsxs("li",{children:["• ",Ce.jsx("strong",{children:"Precio negativo (-):"})," Se resta del precio base (descuento)"]}),Ce.jsxs("li",{children:["• ",Ce.jsx("strong",{children:"Precio 0.00€:"})," Sin costo adicional"]}),Ce.jsxs("li",{children:["• ",Ce.jsx("strong",{children:'Botón "Detalle":'})," Abre un popup para editar precios individuales"]}),Ce.jsx("li",{children:"• En el dashboard, aparecerá la opción de combinar cuando sea relevante"}),Ce.jsx("li",{children:"• Puedes activar/desactivar combinaciones sin eliminarlas"})]})]}),Ce.jsx(wa,{isOpen:c.isOpen,onClose:()=>d({...c,isOpen:!1}),categoryId:c.categoryId,categoryName:c.categoryName,products:s.filter(e=>e.categoryId===c.categoryId),baseCombinationPrice:c.basePrice,onSave:t=>{const a=e.filter(e=>e.categoryId!==c.categoryId);r([...a,...t])},currencySymbol:"€"})]})},ka=()=>{const{products:e,categories:t,addProduct:s,updateProduct:r,deleteProduct:n}=xa(),{getCurrencySymbol:i}=Qt(),[o,l]=a.useState(""),[c,d]=a.useState(""),[m,u]=a.useState(!1),[x,h]=a.useState(!1),[g,p]=a.useState(null),[b,y]=a.useState({name:"",price:"",categoryId:"",description:"",backgroundColor:"#3b82f6",isActive:!0}),[v,j]=a.useState([]),[N,w]=a.useState([]),C=e.filter(e=>{const t=!o||e.name.toLowerCase().includes(o.toLowerCase()),a=!c||e.categoryId===c,s=m||e.isActive;return t&&a&&s}),k=e=>{var a;e?(p(e),y({name:e.name,price:e.price.toString(),categoryId:e.categoryId,description:e.description||"",backgroundColor:e.backgroundColor||"#3b82f6",isActive:e.isActive}),j(e.tariffs||[]),w(e.combinations||[])):(p(null),y({name:"",price:"",categoryId:(null==(a=t[0])?void 0:a.id)||"",description:"",backgroundColor:"#3b82f6",isActive:!0}),j([]),w([])),h(!0)},A=()=>{h(!1),p(null),y({name:"",price:"",categoryId:"",description:"",backgroundColor:"#3b82f6",isActive:!0}),j([]),w([])};return Ce.jsxs("div",{className:"h-full bg-gray-50",children:[Ce.jsxs("div",{className:"p-6",children:[Ce.jsxs("div",{className:"flex items-center justify-between mb-6",children:[Ce.jsxs("div",{children:[Ce.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Gestión de Productos"}),Ce.jsx("p",{className:"text-gray-600",children:"Administra tu catálogo de productos"})]}),Ce.jsxs("button",{onClick:()=>k(),className:"btn btn-primary flex items-center space-x-2 px-6 py-4 min-h-[48px] text-base font-medium",children:[Ce.jsx(F,{className:"w-5 h-5"}),Ce.jsx("span",{children:"Nuevo Producto"})]})]}),Ce.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 mb-6",children:Ce.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[Ce.jsx("div",{className:"flex-1 min-w-64",children:Ce.jsxs("div",{className:"relative",children:[Ce.jsx(T,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),Ce.jsx("input",{type:"text",placeholder:"Buscar productos...",value:o,onChange:e=>l(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]})}),Ce.jsxs("select",{value:c,onChange:e=>d(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500",children:[Ce.jsx("option",{value:"",children:"Todas las categorías"}),t.map(e=>Ce.jsx("option",{value:e.id,children:e.name},e.id))]}),Ce.jsxs("label",{className:"flex items-center space-x-2",children:[Ce.jsx("input",{type:"checkbox",checked:m,onChange:e=>u(e.target.checked),className:"rounded border-gray-300 text-primary-600 focus:ring-primary-500"}),Ce.jsx("span",{className:"text-sm text-gray-700",children:"Mostrar inactivos"})]})]})}),Ce.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:Ce.jsxs("div",{className:"overflow-x-auto overflow-y-auto max-h-[600px]",children:[Ce.jsxs("table",{className:"w-full",children:[Ce.jsx("thead",{className:"bg-gray-50",children:Ce.jsxs("tr",{children:[Ce.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Producto"}),Ce.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Categoría"}),Ce.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Precio/Tarifas"}),Ce.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Combinaciones"}),Ce.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Color"}),Ce.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Estado"}),Ce.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Acciones"})]})}),Ce.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:C.map(a=>{const s=t.find(e=>e.id===a.categoryId);return Ce.jsxs("tr",{className:"hover:bg-gray-50",children:[Ce.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:Ce.jsxs("div",{className:"flex items-center",children:[Ce.jsx(f,{className:"w-8 h-8 text-gray-400 mr-3"}),Ce.jsxs("div",{children:[Ce.jsx("div",{className:"text-sm font-medium text-gray-900",children:a.name}),a.description&&Ce.jsx("div",{className:"text-sm text-gray-500",children:a.description})]})]})}),Ce.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s&&Ce.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium text-white",style:{backgroundColor:s.color},children:s.name})}),Ce.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:Ce.jsx("div",{className:"flex items-center text-sm font-medium text-gray-900",children:a.tariffs&&a.tariffs.length>0?Ce.jsx("div",{className:"space-y-1",children:a.tariffs.map((e,t)=>Ce.jsxs("div",{className:"flex items-center space-x-2",children:[Ce.jsx("span",{className:"text-xs px-2 py-1 rounded "+(e.isDefault?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-600"),children:e.name}),Ce.jsxs("span",{className:"font-medium",children:[i(),e.price.toFixed(2)]})]},e.id))}):Ce.jsxs(Ce.Fragment,{children:[Ce.jsx(z,{className:"w-4 h-4 mr-1"}),i(),a.price.toFixed(2)]})})}),Ce.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:Ce.jsx("div",{className:"flex items-center text-sm font-medium text-gray-900",children:a.combinations&&a.combinations.length>0?Ce.jsx("div",{className:"space-y-1",children:a.combinations.filter(e=>e.isActive).map((a,s)=>{const r=t.find(e=>e.id===a.categoryId),n=e.find(e=>e.id===a.productId);return Ce.jsxs("div",{className:"flex items-center space-x-2",children:[a.productId?Ce.jsxs(Ce.Fragment,{children:[Ce.jsx("span",{className:"text-xs bg-purple-100 text-purple-800 px-2 py-1 rounded",children:(null==n?void 0:n.name)||"Producto"}),Ce.jsx("span",{className:"text-xs bg-purple-50 text-purple-600 px-1 rounded",children:"Prod"})]}):Ce.jsxs(Ce.Fragment,{children:[Ce.jsx("span",{className:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded",children:(null==r?void 0:r.name)||"Categoría"}),Ce.jsx("span",{className:"text-xs bg-blue-50 text-blue-600 px-1 rounded",children:"Cat"})]}),Ce.jsxs("span",{className:"text-xs font-medium "+(a.additionalPrice>0?"text-green-600":a.additionalPrice<0?"text-red-600":"text-gray-600"),children:[a.additionalPrice>0?"+":"","€",a.additionalPrice.toFixed(2)]})]},a.id)})}):Ce.jsx("span",{className:"text-gray-400 text-xs",children:"Sin combinaciones"})})}),Ce.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.backgroundColor&&Ce.jsxs("div",{className:"flex items-center space-x-2",children:[Ce.jsx("div",{className:"w-6 h-6 rounded border border-gray-300",style:{backgroundColor:a.backgroundColor},title:a.backgroundColor}),Ce.jsx("span",{className:"text-xs text-gray-600 font-mono",children:a.backgroundColor})]})}),Ce.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:Ce.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium "+(a.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:a.isActive?"Activo":"Inactivo"})}),Ce.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:Ce.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[Ce.jsx("button",{onClick:()=>(e=>{r(e.id,{isActive:!e.isActive}),P.success("Producto "+(e.isActive?"desactivado":"activado"))})(a),className:"p-3 text-gray-400 hover:text-gray-600 min-w-[44px] min-h-[44px] flex items-center justify-center rounded-lg hover:bg-gray-100 transition-colors",title:a.isActive?"Desactivar":"Activar",children:a.isActive?Ce.jsx(Z,{className:"w-5 h-5"}):Ce.jsx(ee,{className:"w-5 h-5"})}),Ce.jsx("button",{onClick:()=>k(a),className:"p-3 text-blue-600 hover:text-blue-800 min-w-[44px] min-h-[44px] flex items-center justify-center rounded-lg hover:bg-blue-100 transition-colors",title:"Editar",children:Ce.jsx(te,{className:"w-5 h-5"})}),Ce.jsx("button",{onClick:()=>(e=>{window.confirm(`¿Estás seguro de eliminar "${e.name}"?`)&&(n(e.id),P.success("Producto eliminado"))})(a),className:"p-3 text-red-600 hover:text-red-800 min-w-[44px] min-h-[44px] flex items-center justify-center rounded-lg hover:bg-red-100 transition-colors",title:"Eliminar",children:Ce.jsx(H,{className:"w-5 h-5"})})]})})]},a.id)})})]}),0===C.length&&Ce.jsxs("div",{className:"text-center py-12",children:[Ce.jsx(f,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),Ce.jsx("p",{className:"text-gray-500",children:"No se encontraron productos"})]})]})})]}),x&&Ce.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:Ce.jsx("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:Ce.jsxs("div",{className:"p-6",children:[Ce.jsxs("div",{className:"flex items-center justify-between mb-4",children:[Ce.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:g?"Editar Producto":"Nuevo Producto"}),Ce.jsx("button",{onClick:A,className:"p-3 text-gray-400 hover:text-gray-600 min-w-[44px] min-h-[44px] flex items-center justify-center rounded-lg hover:bg-gray-100 transition-colors",children:Ce.jsx(S,{className:"w-6 h-6"})})]}),Ce.jsxs("div",{className:"space-y-4",children:[Ce.jsxs("div",{children:[Ce.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre *"}),Ce.jsx("input",{type:"text",value:b.name,onChange:e=>y({...b,name:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"Nombre del producto"})]}),Ce.jsxs("div",{children:[Ce.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Precio *"}),Ce.jsx("input",{type:"number",min:"0",step:"0.01",value:b.price,onChange:e=>y({...b,price:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"0.00"})]}),Ce.jsxs("div",{children:[Ce.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Categoría *"}),Ce.jsxs("select",{value:b.categoryId,onChange:e=>y({...b,categoryId:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[Ce.jsx("option",{value:"",children:"Seleccionar categoría"}),t.map(e=>Ce.jsx("option",{value:e.id,children:e.name},e.id))]})]}),Ce.jsxs("div",{children:[Ce.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descripción"}),Ce.jsx("textarea",{value:b.description,onChange:e=>y({...b,description:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",rows:3,placeholder:"Descripción opcional del producto"})]}),Ce.jsx(ja,{value:b.backgroundColor,onChange:e=>y({...b,backgroundColor:e}),label:"Color de fondo del botón"}),Ce.jsx(Na,{tariffs:v,onChange:j}),Ce.jsx(Ca,{combinations:N,categories:t,products:e,onChange:w}),Ce.jsx("div",{children:Ce.jsxs("label",{className:"flex items-center space-x-2",children:[Ce.jsx("input",{type:"checkbox",checked:b.isActive,onChange:e=>y({...b,isActive:e.target.checked}),className:"rounded border-gray-300 text-primary-600 focus:ring-primary-500"}),Ce.jsx("span",{className:"text-sm text-gray-700",children:"Producto activo"})]})})]}),Ce.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[Ce.jsx("button",{onClick:A,className:"px-6 py-4 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors min-h-[48px] flex items-center justify-center text-base font-medium",children:"Cancelar"}),Ce.jsxs("button",{onClick:()=>{if(!b.name.trim()||!b.price||!b.categoryId)return void P.error("Completa todos los campos obligatorios");const e=parseFloat(b.price);if(e<=0)return void P.error("El precio debe ser mayor a 0");const t={name:b.name.trim(),price:e,categoryId:b.categoryId,description:b.description.trim(),backgroundColor:b.backgroundColor,tariffs:v,combinations:N,isActive:b.isActive};g?(r(g.id,t),P.success("Producto actualizado exitosamente")):(s(t),P.success("Producto creado exitosamente")),A()},className:"px-6 py-4 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors flex items-center space-x-2 min-h-[48px] text-base font-medium",children:[Ce.jsx(X,{className:"w-5 h-5"}),Ce.jsx("span",{children:"Guardar"})]})]})]})})})]})},Aa=()=>{const{categories:e,addCategory:t,updateCategory:s,deleteCategory:r,products:n,updateProduct:i}=xa(),{getCurrencySymbol:o}=Qt(),[l,c]=a.useState(""),[d,m]=a.useState(!1),[u,x]=a.useState(null),[h,g]=a.useState({name:"",description:"",color:"#3B82F6"}),[p,b]=a.useState(""),[f,y]=a.useState(""),[v,j]=a.useState(0),[N,w]=a.useState(!1),[C,k]=a.useState(null),[A,D]=a.useState(0),I=["#3B82F6","#EF4444","#10B981","#F59E0B","#8B5CF6","#EC4899","#06B6D4","#84CC16","#F97316","#6366F1"],M=e.filter(e=>!l||e.name.toLowerCase().includes(l.toLowerCase())),E=e=>{e?(x(e),g({name:e.name,description:e.description||"",color:e.color})):(x(null),g({name:"",description:"",color:I[0]})),m(!0)},$=()=>{m(!1),x(null),g({name:"",description:"",color:"#3B82F6"})};return Ce.jsxs("div",{className:"h-full bg-gray-50",children:[Ce.jsxs("div",{className:"p-6",children:[Ce.jsxs("div",{className:"flex items-center justify-between mb-6",children:[Ce.jsxs("div",{children:[Ce.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Gestión de Categorías"}),Ce.jsx("p",{className:"text-gray-600",children:"Organiza tus productos por categorías"})]}),Ce.jsxs("button",{onClick:()=>E(),className:"btn btn-primary flex items-center space-x-2 px-6 py-4 min-h-[48px] text-base font-medium",children:[Ce.jsx(F,{className:"w-5 h-5"}),Ce.jsx("span",{children:"Nueva Categoría"})]})]}),Ce.jsxs("div",{className:"bg-blue-50 rounded-lg border border-blue-200 p-4 mb-6",children:[Ce.jsxs("div",{className:"flex items-center justify-between mb-2",children:[Ce.jsx("span",{className:"text-sm font-medium text-blue-800",children:"Combinaciones por categorías"}),Ce.jsxs("span",{className:"text-xs bg-blue-100 text-blue-600 px-2 py-1 rounded inline-flex items-center",children:[Ce.jsx(K,{className:"w-3 h-3 mr-1"})," Rápido"]})]}),Ce.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[Ce.jsxs("select",{value:p,onChange:e=>b(e.target.value),className:"px-3 py-2 text-sm border border-blue-200 rounded-lg bg-white",children:[Ce.jsx("option",{value:"",children:"Origen"}),e.map(e=>Ce.jsx("option",{value:e.id,children:e.name},e.id))]}),Ce.jsx("span",{className:"text-sm text-blue-700",children:"se combina con"}),Ce.jsxs("select",{value:f,onChange:e=>y(e.target.value),className:"px-3 py-2 text-sm border border-blue-200 rounded-lg bg-white",children:[Ce.jsx("option",{value:"",children:"Destino"}),e.map(e=>Ce.jsx("option",{value:e.id,children:e.name},e.id))]}),Ce.jsx("input",{type:"number",step:"0.01",value:v,onChange:e=>j(parseFloat(e.target.value)||0),className:"w-28 px-3 py-2 text-sm border border-blue-200 rounded-lg",placeholder:"Precio ±"}),Ce.jsx("button",{onClick:()=>{if(!p||!f)return void P.error("Selecciona categoría origen y destino");if(p===f)return void P.error("El origen y destino no pueden ser iguales");const e=n.filter(e=>e.categoryId===p);0!==e.length?(e.forEach(e=>{const t=(e.combinations||[]).filter(e=>e.categoryId!==f),a={id:`comb-catcat-${p}-${f}-${e.id}`,categoryId:f,additionalPrice:v,isActive:!0};i(e.id,{combinations:[...t,a]})}),P.success(`Combinaciones aplicadas a ${e.length} productos`)):P.error("La categoría origen no tiene productos")},className:"px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-lg hover:bg-blue-700",children:"Aplicar a la categoría"})]}),Ce.jsx("p",{className:"text-xs text-blue-700 mt-1",children:'El campo "Precio" sirve para añadir (o restar con valores negativos) el precio a la categoría destino.'}),Ce.jsx("p",{className:"text-xs text-blue-600 mt-1",children:"Aplica una combinación por categoría destino a todos los productos de la categoría origen."})]}),Ce.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 mb-6",children:Ce.jsx("div",{className:"flex items-center gap-4",children:Ce.jsx("div",{className:"flex-1 max-w-md",children:Ce.jsxs("div",{className:"relative",children:[Ce.jsx(T,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),Ce.jsx("input",{type:"text",placeholder:"Buscar categorías...",value:l,onChange:e=>c(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]})})})}),Ce.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:M.map(e=>Ce.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 hover:shadow-md transition-shadow",children:[Ce.jsxs("div",{className:"flex items-start justify-between mb-4",children:[Ce.jsxs("div",{className:"flex items-center space-x-3",children:[Ce.jsx("div",{className:"w-4 h-4 rounded-full",style:{backgroundColor:e.color}}),Ce.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:e.name})]}),Ce.jsxs("div",{className:"flex items-center space-x-1",children:[Ce.jsx("button",{onClick:()=>E(e),className:"p-3 text-gray-400 hover:text-blue-600 min-w-[44px] min-h-[44px] flex items-center justify-center rounded-lg hover:bg-blue-100 transition-colors",title:"Editar",children:Ce.jsx(te,{className:"w-5 h-5"})}),Ce.jsx("button",{onClick:()=>(e=>{if(window.confirm(`¿Estás seguro de eliminar la categoría "${e.name}"?`))try{r(e.id),P.success("Categoría eliminada")}catch(t){P.error(t instanceof Error?t.message:"Error al eliminar la categoría")}})(e),className:"p-3 text-gray-400 hover:text-red-600 min-w-[44px] min-h-[44px] flex items-center justify-center rounded-lg hover:bg-red-100 transition-colors",title:"Eliminar",children:Ce.jsx(H,{className:"w-5 h-5"})})]})]}),e.description&&Ce.jsx("p",{className:"text-gray-600 text-sm mb-4",children:e.description}),Ce.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500",children:[Ce.jsxs("span",{className:"flex items-center",children:[Ce.jsx(ae,{className:"w-4 h-4 mr-1"}),"Categoría"]}),Ce.jsx("div",{className:"px-2 py-1 rounded-full text-xs font-medium text-white",style:{backgroundColor:e.color},children:e.color})]})]},e.id))}),0===M.length&&Ce.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-12 text-center",children:[Ce.jsx(ae,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),Ce.jsx("p",{className:"text-gray-500",children:"No se encontraron categorías"}),Ce.jsx("button",{onClick:()=>E(),className:"mt-4 btn btn-primary px-6 py-4 min-h-[48px] text-base font-medium",children:"Crear primera categoría"})]})]}),d&&Ce.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:Ce.jsx("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full",children:Ce.jsxs("div",{className:"p-6",children:[Ce.jsxs("div",{className:"flex items-center justify-between mb-4",children:[Ce.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:u?"Editar Categoría":"Nueva Categoría"}),Ce.jsx("button",{onClick:$,className:"p-3 text-gray-400 hover:text-gray-600 min-w-[44px] min-h-[44px] flex items-center justify-center rounded-lg hover:bg-gray-100 transition-colors",children:Ce.jsx(S,{className:"w-6 h-6"})})]}),Ce.jsxs("div",{className:"space-y-4",children:[Ce.jsxs("div",{children:[Ce.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre *"}),Ce.jsx("input",{type:"text",value:h.name,onChange:e=>g({...h,name:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"Nombre de la categoría"})]}),Ce.jsxs("div",{children:[Ce.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descripción"}),Ce.jsx("textarea",{value:h.description,onChange:e=>g({...h,description:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",rows:3,placeholder:"Descripción opcional de la categoría"})]}),Ce.jsxs("div",{children:[Ce.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Color"}),Ce.jsxs("div",{className:"space-y-3",children:[Ce.jsxs("div",{className:"flex items-center space-x-2",children:[Ce.jsx("input",{type:"color",value:h.color,onChange:e=>g({...h,color:e.target.value}),className:"w-8 h-8 border border-gray-300 rounded cursor-pointer"}),Ce.jsx("input",{type:"text",value:h.color,onChange:e=>g({...h,color:e.target.value}),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"#3B82F6"})]}),Ce.jsx("div",{className:"grid grid-cols-5 gap-3",children:I.map(e=>Ce.jsx("button",{type:"button",onClick:()=>g({...h,color:e}),className:"w-12 h-12 rounded-full border-2 transition-all "+(h.color===e?"border-gray-900 scale-110":"border-gray-300 hover:border-gray-400"),style:{backgroundColor:e},title:e},e))})]})]}),Ce.jsxs("div",{children:[Ce.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Vista previa"}),Ce.jsxs("div",{className:"flex items-center space-x-2 p-3 bg-gray-50 rounded-lg",children:[Ce.jsx("div",{className:"w-4 h-4 rounded-full",style:{backgroundColor:h.color}}),Ce.jsx("span",{className:"text-sm font-medium",children:h.name||"Nombre de la categoría"})]})]}),u&&Ce.jsxs("div",{children:[Ce.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Combinaciones de esta categoría"}),(t=>{const a=n.filter(e=>e.categoryId===t);a.length;const s={},r={};a.forEach(e=>{(e.combinations||[]).filter(e=>!!e.categoryId).forEach(e=>{const t=e.categoryId;s[t]||(s[t]=[]),s[t].push(e.additionalPrice),r[t]=(r[t]||0)+(e.isActive?1:0)})});const l=Object.keys(s);if(0===l.length)return Ce.jsx("div",{className:"text-sm text-gray-500",children:"Sin combinaciones por categoría"});const c=o();return Ce.jsx("div",{className:"space-y-2",children:l.map(a=>{const o=s[a],l=e.find(e=>e.id===a),d=o.length,m=r[a]||0,u=m===d,x=o.every(e=>e===o[0]),h=Math.min(...o),g=Math.max(...o),p=x?o[0]:h;return Ce.jsxs("div",{className:"flex items-center justify-between p-2 border rounded-lg",children:[Ce.jsxs("div",{className:"flex items-center gap-2",children:[Ce.jsx("span",{className:"text-xs px-2 py-1 rounded text-white",style:{backgroundColor:(null==l?void 0:l.color)||"#64748b"},children:(null==l?void 0:l.name)||"Categoría"}),Ce.jsxs("span",{className:"text-xs text-gray-500",children:[m,"/",d," activos"]})]}),Ce.jsxs("div",{className:"flex items-center gap-2",children:[Ce.jsx("span",{className:"text-sm font-medium",children:x?`${c}${p.toFixed(2)}`:`Varios (${c}${h.toFixed(2)} - ${c}${g.toFixed(2)})`}),Ce.jsxs("button",{onClick:()=>{return e=p,k(a),D(e),void w(!0);var e},className:"text-xs inline-flex items-center px-2 py-1 bg-gray-100 text-gray-700 rounded hover:bg-gray-200",title:"Editar precio masivo",children:[Ce.jsx(z,{className:"w-3 h-3 mr-1"})," Precio"]}),Ce.jsxs("button",{onClick:()=>{return e=t,s=a,r=!u,n.filter(t=>t.categoryId===e).forEach(e=>{const t=(e.combinations||[]).map(e=>e.categoryId===s?{...e,isActive:r}:e);i(e.id,{combinations:t})}),void P.success((r?"Activadas":"Desactivadas")+" combinaciones hacia la categoría seleccionada");var e,s,r},className:"text-xs inline-flex items-center px-2 py-1 rounded "+(u?"bg-red-50 text-red-600 hover:bg-red-100":"bg-green-50 text-green-600 hover:bg-green-100"),title:u?"Desactivar todas":"Activar todas",children:[Ce.jsx(se,{className:"w-3 h-3 mr-1"})," ",u?"Desactivar":"Activar"]})]})]},a)})})})(u.id)]})]}),Ce.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[Ce.jsx("button",{onClick:$,className:"px-6 py-4 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors min-h-[48px] flex items-center justify-center text-base font-medium",children:"Cancelar"}),Ce.jsxs("button",{onClick:()=>{if(!h.name.trim())return void P.error("El nombre es obligatorio");const e={name:h.name.trim(),description:h.description.trim(),color:h.color,isActive:!0};u?(s(u.id,e),P.success("Categoría actualizada exitosamente")):(t(e),P.success("Categoría creada exitosamente")),$()},className:"px-6 py-4 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors flex items-center space-x-2 min-h-[48px] text-base font-medium",children:[Ce.jsx(X,{className:"w-5 h-5"}),Ce.jsx("span",{children:"Guardar"})]})]})]})})}),N&&C&&u&&Ce.jsx(ra,{value:A,onConfirm:e=>{if(!u||!C)return void w(!1);n.filter(e=>e.categoryId===u.id).forEach(t=>{const a=(t.combinations||[]).map(t=>t.categoryId===C?{...t,additionalPrice:e}:t);i(t.id,{combinations:a})}),w(!1),k(null),P.success("Precio actualizado para todas las combinaciones seleccionadas")},onCancel:()=>{w(!1),k(null)},currencySymbol:o()})]})},Sa=()=>{const[e,t]=a.useState(null),[s,n]=a.useState("tables"),[i,o]=a.useState(!1),[l,c]=a.useState(!1),[d,m]=a.useState(!1),[u,x]=a.useState(null),[h,g]=a.useState(null),[p,f]=a.useState(null),[y,v]=a.useState(!1),[N,w]=a.useState({number:"",name:"",capacity:"",x:100,y:100,width:80,height:80}),[C,k]=a.useState({name:"",description:""}),[A,S]=a.useState({name:""}),D=he(()=>Gt.salons.where("isActive").equals(1).toArray()),I=he(()=>e?Gt.posTables.where("salonId").equals(e).toArray():[],[e]),T=he(()=>{if(e)return Gt.salons.get(e)},[e]),M=he(()=>e?Gt.namedAccounts.where("salonId").equals(e).toArray().then(e=>e.filter(e=>"active"===e.status)):[],[e]);r.useEffect(()=>{D&&D.length>0&&!e&&t(D[0].id)},[D,e]);const E=e=>{x(e),w({number:e.number,name:e.name,capacity:e.capacity.toString(),x:e.x,y:e.y,width:e.width,height:e.height}),o(!0)},$=async e=>{if("occupied"!==e.status){if(window.confirm(`¿Estás seguro de que quieres eliminar la mesa "${e.name}"?`))try{await Gt.posTables.delete(e.id),P.success("Mesa eliminada exitosamente")}catch(t){P.error("Error al eliminar la mesa")}}else P.error("No se puede eliminar una mesa que está ocupada")},O=()=>{o(!1),x(null),w({number:"",name:"",capacity:"",x:100,y:100,width:80,height:80})},R=()=>{c(!1),g(null),k({name:"",description:""})},W=async e=>{if(window.confirm(`¿Estás seguro de que quieres cobrar la cuenta de "${e.name}"?`))try{await Gt.namedAccounts.update(e.id,{status:"paid",paidAt:new Date,updatedAt:new Date,syncStatus:"pending"}),P.success(`Cuenta de ${e.name} cobrada exitosamente`)}catch(t){P.error("Error al cobrar la cuenta")}},L=()=>{m(!1),S({name:""})},q=e=>{switch(e){case"available":return"border-green-300 bg-green-50 text-green-800";case"occupied":return"border-red-300 bg-red-50 text-red-800";case"reserved":return"border-yellow-300 bg-yellow-50 text-yellow-800";case"maintenance":return"border-gray-400 bg-gray-100 text-gray-600";default:return"border-gray-300 bg-gray-50 text-gray-800"}},B=e=>{switch(e){case"available":return"Disponible";case"occupied":return"Ocupada";case"reserved":return"Reservada";case"maintenance":return"Mantenimiento";default:return e}};return Ce.jsxs("div",{className:"h-full flex flex-col bg-gray-50",children:[Ce.jsxs("div",{className:"bg-white border-b border-gray-200 p-6",children:[Ce.jsxs("div",{className:"flex items-center justify-between mb-4",children:[Ce.jsxs("div",{className:"flex items-center space-x-3",children:[Ce.jsx(j,{className:"w-6 h-6 text-primary-600"}),Ce.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Editor de Salones y Mesas"})]}),Ce.jsxs("div",{className:"flex items-center space-x-2",children:[Ce.jsxs("button",{onClick:()=>c(!0),className:"btn btn-secondary flex items-center space-x-2 px-6 py-4 min-h-[48px] text-base font-medium",children:[Ce.jsx(F,{className:"w-5 h-5"}),Ce.jsx("span",{children:"Nuevo Salón"})]}),"tables"===s?Ce.jsxs("button",{onClick:()=>{x(null),w({number:"",name:"",capacity:"",x:50+200*Math.random(),y:50+200*Math.random(),width:80,height:80}),o(!0)},disabled:!e,className:"btn btn-primary flex items-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed px-6 py-4 min-h-[48px] text-base font-medium",children:[Ce.jsx(F,{className:"w-5 h-5"}),Ce.jsx("span",{children:"Nueva Mesa"})]}):Ce.jsxs("button",{onClick:()=>{S({name:""}),m(!0)},disabled:!e,className:"btn btn-primary flex items-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed px-6 py-4 min-h-[48px] text-base font-medium",style:{backgroundColor:"#9333ea",borderColor:"#9333ea"},children:[Ce.jsx(F,{className:"w-5 h-5"}),Ce.jsx("span",{children:"Nueva Cuenta"})]})]})]}),Ce.jsxs("div",{className:"flex items-center space-x-4",children:[Ce.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Salón:"}),Ce.jsxs("select",{value:e||"",onChange:e=>t(e.target.value?Number(e.target.value):null),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[Ce.jsx("option",{value:"",children:"Seleccionar salón..."}),null==D?void 0:D.map(e=>Ce.jsx("option",{value:e.id,children:e.name},e.id))]}),T&&Ce.jsx("button",{onClick:()=>{return g(e=T),k({name:e.name,description:e.description||""}),void c(!0);var e},className:"p-3 text-blue-600 hover:bg-blue-100 rounded-lg transition-colors min-w-[44px] min-h-[44px] flex items-center justify-center",title:"Editar salón",children:Ce.jsx(te,{className:"w-5 h-5"})})]}),e&&Ce.jsxs("div",{className:"flex space-x-1 mt-4",children:[Ce.jsx("button",{onClick:()=>n("tables"),className:"px-4 py-2 rounded-lg font-medium transition-colors "+("tables"===s?"bg-primary-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:"Mesas"}),Ce.jsx("button",{onClick:()=>n("accounts"),className:"px-4 py-2 rounded-lg font-medium transition-colors "+("accounts"===s?"bg-purple-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:"Cuentas por Nombre"})]})]}),Ce.jsx("div",{className:"flex-1 overflow-hidden",children:e&&T?Ce.jsxs("div",{className:"h-full flex",children:[Ce.jsx("div",{className:"flex-1 bg-white m-4 rounded-lg border border-gray-200 relative overflow-auto",children:Ce.jsx("div",{className:"absolute inset-0 p-4",children:"tables"===s?Ce.jsxs("div",{className:"w-full h-full relative bg-gray-50 rounded border-2 border-dashed border-gray-300 "+(y?"bg-blue-50 border-blue-300":""),onDragOver:e=>{e.preventDefault(),e.dataTransfer.dropEffect="move"},onDrop:async e=>{if(e.preventDefault(),v(!1),p)try{const t=e.currentTarget.getBoundingClientRect(),a=e.clientX-t.left-40,s=e.clientY-t.top-40,r=t.width-80,n=t.height-80,i=Math.max(0,Math.min(a,r)),o=Math.max(0,Math.min(s,n));await Gt.posTables.update(p.id,{x:i,y:o,updatedAt:new Date,syncStatus:"pending"}),P.success("Posición de mesa actualizada")}catch(t){P.error("Error al actualizar la posición de la mesa")}finally{f(null)}},children:[null==I?void 0:I.map(e=>Ce.jsxs("div",{draggable:!0,onDragStart:t=>((e,t)=>{f(t),v(!0),e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/html","")})(t,e),className:`absolute rounded-lg border-2 cursor-move transition-all duration-200 flex items-center justify-center text-xs font-medium select-none ${q(e.status)} ${(null==p?void 0:p.id)===e.id?"opacity-50":""} hover:shadow-lg hover:scale-105`,style:{left:e.x,top:e.y,width:e.width||80,height:e.height||80},onDoubleClick:()=>E(e),title:`Mesa ${e.number} - ${e.name} (${B(e.status)}) - Arrastra para mover, doble clic para editar`,children:[Ce.jsxs("div",{className:"text-center pointer-events-none",children:[Ce.jsx("div",{className:"font-semibold",children:e.number}),Ce.jsx("div",{className:"text-xs opacity-75",children:e.name})]}),Ce.jsx("div",{className:"absolute -top-2 -right-2",children:Ce.jsx("button",{onClick:t=>{t.stopPropagation(),$(e)},className:"p-2 text-red-600 hover:bg-red-100 rounded-lg transition-colors min-w-[36px] min-h-[36px] flex items-center justify-center bg-white shadow-sm border border-gray-200",children:Ce.jsx(H,{className:"w-4 h-4"})})})]},e.id)),0===(null==I?void 0:I.length)&&Ce.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-gray-500",children:Ce.jsxs("div",{className:"text-center",children:[Ce.jsx(re,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),Ce.jsx("p",{className:"text-lg font-medium",children:"Sin mesas en este salón"}),Ce.jsx("p",{className:"text-sm",children:'Haz clic en "Nueva Mesa" para agregar una'})]})}),I&&I.length>0&&Ce.jsxs("div",{className:"absolute top-2 left-2 bg-blue-100 border border-blue-300 rounded-lg p-3 text-blue-800 text-sm max-w-xs",children:[Ce.jsx("div",{className:"font-medium mb-1",children:"💡 Cómo usar el editor:"}),Ce.jsxs("ul",{className:"text-xs space-y-1",children:[Ce.jsxs("li",{children:["• ",Ce.jsx("strong",{children:"Arrastra"})," las mesas para moverlas"]}),Ce.jsxs("li",{children:["• ",Ce.jsx("strong",{children:"Doble clic"})," para editar una mesa"]}),Ce.jsxs("li",{children:["• ",Ce.jsx("strong",{children:"Clic en ❌"})," para eliminar"]})]})]})]}):Ce.jsx("div",{className:"w-full h-full relative bg-gray-50 rounded border-2 border-dashed border-gray-300 p-4",children:Ce.jsxs("div",{className:"flex flex-wrap gap-4",children:[null==M?void 0:M.map(e=>Ce.jsxs("div",{className:"bg-purple-100 border-2 border-purple-300 rounded-lg p-4 min-w-[120px] text-center cursor-pointer hover:shadow-lg hover:scale-105 transition-all duration-200",onClick:()=>W(e),title:`Clic para cobrar la cuenta de ${e.name}`,children:[Ce.jsx(b,{className:"w-6 h-6 mx-auto mb-2 text-purple-600"}),Ce.jsx("div",{className:"font-semibold text-purple-800 text-sm",children:e.name}),Ce.jsxs("div",{className:"text-xs text-purple-600 mt-1",children:["$",e.totalAmount.toFixed(2)]})]},e.id)),0===(null==M?void 0:M.length)&&Ce.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-gray-500",children:Ce.jsxs("div",{className:"text-center",children:[Ce.jsx(b,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),Ce.jsx("p",{className:"text-lg font-medium",children:"Sin cuentas activas"}),Ce.jsx("p",{className:"text-sm",children:'Haz clic en "Nueva Cuenta" para crear una'})]})})]})})})}),Ce.jsx("div",{className:"w-80 bg-white border-l border-gray-200 overflow-auto",children:Ce.jsxs("div",{className:"p-4",children:[Ce.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:T.name}),T.description&&Ce.jsx("p",{className:"text-gray-600 mb-4",children:T.description}),"tables"===s?Ce.jsxs("div",{className:"space-y-4",children:[Ce.jsxs("div",{children:[Ce.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Estadísticas de Mesas"}),Ce.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[Ce.jsxs("div",{className:"bg-gray-50 p-2 rounded",children:[Ce.jsx("div",{className:"font-medium",children:"Total Mesas"}),Ce.jsx("div",{className:"text-lg font-bold text-primary-600",children:(null==I?void 0:I.length)||0})]}),Ce.jsxs("div",{className:"bg-green-50 p-2 rounded",children:[Ce.jsx("div",{className:"font-medium",children:"Disponibles"}),Ce.jsx("div",{className:"text-lg font-bold text-green-600",children:(null==I?void 0:I.filter(e=>"available"===e.status).length)||0})]}),Ce.jsxs("div",{className:"bg-red-50 p-2 rounded",children:[Ce.jsx("div",{className:"font-medium",children:"Ocupadas"}),Ce.jsx("div",{className:"text-lg font-bold text-red-600",children:(null==I?void 0:I.filter(e=>"occupied"===e.status).length)||0})]}),Ce.jsxs("div",{className:"bg-yellow-50 p-2 rounded",children:[Ce.jsx("div",{className:"font-medium",children:"Reservadas"}),Ce.jsx("div",{className:"text-lg font-bold text-yellow-600",children:(null==I?void 0:I.filter(e=>"reserved"===e.status).length)||0})]})]})]}),Ce.jsxs("div",{children:[Ce.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Lista de Mesas"}),Ce.jsx("div",{className:"space-y-2 max-h-96 overflow-auto",children:null==I?void 0:I.map(e=>Ce.jsx("div",{className:"border border-gray-200 rounded-lg p-3 hover:bg-gray-50 cursor-pointer",onClick:()=>E(e),children:Ce.jsxs("div",{className:"flex items-center justify-between",children:[Ce.jsxs("div",{children:[Ce.jsxs("div",{className:"font-medium",children:["Mesa ",e.number]}),Ce.jsx("div",{className:"text-sm text-gray-600",children:e.name}),Ce.jsxs("div",{className:"text-xs text-gray-500",children:["Capacidad: ",e.capacity," personas"]})]}),Ce.jsxs("div",{className:"flex items-center space-x-1",children:[Ce.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${q(e.status)}`,children:B(e.status)}),Ce.jsx("button",{onClick:t=>{t.stopPropagation(),$(e)},className:"p-2 text-red-600 hover:bg-red-100 rounded-lg transition-colors min-w-[36px] min-h-[36px] flex items-center justify-center",children:Ce.jsx(H,{className:"w-4 h-4"})})]})]})},e.id))})]})]}):Ce.jsxs("div",{className:"space-y-4",children:[Ce.jsxs("div",{children:[Ce.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Estadísticas de Cuentas"}),Ce.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[Ce.jsxs("div",{className:"bg-purple-50 p-2 rounded",children:[Ce.jsx("div",{className:"font-medium",children:"Cuentas Activas"}),Ce.jsx("div",{className:"text-lg font-bold text-purple-600",children:(null==M?void 0:M.length)||0})]}),Ce.jsxs("div",{className:"bg-green-50 p-2 rounded",children:[Ce.jsx("div",{className:"font-medium",children:"Total a Cobrar"}),Ce.jsxs("div",{className:"text-lg font-bold text-green-600",children:["$",(null==M?void 0:M.reduce((e,t)=>e+t.totalAmount,0).toFixed(2))||"0.00"]})]})]})]}),Ce.jsxs("div",{children:[Ce.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Cuentas Activas"}),Ce.jsx("div",{className:"space-y-2 max-h-96 overflow-auto",children:null==M?void 0:M.map(e=>Ce.jsx("div",{className:"border border-purple-200 rounded-lg p-3 hover:bg-purple-50 cursor-pointer",onClick:()=>W(e),children:Ce.jsxs("div",{className:"flex items-center justify-between",children:[Ce.jsxs("div",{children:[Ce.jsx("div",{className:"font-medium text-purple-800",children:e.name}),Ce.jsxs("div",{className:"text-sm text-purple-600",children:["$",e.totalAmount.toFixed(2)]}),Ce.jsxs("div",{className:"text-xs text-gray-500",children:["Creada: ",new Date(e.createdAt).toLocaleDateString()]})]}),Ce.jsxs("div",{className:"flex items-center space-x-1",children:[Ce.jsx("span",{className:"px-2 py-1 rounded text-xs font-medium bg-purple-100 text-purple-800",children:"Activa"}),Ce.jsx("button",{onClick:t=>{t.stopPropagation(),W(e)},className:"p-2 text-green-600 hover:bg-green-100 rounded-lg transition-colors min-w-[36px] min-h-[36px] flex items-center justify-center",title:"Cobrar cuenta",children:Ce.jsx(z,{className:"w-4 h-4"})})]})]})},e.id))})]})]})]})})]}):Ce.jsx("div",{className:"h-full flex items-center justify-center",children:Ce.jsxs("div",{className:"text-center",children:[Ce.jsx(j,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),Ce.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Selecciona un salón"}),Ce.jsx("p",{className:"text-gray-500 mb-4",children:0===(null==D?void 0:D.length)?"No hay salones creados. Crea tu primer salón para comenzar.":"Selecciona un salón de la lista para ver y editar sus mesas."}),0===(null==D?void 0:D.length)&&Ce.jsx("button",{onClick:()=>c(!0),className:"btn btn-primary px-6 py-4 min-h-[48px] text-base font-medium",children:"Crear Primer Salón"})]})})}),i&&Ce.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:Ce.jsxs("div",{className:"bg-white rounded-lg w-full max-w-md",children:[Ce.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[Ce.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:u?"Editar Mesa":"Nueva Mesa"}),Ce.jsx("button",{onClick:O,className:"text-gray-400 hover:text-gray-600 p-3 min-w-[44px] min-h-[44px] flex items-center justify-center rounded-lg hover:bg-gray-100 transition-colors",children:Ce.jsx(F,{className:"w-6 h-6 transform rotate-45"})})]}),Ce.jsxs("form",{onSubmit:async t=>{if(t.preventDefault(),N.number&&N.name&&N.capacity&&e)try{const t={number:N.number,name:N.name,capacity:parseInt(N.capacity),salonId:e,x:N.x,y:N.y,width:N.width,height:N.height,status:"available"};u?(await Gt.posTables.update(u.id,t),P.success("Mesa actualizada exitosamente")):(await Gt.posTables.add({...t,createdAt:new Date,updatedAt:new Date,syncStatus:"pending"}),P.success("Mesa creada exitosamente")),O()}catch(a){P.error("Error al guardar la mesa")}else P.error("Por favor completa todos los campos obligatorios")},className:"p-6 space-y-4",children:[Ce.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[Ce.jsxs("div",{children:[Ce.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Número *"}),Ce.jsx("input",{type:"text",required:!0,value:N.number,onChange:e=>w({...N,number:e.target.value}),className:"input",placeholder:"1, 2, A1..."})]}),Ce.jsxs("div",{children:[Ce.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Capacidad *"}),Ce.jsx("input",{type:"number",min:"1",required:!0,value:N.capacity,onChange:e=>w({...N,capacity:e.target.value}),className:"input",placeholder:"4"})]})]}),Ce.jsxs("div",{children:[Ce.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre *"}),Ce.jsx("input",{type:"text",required:!0,value:N.name,onChange:e=>w({...N,name:e.target.value}),className:"input",placeholder:"Mesa junto a la ventana"})]}),Ce.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[Ce.jsxs("div",{children:[Ce.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ancho (px)"}),Ce.jsx("input",{type:"number",min:"40",max:"200",value:N.width,onChange:e=>w({...N,width:parseInt(e.target.value)}),className:"input"})]}),Ce.jsxs("div",{children:[Ce.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Alto (px)"}),Ce.jsx("input",{type:"number",min:"40",max:"200",value:N.height,onChange:e=>w({...N,height:parseInt(e.target.value)}),className:"input"})]})]}),Ce.jsxs("div",{className:"flex space-x-3 pt-4",children:[Ce.jsx("button",{type:"button",onClick:O,className:"flex-1 btn btn-secondary px-6 py-4 min-h-[48px] text-base font-medium",children:"Cancelar"}),Ce.jsx("button",{type:"submit",className:"flex-1 btn btn-primary px-6 py-4 min-h-[48px] text-base font-medium",children:u?"Actualizar":"Crear"})]})]})]})}),l&&Ce.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:Ce.jsxs("div",{className:"bg-white rounded-lg w-full max-w-md",children:[Ce.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[Ce.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:h?"Editar Salón":"Nuevo Salón"}),Ce.jsx("button",{onClick:R,className:"text-gray-400 hover:text-gray-600 p-3 min-w-[44px] min-h-[44px] flex items-center justify-center rounded-lg hover:bg-gray-100 transition-colors",children:Ce.jsx(F,{className:"w-6 h-6 transform rotate-45"})})]}),Ce.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),C.name)try{const e={name:C.name,description:C.description||void 0,isActive:!0};if(h)await Gt.salons.update(h.id,e),P.success("Salón actualizado exitosamente");else{const a=await Gt.salons.add({...e,createdAt:new Date,updatedAt:new Date,syncStatus:"pending"});t(a),P.success("Salón creado exitosamente")}R()}catch(a){P.error("Error al guardar el salón")}else P.error("El nombre del salón es obligatorio")},className:"p-6 space-y-4",children:[Ce.jsxs("div",{children:[Ce.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre *"}),Ce.jsx("input",{type:"text",required:!0,value:C.name,onChange:e=>k({...C,name:e.target.value}),className:"input",placeholder:"Salón principal, Terraza..."})]}),Ce.jsxs("div",{children:[Ce.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descripción"}),Ce.jsx("textarea",{rows:3,value:C.description,onChange:e=>k({...C,description:e.target.value}),className:"input resize-none",placeholder:"Descripción del salón (opcional)"})]}),Ce.jsxs("div",{className:"flex space-x-3 pt-4",children:[Ce.jsx("button",{type:"button",onClick:R,className:"flex-1 btn btn-secondary px-6 py-4 min-h-[48px] text-base font-medium",children:"Cancelar"}),Ce.jsx("button",{type:"submit",className:"flex-1 btn btn-primary px-6 py-4 min-h-[48px] text-base font-medium",children:h?"Actualizar":"Crear"})]})]})]})}),d&&Ce.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:Ce.jsxs("div",{className:"bg-white rounded-lg w-full max-w-md",children:[Ce.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[Ce.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Nueva Cuenta por Nombre"}),Ce.jsx("button",{onClick:L,className:"text-gray-400 hover:text-gray-600 p-3 min-w-[44px] min-h-[44px] flex items-center justify-center rounded-lg hover:bg-gray-100 transition-colors",children:Ce.jsx(F,{className:"w-6 h-6 transform rotate-45"})})]}),Ce.jsxs("form",{onSubmit:async t=>{if(t.preventDefault(),A.name&&e)try{await Gt.namedAccounts.add({name:A.name,salonId:e,status:"active",totalAmount:0,createdAt:new Date,updatedAt:new Date,syncStatus:"pending"}),P.success("Cuenta creada exitosamente"),L()}catch(a){P.error("Error al crear la cuenta")}else P.error("Por favor ingresa un nombre para la cuenta")},className:"p-6 space-y-4",children:[Ce.jsxs("div",{children:[Ce.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre del Cliente *"}),Ce.jsx("input",{type:"text",required:!0,value:A.name,onChange:e=>S({...A,name:e.target.value}),className:"input",placeholder:"Juan Pérez, María García...",autoFocus:!0})]}),Ce.jsxs("div",{className:"flex space-x-3 pt-4",children:[Ce.jsx("button",{type:"button",onClick:L,className:"flex-1 btn btn-secondary px-6 py-4 min-h-[48px] text-base font-medium",children:"Cancelar"}),Ce.jsx("button",{type:"submit",className:"flex-1 btn btn-primary px-6 py-4 min-h-[48px] text-base font-medium",style:{backgroundColor:"#9333ea",borderColor:"#9333ea"},children:"Crear Cuenta"})]})]})]})})]})},Da=()=>{const[e,t]=a.useState(""),s=new Date,r=`${s.getFullYear()}-${String(s.getMonth()+1).padStart(2,"0")}-${String(s.getDate()).padStart(2,"0")}`,[i,o]=a.useState("paid"),[l,c]=a.useState(r),[d,m]=a.useState(null),u=n(),x=he(async()=>{try{let t=Gt.orders.toCollection();if(i&&(t=t.filter(e=>e.status===i)),l){const e=new Date(l),a=new Date(e.getTime()+864e5);t=t.filter(t=>t.createdAt>=e&&t.createdAt<a)}if(e){const a=e.toLowerCase();t=t.filter(t=>{var s,r;return(null==(s=t.customerName)?void 0:s.toLowerCase().includes(a))||(null==(r=t.waiterName)?void 0:r.toLowerCase().includes(a))||String(t.id??"").includes(e)})}return await t.reverse().sortBy("createdAt")}catch(t){return[]}},[i,l,e])||[],g=he(()=>Gt.posTables.toArray())||[],p=e=>{switch(e){case"pending":return"bg-yellow-100 text-yellow-800";case"confirmed":return"bg-blue-100 text-blue-800";case"preparing":return"bg-purple-100 text-purple-800";case"ready":return"bg-orange-100 text-orange-800";case"delivered":return"bg-green-100 text-green-800";case"paid":return"bg-emerald-100 text-emerald-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},f=e=>{switch(e){case"pending":return"Pendiente";case"confirmed":return"Confirmado";case"preparing":return"Preparando";case"ready":return"Listo";case"delivered":return"Entregado";case"paid":return"Pagado";case"cancelled":return"Cancelado";default:return e}},y=e=>{if(!e)return"Para llevar";const t=null==g?void 0:g.find(t=>t.id===e);return t?`Mesa ${t.number} - ${t.name}`:`Mesa ${e}`};return Ce.jsxs("div",{className:"h-full flex bg-gray-50",children:[Ce.jsxs("div",{className:"w-1/2 flex flex-col border-r border-gray-200",children:[Ce.jsxs("div",{className:"bg-white border-b border-gray-200 p-6",children:[Ce.jsx("div",{className:"flex items-center justify-between mb-4",children:Ce.jsxs("div",{className:"flex items-center space-x-3",children:[Ce.jsx(A,{className:"w-6 h-6 text-primary-600"}),Ce.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Pedidos"})]})}),Ce.jsxs("div",{className:"space-y-3",children:[Ce.jsxs("div",{className:"relative",children:[Ce.jsx(T,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),Ce.jsx("input",{type:"text",placeholder:"Buscar por cliente, mesero o ID...",value:e,onChange:e=>t(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),Ce.jsxs("div",{className:"flex space-x-3",children:[Ce.jsxs("select",{value:i,onChange:e=>o(e.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[Ce.jsx("option",{value:"",children:"Todos los estados"}),Ce.jsx("option",{value:"pending",children:"Pendiente"}),Ce.jsx("option",{value:"confirmed",children:"Confirmado"}),Ce.jsx("option",{value:"preparing",children:"Preparando"}),Ce.jsx("option",{value:"ready",children:"Listo"}),Ce.jsx("option",{value:"delivered",children:"Entregado"}),Ce.jsx("option",{value:"paid",children:"Pagado"}),Ce.jsx("option",{value:"cancelled",children:"Cancelado"})]}),Ce.jsx("input",{type:"date",value:l,onChange:e=>c(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]})]})]}),Ce.jsxs("div",{className:"flex-1 overflow-auto",children:[x.length>0&&x.map(e=>Ce.jsxs("div",{onClick:()=>m(e),className:"border-b border-gray-200 p-4 cursor-pointer hover:bg-gray-50 transition-colors "+((null==d?void 0:d.id)===e.id?"bg-primary-50 border-primary-200":"bg-white"),children:[Ce.jsxs("div",{className:"flex items-center justify-between mb-2",children:[Ce.jsxs("div",{className:"flex items-center space-x-2",children:[Ce.jsxs("span",{className:"font-semibold text-gray-900",children:["Pedido #",e.id]}),Ce.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${p(e.status)}`,children:f(e.status)})]}),Ce.jsxs("div",{className:"text-lg font-bold text-primary-600",children:["$",e.total.toFixed(2)]})]}),Ce.jsxs("div",{className:"space-y-1 text-sm text-gray-600",children:[Ce.jsxs("div",{className:"flex items-center space-x-1",children:[Ce.jsx(h,{className:"w-4 h-4"}),Ce.jsx("span",{children:St(e.createdAt,"dd/MM/yyyy HH:mm",{locale:Mt})})]}),e.customerName&&Ce.jsxs("div",{className:"flex items-center space-x-1",children:[Ce.jsx(b,{className:"w-4 h-4"}),Ce.jsx("span",{children:e.customerName})]}),Ce.jsxs("div",{className:"flex items-center space-x-1",children:[Ce.jsx(O,{className:"w-4 h-4"}),Ce.jsx("span",{children:y(e.tableId)})]}),Ce.jsxs("div",{className:"text-xs text-gray-500",children:[e.items.length," producto(s) • ",e.waiterName]})]})]},e.id)),0===x.length&&Ce.jsx("div",{className:"flex items-center justify-center h-64",children:Ce.jsxs("div",{className:"text-center",children:[Ce.jsx(A,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),Ce.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No hay pedidos"}),Ce.jsx("p",{className:"text-gray-500",children:e||i||l?"No se encontraron pedidos con los filtros aplicados":"Los pedidos aparecerán aquí"})]})})]})]}),Ce.jsx("div",{className:"flex-1 flex flex-col",children:d?Ce.jsxs(Ce.Fragment,{children:[Ce.jsxs("div",{className:"bg-white border-b border-gray-200 p-6",children:[Ce.jsxs("div",{className:"flex items-center justify-between mb-4",children:[Ce.jsxs("h2",{className:"text-xl font-semibold text-gray-900",children:["Pedido #",d.id]}),Ce.jsxs("div",{className:"flex items-center space-x-2",children:[Ce.jsxs("select",{value:d.status,onChange:e=>(async(e,t)=>{try{if(await Gt.orders.update(e,{status:t,updatedAt:new Date}),(null==d?void 0:d.id)===e){const t=await Gt.orders.get(e);m(t||null)}}catch(a){}})(d.id,e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[Ce.jsx("option",{value:"pending",children:"Pendiente"}),Ce.jsx("option",{value:"confirmed",children:"Confirmado"}),Ce.jsx("option",{value:"preparing",children:"Preparando"}),Ce.jsx("option",{value:"ready",children:"Listo"}),Ce.jsx("option",{value:"delivered",children:"Entregado"}),Ce.jsx("option",{value:"paid",children:"Pagado"}),Ce.jsx("option",{value:"cancelled",children:"Cancelado"})]}),Ce.jsx("button",{onClick:()=>{(null==d?void 0:d.id)&&(localStorage.setItem("orderToEdit",String(d.id)),u("/"))},className:"px-3 py-2 rounded-lg border border-primary-500 text-primary-700 hover:bg-primary-50",title:"Editar este ticket en el Dashboard",children:"Editar en Dashboard"})]})]}),Ce.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[Ce.jsxs("div",{children:[Ce.jsxs("div",{className:"flex items-center space-x-1 text-gray-600 mb-1",children:[Ce.jsx(h,{className:"w-4 h-4"}),Ce.jsx("span",{children:"Creado:"})]}),Ce.jsx("div",{className:"font-medium",children:St(d.createdAt,"dd/MM/yyyy HH:mm",{locale:Mt})})]}),Ce.jsxs("div",{children:[Ce.jsxs("div",{className:"flex items-center space-x-1 text-gray-600 mb-1",children:[Ce.jsx(O,{className:"w-4 h-4"}),Ce.jsx("span",{children:"Ubicación:"})]}),Ce.jsx("div",{className:"font-medium",children:y(d.tableId)})]}),d.customerName&&Ce.jsxs("div",{children:[Ce.jsxs("div",{className:"flex items-center space-x-1 text-gray-600 mb-1",children:[Ce.jsx(b,{className:"w-4 h-4"}),Ce.jsx("span",{children:"Cliente:"})]}),Ce.jsx("div",{className:"font-medium",children:d.customerName})]}),Ce.jsxs("div",{children:[Ce.jsxs("div",{className:"flex items-center space-x-1 text-gray-600 mb-1",children:[Ce.jsx(b,{className:"w-4 h-4"}),Ce.jsx("span",{children:"Mesero:"})]}),Ce.jsx("div",{className:"font-medium",children:d.waiterName})]})]})]}),Ce.jsxs("div",{className:"flex-1 overflow-auto p-6",children:[Ce.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Productos"}),Ce.jsx("div",{className:"space-y-3",children:d.items.map((e,t)=>Ce.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:Ce.jsxs("div",{className:"flex items-start justify-between",children:[Ce.jsxs("div",{className:"flex-1",children:[Ce.jsx("h4",{className:"font-medium text-gray-900",children:e.productName}),e.notes&&Ce.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Nota: ",e.notes]}),Ce.jsxs("div",{className:"flex items-center space-x-4 mt-2 text-sm text-gray-500",children:[Ce.jsxs("span",{children:["Cantidad: ",e.quantity]}),Ce.jsxs("span",{children:["Precio unitario: $",e.unitPrice.toFixed(2)]}),Ce.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${p(e.status)}`,children:f(e.status)})]})]}),Ce.jsxs("div",{className:"text-lg font-semibold text-primary-600",children:["$",e.totalPrice.toFixed(2)]})]})},t))})]}),Ce.jsxs("div",{className:"bg-white border-t border-gray-200 p-6",children:[Ce.jsxs("div",{className:"space-y-2",children:[Ce.jsxs("div",{className:"flex justify-between text-sm",children:[Ce.jsx("span",{children:"Subtotal:"}),Ce.jsxs("span",{children:["$",d.subtotal.toFixed(2)]})]}),Ce.jsxs("div",{className:"flex justify-between text-sm",children:[Ce.jsx("span",{children:"IVA:"}),Ce.jsxs("span",{children:["$",d.tax.toFixed(2)]})]}),d.discount>0&&Ce.jsxs("div",{className:"flex justify-between text-sm text-red-600",children:[Ce.jsx("span",{children:"Descuento:"}),Ce.jsxs("span",{children:["-$",d.discount.toFixed(2)]})]}),Ce.jsxs("div",{className:"flex justify-between text-lg font-semibold border-t pt-2",children:[Ce.jsx("span",{children:"Total:"}),Ce.jsxs("span",{className:"text-primary-600",children:["$",d.total.toFixed(2)]})]})]}),d.notes&&Ce.jsxs("div",{className:"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:[Ce.jsx("div",{className:"text-sm font-medium text-yellow-800 mb-1",children:"Notas del pedido:"}),Ce.jsx("div",{className:"text-sm text-yellow-700",children:d.notes})]})]})]}):Ce.jsx("div",{className:"flex-1 flex items-center justify-center",children:Ce.jsxs("div",{className:"text-center",children:[Ce.jsx(ee,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),Ce.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Selecciona un pedido"}),Ce.jsx("p",{className:"text-gray-500",children:"Haz clic en un pedido para ver sus detalles"})]})})})]})},Pa=({isOpen:e,onClose:t,onSave:s,incentive:r=null,title:n="Agregar Incentivo de Saldo"})=>{const{getCurrencySymbol:i}=Qt(),o=i(),[l,c]=a.useState({customerPayment:"",totalBalance:"",isActive:!0}),[d,m]=a.useState({});a.useEffect(()=>{c(r?{customerPayment:r.customerPayment.toString(),totalBalance:r.totalBalance.toString(),isActive:r.isActive}:{customerPayment:"",totalBalance:"",isActive:!0}),m({})},[r,e]);const u=(e,t)=>{c(a=>({...a,[e]:t})),d[e]&&m(t=>({...t,[e]:""}))},x=l.customerPayment&&l.totalBalance?parseFloat(l.totalBalance)-parseFloat(l.customerPayment):0,h=l.customerPayment&&x>0?(x/parseFloat(l.customerPayment)*100).toFixed(1):"0";return e?Ce.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:Ce.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[Ce.jsx("div",{className:"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75",onClick:t}),Ce.jsxs("div",{className:"inline-block w-full max-w-md my-8 overflow-hidden text-left align-middle transition-all transform bg-white shadow-xl rounded-lg",children:[Ce.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 bg-gradient-to-r from-green-50 to-emerald-50",children:[Ce.jsxs("div",{className:"flex items-center space-x-3",children:[Ce.jsx(C,{className:"w-6 h-6 text-green-600"}),Ce.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:n})]}),Ce.jsx("button",{onClick:t,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:Ce.jsx(S,{className:"w-5 h-5"})})]}),Ce.jsxs("form",{onSubmit:e=>{if(e.preventDefault(),!(()=>{const e={};return(!l.customerPayment||parseFloat(l.customerPayment)<=0)&&(e.customerPayment="El monto que paga el cliente debe ser mayor a 0"),(!l.totalBalance||parseFloat(l.totalBalance)<=0)&&(e.totalBalance="El saldo total debe ser mayor a 0"),parseFloat(l.totalBalance)<=parseFloat(l.customerPayment)&&(e.totalBalance="El saldo total debe ser mayor al monto pagado"),m(e),0===Object.keys(e).length})())return;const a={customerPayment:parseFloat(l.customerPayment),totalBalance:parseFloat(l.totalBalance),bonusAmount:parseFloat(l.totalBalance)-parseFloat(l.customerPayment),isActive:l.isActive};s(a),t()},className:"p-6 space-y-6",children:[Ce.jsxs("div",{children:[Ce.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Monto que paga el cliente"}),Ce.jsxs("div",{className:"relative",children:[Ce.jsx(z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),Ce.jsx("input",{type:"number",step:"0.01",min:"0",value:l.customerPayment,onChange:e=>u("customerPayment",e.target.value),className:"w-full pl-10 pr-4 py-3 border rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 transition-colors "+(d.customerPayment?"border-red-300":"border-gray-300"),placeholder:"0.00"})]}),d.customerPayment&&Ce.jsx("p",{className:"mt-1 text-sm text-red-600",children:d.customerPayment})]}),Ce.jsxs("div",{children:[Ce.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Saldo total que recibe"}),Ce.jsxs("div",{className:"relative",children:[Ce.jsx(z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),Ce.jsx("input",{type:"number",step:"0.01",min:"0",value:l.totalBalance,onChange:e=>u("totalBalance",e.target.value),className:"w-full pl-10 pr-4 py-3 border rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 transition-colors "+(d.totalBalance?"border-red-300":"border-gray-300"),placeholder:"0.00"})]}),d.totalBalance&&Ce.jsx("p",{className:"mt-1 text-sm text-red-600",children:d.totalBalance})]}),l.customerPayment&&l.totalBalance&&x>0&&Ce.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 border border-green-200 rounded-lg p-4",children:[Ce.jsx("h3",{className:"text-sm font-semibold text-green-800 mb-2",children:"Resumen del Incentivo"}),Ce.jsxs("div",{className:"space-y-2 text-sm",children:[Ce.jsxs("div",{className:"flex justify-between",children:[Ce.jsx("span",{className:"text-gray-600",children:"Paga el cliente:"}),Ce.jsxs("span",{className:"font-medium",children:[o,parseFloat(l.customerPayment).toFixed(2)]})]}),Ce.jsxs("div",{className:"flex justify-between",children:[Ce.jsx("span",{className:"text-gray-600",children:"Recibe como saldo:"}),Ce.jsxs("span",{className:"font-medium",children:[o,parseFloat(l.totalBalance).toFixed(2)]})]}),Ce.jsxs("div",{className:"flex justify-between border-t border-green-200 pt-2",children:[Ce.jsx("span",{className:"text-green-700 font-medium",children:"Regalo:"}),Ce.jsxs("span",{className:"text-green-700 font-bold",children:[o,x.toFixed(2)," (",h,"%)"]})]})]})]}),Ce.jsxs("div",{className:"flex items-center",children:[Ce.jsx("input",{type:"checkbox",id:"isActive",checked:l.isActive,onChange:e=>c(t=>({...t,isActive:e.target.checked})),className:"h-4 w-4 text-green-600 focus:ring-green-500 border-gray-300 rounded"}),Ce.jsx("label",{htmlFor:"isActive",className:"ml-2 block text-sm text-gray-700",children:"Incentivo activo"})]}),Ce.jsxs("div",{className:"flex space-x-3 pt-4",children:[Ce.jsx("button",{type:"button",onClick:t,className:"flex-1 px-4 py-3 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors font-medium",children:"Cancelar"}),Ce.jsxs("button",{type:"submit",className:"flex-1 px-4 py-3 bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 text-white rounded-lg font-medium flex items-center justify-center space-x-2 transition-all duration-200 hover:shadow-lg",children:[Ce.jsx(X,{className:"w-4 h-4"}),Ce.jsx("span",{children:"Guardar"})]})]})]})]})]})}):null},Ia=()=>{const[e,t]=a.useState("general"),s=i(),[r,n]=a.useState(!1),[o,l]=a.useState(null),[c,d]=a.useState(""),{customers:m,addCustomer:u,updateCustomer:x,deleteCustomer:h,searchCustomers:g}=Yt(),[p,b]=a.useState(!1),[f,y]=a.useState(null),[v,j]=a.useState(!1),[N,k]=a.useState(null),{allIncentives:A,addIncentive:S,updateIncentive:D,deleteIncentive:I}=ga();a.useEffect(()=>{s.pathname.includes("/configuration/salons")||s.pathname.includes("/tables")?t("salons"):s.pathname.includes("/configuration/modifiers")||s.pathname.includes("/modifiers")?t("modifiers"):s.pathname.includes("/customers")?t("customers"):s.pathname.includes("/configuration/incentives")?t("incentives"):t("general")},[s.pathname]);const{salons:O,activeSalonId:z,setActiveSalon:R,addSalon:W,removeSalon:L,renameSalon:q,tables:B,decor:G,addTable:U,removeTable:Y,updateTablePosition:_,updateTableRotation:J,addDecor:V,updateDecorPosition:Q,updateDecorRotation:K}=Wt(),{categories:Z}=xa(),{config:ee,updateConfig:ae,getModifiersForCategory:se,updateCategoryModifiers:re}=Qt(),[oe,le]=a.useState(ee);a.useEffect(()=>{le(ee)},[ee]);const ce=()=>{ae(oe),P.success("Configuración guardada exitosamente")},de=g(c),me=()=>{k(null),j(!0)};return Ce.jsxs("div",{className:"h-full bg-gray-50",children:[Ce.jsxs("div",{className:"h-full overflow-hidden",children:["general"===e&&Ce.jsx("div",{className:"h-full overflow-y-auto p-6",children:Ce.jsx("div",{className:"space-y-6",children:Ce.jsxs("div",{className:"card p-6",children:[Ce.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Información del Restaurante"}),Ce.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[Ce.jsxs("div",{children:[Ce.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nombre del Restaurante"}),Ce.jsx("input",{type:"text",value:oe.restaurantName,onChange:e=>le({...oe,restaurantName:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),Ce.jsxs("div",{children:[Ce.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Moneda"}),Ce.jsxs("select",{value:oe.currency,onChange:e=>le({...oe,currency:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[Ce.jsx("option",{value:"MXN",children:"Peso Mexicano (MXN)"}),Ce.jsx("option",{value:"USD",children:"Dólar Americano (USD)"}),Ce.jsx("option",{value:"EUR",children:"Euro (EUR)"})]})]}),Ce.jsxs("div",{children:[Ce.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tasa de IVA (%)"}),Ce.jsx("input",{type:"number",min:"0",max:"100",step:"0.01",value:100*oe.taxRate,onChange:e=>{const t=Math.max(0,Math.min(100,parseFloat(e.target.value)));le({...oe,taxRate:t/100})},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]})]}),Ce.jsx("div",{className:"mt-6",children:Ce.jsxs("button",{onClick:ce,className:"btn btn-primary flex items-center space-x-2",children:[Ce.jsx(X,{className:"w-4 h-4"}),Ce.jsx("span",{children:"Guardar Cambios"})]})})]})})}),"modifiers"===e&&Ce.jsx("div",{className:"h-full overflow-y-auto p-6",children:Ce.jsx("div",{className:"space-y-6",children:Ce.jsxs("div",{className:"card p-6",children:[Ce.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Modificadores"}),Ce.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[Ce.jsxs("div",{children:[Ce.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Modificadores globales"}),Ce.jsx(Ta,{value:(null==(ue=oe.modifiers)?void 0:ue.global)||[],onChange:e=>{var t;return le({...oe,modifiers:{global:e,byCategory:(null==(t=oe.modifiers)?void 0:t.byCategory)||{}}})},placeholder:"Escribe y presiona Enter"})]}),Ce.jsxs("div",{children:[Ce.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Modificadores por categoría"}),Ce.jsx("div",{className:"space-y-4 max-h-72 overflow-y-auto pr-2",children:Z.map(e=>{var t,a;return Ce.jsxs("div",{className:"border rounded-lg p-3",children:[Ce.jsx("div",{className:"text-sm font-medium mb-2",style:{color:e.color},children:e.name}),Ce.jsx(Ta,{value:(null==(a=null==(t=oe.modifiers)?void 0:t.byCategory)?void 0:a[e.id])||[],onChange:t=>{var a,s;return le({...oe,modifiers:{global:(null==(a=oe.modifiers)?void 0:a.global)||[],byCategory:{...(null==(s=oe.modifiers)?void 0:s.byCategory)||{},[e.id]:t}}})},placeholder:`Añadir modificadores para ${e.name}`})]},e.id)})})]})]}),Ce.jsx("div",{className:"mt-4",children:Ce.jsx("button",{onClick:()=>{ae({modifiers:oe.modifiers}),P.success("Modificadores guardados")},className:"btn btn-primary",children:"Guardar Modificadores"})})]})})}),"customers"===e&&Ce.jsx("div",{className:"h-full overflow-y-auto p-6",children:Ce.jsx("div",{className:"space-y-6",children:Ce.jsxs("div",{className:"card p-6",children:[Ce.jsxs("div",{className:"flex items-center justify-between mb-6",children:[Ce.jsxs("div",{children:[Ce.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Gestión de Clientes"}),Ce.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Administra la información de tus clientes"})]}),Ce.jsxs("button",{onClick:()=>{l(null),n(!0)},className:"btn btn-primary flex items-center space-x-2",children:[Ce.jsx(F,{className:"w-4 h-4"}),Ce.jsx("span",{children:"Nuevo Cliente"})]})]}),Ce.jsx("div",{className:"mb-6",children:Ce.jsxs("div",{className:"relative",children:[Ce.jsx(T,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),Ce.jsx("input",{type:"text",placeholder:"Buscar por nombre, email, teléfono o código de tarjeta...",value:c,onChange:e=>d(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})}),0===de.length?Ce.jsxs("div",{className:"text-center py-12",children:[Ce.jsx(w,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),Ce.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"No hay clientes registrados"}),Ce.jsx("p",{className:"text-gray-600 mb-4",children:"Comienza agregando tu primer cliente"}),Ce.jsxs("button",{onClick:()=>{l(null),n(!0)},className:"btn btn-primary inline-flex items-center space-x-2",children:[Ce.jsx(F,{className:"w-4 h-4"}),Ce.jsx("span",{children:"Agregar Cliente"})]})]}):Ce.jsxs("div",{className:"space-y-4",children:[Ce.jsxs("div",{className:"text-sm text-gray-600 mb-4",children:[de.length," cliente",1!==de.length?"s":""," encontrado",1!==de.length?"s":"",c&&m.length!==de.length&&Ce.jsxs("span",{className:"text-blue-600",children:[" de ",m.length," total"]})]}),Ce.jsx("div",{className:"grid gap-4",children:de.map(e=>Ce.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:[Ce.jsxs("div",{className:"flex items-center justify-between",children:[Ce.jsx("div",{className:"flex-1",children:Ce.jsxs("div",{className:"flex items-center space-x-3",children:[Ce.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:Ce.jsx(w,{className:"w-5 h-5 text-blue-600"})}),Ce.jsxs("div",{children:[Ce.jsxs("h4",{className:"font-medium text-gray-900",children:[e.name," ",e.lastName]}),Ce.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-600 mt-1",children:[e.email&&Ce.jsxs("div",{className:"flex items-center space-x-1",children:[Ce.jsx(M,{className:"w-3 h-3"}),Ce.jsx("span",{children:e.email})]}),e.phone&&Ce.jsxs("div",{className:"flex items-center space-x-1",children:[Ce.jsx(E,{className:"w-3 h-3"}),Ce.jsx("span",{children:e.phone})]}),e.cardCode&&Ce.jsxs("div",{className:"flex items-center space-x-1",children:[Ce.jsx($,{className:"w-3 h-3"}),Ce.jsx("span",{children:e.cardCode})]})]})]})]})}),Ce.jsxs("div",{className:"flex items-center space-x-4",children:[Ce.jsxs("div",{className:"text-right",children:[Ce.jsx("div",{className:"text-sm text-gray-500",children:"Saldo"}),Ce.jsxs("div",{className:"font-semibold "+(e.balance>0?"text-green-600":"text-gray-600"),children:["€",e.balance.toFixed(2)]})]}),Ce.jsxs("div",{className:"flex items-center space-x-2",children:[Ce.jsx("button",{onClick:()=>{l(e),n(!0)},className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Editar cliente",children:Ce.jsx(te,{className:"w-4 h-4"})}),Ce.jsx("button",{onClick:()=>{y(e),b(!0)},className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Eliminar cliente",children:Ce.jsx(H,{className:"w-4 h-4"})})]})]})]}),e.notes&&Ce.jsx("div",{className:"mt-3 p-3 bg-gray-50 rounded-lg",children:Ce.jsxs("div",{className:"text-sm text-gray-600",children:[Ce.jsx("strong",{children:"Notas:"})," ",e.notes]})})]},e.id))})]})]})})}),"incentives"===e&&Ce.jsx("div",{className:"h-full overflow-y-auto p-6",children:(()=>{const{getCurrencySymbol:e}=Qt(),t=e();return Ce.jsx("div",{className:"space-y-6",children:Ce.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[Ce.jsxs("div",{className:"flex items-center justify-between mb-6",children:[Ce.jsxs("div",{children:[Ce.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Incentivos de Saldo"}),Ce.jsx("p",{className:"text-gray-600 mt-1",children:"Configura los incentivos que ofreces al recargar saldo"})]}),Ce.jsxs("button",{onClick:me,className:"bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 text-white px-4 py-2 rounded-lg flex items-center space-x-2 transition-colors",children:[Ce.jsx(F,{className:"w-4 h-4"}),Ce.jsx("span",{children:"Agregar Incentivo"})]})]}),0===A.length?Ce.jsxs("div",{className:"text-center py-8",children:[Ce.jsx("div",{className:"text-gray-400 mb-4",children:Ce.jsx(C,{className:"w-16 h-16 mx-auto"})}),Ce.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No hay incentivos configurados"}),Ce.jsx("p",{className:"text-gray-600 mb-4",children:"Crea tu primer incentivo para ofrecer regalos al recargar saldo"}),Ce.jsx("button",{onClick:me,className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg",children:"Crear Primer Incentivo"})]}):Ce.jsx("div",{className:"overflow-x-auto",children:Ce.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[Ce.jsx("thead",{className:"bg-gray-50",children:Ce.jsxs("tr",{children:[Ce.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Paga Cliente"}),Ce.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Recibe Saldo"}),Ce.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Regalo"}),Ce.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Estado"}),Ce.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Acciones"})]})}),Ce.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:A.map(e=>Ce.jsxs("tr",{className:"hover:bg-gray-50",children:[Ce.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:[t,e.customerPayment.toFixed(2)]}),Ce.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[t,e.totalBalance.toFixed(2)]}),Ce.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-green-600 font-medium",children:["+",t,e.bonusAmount.toFixed(2)," (",(e.bonusAmount/e.customerPayment*100).toFixed(1),"%)"]}),Ce.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:Ce.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full "+(e.isActive?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"),children:e.isActive?"Activo":"Inactivo"})}),Ce.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:Ce.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[Ce.jsx("button",{onClick:()=>(e=>{k(e),j(!0)})(e),className:"text-blue-600 hover:text-blue-900 p-1 rounded hover:bg-blue-50",title:"Editar",children:Ce.jsx(te,{className:"w-4 h-4"})}),Ce.jsx("button",{onClick:()=>(async e=>{try{await I(e.id)}catch(t){}})(e),className:"text-red-600 hover:text-red-900 p-1 rounded hover:bg-red-50",title:"Eliminar",children:Ce.jsx(H,{className:"w-4 h-4"})})]})})]},e.id))})]})})]})})})()}),"salons"===e&&Ce.jsx("div",{className:"h-full",children:(()=>{const e=O.find(e=>e.id===z),t=(e,t)=>{J(e.id,t)},a=(e,t)=>{K(e.id,t)};return Ce.jsxs("div",{className:"h-full flex flex-col",children:[Ce.jsxs("div",{className:"p-6 border-b border-gray-200",children:[Ce.jsxs("div",{className:"flex items-center justify-between mb-4",children:[Ce.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Editor de Salones"}),Ce.jsxs("button",{onClick:()=>{const e=prompt("Nombre del nuevo salón:");(null==e?void 0:e.trim())&&(W(e.trim()),P.success(`Salón "${e}" creado`))},className:"btn btn-primary flex items-center space-x-2",children:[Ce.jsx(F,{className:"w-4 h-4"}),Ce.jsx("span",{children:"Nuevo Salón"})]})]}),Ce.jsxs("div",{className:"flex items-center space-x-4",children:[Ce.jsx("select",{value:z,onChange:e=>R(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500",children:O.map(e=>Ce.jsx("option",{value:e.id,children:e.name},e.id))}),Ce.jsxs("div",{className:"flex space-x-2",children:[Ce.jsxs("button",{onClick:()=>{const e={id:`table-${Date.now()}`,number:"1",name:"",status:"available",x:100,y:100,capacity:4};U(e),P.success("Mesa agregada")},className:"btn btn-secondary flex items-center space-x-1",children:[Ce.jsx(F,{className:"w-4 h-4"}),Ce.jsx("span",{children:"Mesa"})]}),Ce.jsxs("button",{onClick:()=>{const e={id:`decor-${Date.now()}`,kind:"plant",x:150,y:150};V(e),P.success("Planta agregada")},className:"btn btn-secondary flex items-center space-x-1",children:[Ce.jsx(ne,{className:"w-4 h-4"}),Ce.jsx("span",{children:"Planta"})]}),Ce.jsxs("button",{onClick:()=>{const e={id:`decor-${Date.now()}`,kind:"bar",x:200,y:200};V(e),P.success("Barra agregada")},className:"btn btn-secondary flex items-center space-x-1",children:[Ce.jsx(ie,{className:"w-4 h-4"}),Ce.jsx("span",{children:"Barra"})]})]})]})]}),e&&Ce.jsx("div",{className:"flex-1 overflow-hidden",children:Ce.jsxs("div",{className:"salon-canvas h-full bg-gray-100 relative overflow-auto",style:{minHeight:"600px"},children:[B.map(e=>Ce.jsx(Lt,{table:e,isDraggable:!0,onDragEnd:(e,t,a)=>((e,t,a)=>{_(e,t,a)})(e.id,t,a),onRotationChange:t,onDelete:()=>{return t=e.id,void(Y(t)?P.success("Mesa eliminada"):P.error("No se puede eliminar una mesa ocupada"));var t},showDeleteButton:!0,scale:1},e.id)),G.map(e=>Ce.jsx(qt,{item:e,isDraggable:!0,onDragEnd:(t,a,s)=>Q(e.id,a,s),onRotationChange:a},e.id))]})})]})})()})]}),Ce.jsx(ba,{isOpen:r,onClose:()=>n(!1),customer:o,onSave:async e=>{try{e.id?await x(e.id,e):await u(e)}catch(t){}}}),Ce.jsx(da,{isOpen:p,onClose:()=>b(!1),onConfirm:async()=>{if(f)try{await h(f.id),y(null),b(!1)}catch(e){}},title:"Eliminar Cliente",message:`¿Estás seguro de que deseas eliminar al cliente "${null==f?void 0:f.name} ${null==f?void 0:f.lastName}"? Esta acción no se puede deshacer.`,type:"danger"}),Ce.jsx(Pa,{isOpen:v,onClose:()=>j(!1),onSave:async e=>{try{N?await D(N.id,e):await S(e)}catch(t){}},incentive:N,title:N?"Editar Incentivo de Saldo":"Agregar Incentivo de Saldo"})]});var ue},Ta=({value:e,onChange:t,placeholder:s})=>{const[r,n]=a.useState("");return Ce.jsxs("div",{children:[Ce.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:e.map(a=>Ce.jsxs("span",{className:"inline-flex items-center text-xs bg-blue-50 text-blue-700 px-2 py-1 rounded",children:[a,Ce.jsx("button",{onClick:()=>(a=>{t(e.filter(e=>e!==a))})(a),className:"ml-1 text-blue-500 hover:text-blue-700",children:"×"})]},a))}),Ce.jsx("input",{type:"text",value:r,onChange:e=>n(e.target.value),onKeyDown:a=>{"Enter"===a.key&&(a.preventDefault(),(a=>{const s=a.trim();if(!s)return;const r=Array.from(new Set([...e,s]));t(r),n("")})(r))},placeholder:s||"Añadir...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"}),Ce.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Pulsa Enter para agregar"})]})},Ma=({value:e,onChange:t,placeholder:s})=>{const[r,n]=a.useState("");return Ce.jsxs("div",{children:[Ce.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:e.map(a=>Ce.jsxs("span",{className:"inline-flex items-center text-xs bg-blue-50 text-blue-700 px-2 py-1 rounded",children:[a,Ce.jsx("button",{onClick:()=>(a=>{t(e.filter(e=>e!==a))})(a),className:"ml-1 text-blue-500 hover:text-blue-700",children:"×"})]},a))}),Ce.jsx("input",{type:"text",value:r,onChange:e=>n(e.target.value),onKeyDown:a=>{"Enter"===a.key&&(a.preventDefault(),(a=>{const s=a.trim();if(!s)return;const r=Array.from(new Set([...e,s]));t(r),n("")})(r))},placeholder:s||"Añadir...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"}),Ce.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Pulsa Enter para agregar"})]})},Ea=()=>{const{config:e,updateConfig:t,getModifiersForCategory:s}=Qt(),{categories:r}=xa(),[n,i]=a.useState(e.modifiers||{global:[],byCategory:{}}),[o,l]=a.useState("");a.useEffect(()=>{i(e.modifiers||{global:[],byCategory:{}})},[e.modifiers]);return Ce.jsx("div",{className:"h-full bg-gray-50 p-6",children:Ce.jsxs("div",{className:"max-w-6xl mx-auto space-y-6",children:[Ce.jsxs("div",{className:"flex items-center justify-between",children:[Ce.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center",children:[Ce.jsx(y,{className:"w-6 h-6 mr-2"})," Modificadores"]}),Ce.jsx("button",{onClick:()=>{t({modifiers:n}),P.success("Modificadores guardados")},className:"btn btn-primary",children:"Guardar"})]}),Ce.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[Ce.jsxs("div",{className:"card p-6",children:[Ce.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Globales"}),Ce.jsx(Ma,{value:n.global||[],onChange:e=>i({...n,global:e}),placeholder:"Añade modificadores globales"})]}),Ce.jsxs("div",{className:"card p-6",children:[Ce.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Clonar entre categorías"}),Ce.jsxs("div",{className:"flex items-center gap-2",children:[Ce.jsxs("select",{value:o,onChange:e=>l(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg",children:[Ce.jsx("option",{value:"",children:"Selecciona categoría origen"}),r.map(e=>Ce.jsx("option",{value:e.id,children:e.name},e.id))]}),Ce.jsx("div",{className:"text-sm text-gray-500",children:"Selecciona una categoría para copiar sus modificadores"})]})]})]}),Ce.jsxs("div",{className:"card p-6",children:[Ce.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Por Categoría"}),Ce.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:r.map(e=>{var t;return Ce.jsxs("div",{className:"border rounded-lg p-4",children:[Ce.jsxs("div",{className:"flex items-center justify-between mb-2",children:[Ce.jsx("div",{className:"text-sm font-medium",style:{color:e.color},children:e.name}),Ce.jsxs("button",{onClick:()=>(e=>{if(!o)return void P.error("Selecciona una categoría origen para clonar");if(o===e)return void P.error("El origen y destino no pueden ser iguales");const t=n.byCategory[o]||[];i({...n,byCategory:{...n.byCategory,[e]:Array.from(new Set([...n.byCategory[e]||[],...t]))}}),P.success("Modificadores clonados")})(e.id),className:"text-xs inline-flex items-center px-2 py-1 bg-blue-50 text-blue-700 rounded hover:bg-blue-100",title:"Clonar modificadores desde la categoría seleccionada arriba",children:[Ce.jsx(oe,{className:"w-3 h-3 mr-1"})," Clonar de origen"]})]}),Ce.jsx(Ma,{value:(null==(t=n.byCategory)?void 0:t[e.id])||[],onChange:t=>i({...n,byCategory:{...n.byCategory,[e.id]:t}}),placeholder:`Añadir modificadores para ${e.name}`})]},e.id)})})]})]})})},$a=({onEnter:e})=>{const[t,s]=a.useState(!1),[r,n]=a.useState(!1),[i,o]=a.useState(!1);return a.useEffect(()=>{const e=setTimeout(()=>s(!0),300),t=setTimeout(()=>n(!0),800),a=setTimeout(()=>o(!0),1200);return()=>{clearTimeout(e),clearTimeout(t),clearTimeout(a)}},[]),Ce.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 flex items-center justify-center p-8",children:Ce.jsxs("div",{className:"max-w-md w-full",children:[Ce.jsxs("div",{className:"text-center mb-12",children:[Ce.jsxs("div",{className:"relative inline-block mb-6 transition-all duration-1000 ease-out "+(t?"scale-100 opacity-100":"scale-0 opacity-0"),children:[Ce.jsx("div",{className:"w-32 h-32 bg-gradient-to-br from-blue-600 to-indigo-700 rounded-full flex items-center justify-center shadow-2xl transition-all duration-1000 ease-out "+(t?"rotate-0 scale-100":"rotate-180 scale-0"),children:Ce.jsxs("div",{className:"relative",children:[Ce.jsx(ie,{className:"w-16 h-16 text-white transition-all duration-700 ease-out delay-300 "+(t?"scale-100 opacity-100":"scale-0 opacity-0")}),Ce.jsx(le,{className:"w-8 h-8 text-yellow-300 absolute -bottom-2 -right-2 transition-all duration-700 ease-out delay-500 "+(t?"scale-100 opacity-100 rotate-0":"scale-0 opacity-0 rotate-180")})]})}),Ce.jsx("div",{className:"absolute inset-0 border-4 border-blue-400/30 rounded-full transition-all duration-1000 ease-out delay-700 "+(t?"animate-pulse opacity-100":"opacity-0")}),Ce.jsx("div",{className:"absolute -top-4 -left-4 w-3 h-3 bg-blue-400 rounded-full transition-all duration-1000 ease-out delay-900 "+(t?"animate-bounce opacity-60":"opacity-0")}),Ce.jsx("div",{className:"absolute -top-2 -right-6 w-2 h-2 bg-indigo-400 rounded-full transition-all duration-1000 ease-out delay-1000 "+(t?"animate-bounce opacity-60":"opacity-0"),style:{animationDelay:"0.5s"}}),Ce.jsx("div",{className:"absolute -bottom-4 -right-2 w-2.5 h-2.5 bg-purple-400 rounded-full transition-all duration-1000 ease-out delay-1100 "+(t?"animate-bounce opacity-60":"opacity-0"),style:{animationDelay:"1s"}})]}),Ce.jsxs("h1",{className:"text-4xl font-bold bg-gradient-to-r from-blue-600 to-indigo-700 bg-clip-text text-transparent mb-2 transition-all duration-1000 ease-out "+(r?"opacity-100 translate-y-0":"opacity-0 translate-y-4"),children:[Ce.jsx("span",{className:"inline-block",children:"kimi"}),Ce.jsx("span",{className:"inline-block text-indigo-800",children:"POS"})]}),Ce.jsx("p",{className:"text-lg text-gray-600 font-medium transition-all duration-1000 ease-out delay-200 "+(r?"opacity-100 translate-y-0":"opacity-0 translate-y-4"),children:"Sistema de Punto de Venta"}),Ce.jsx("p",{className:"text-sm text-gray-500 mt-1 transition-all duration-1000 ease-out delay-400 "+(r?"opacity-100 translate-y-0":"opacity-0 translate-y-4"),children:"Gestión inteligente para tu negocio"})]}),Ce.jsx("div",{className:"text-center transition-all duration-1000 ease-out "+(i?"opacity-100 translate-y-0":"opacity-0 translate-y-8"),children:Ce.jsxs("button",{onClick:e,className:"bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white px-8 py-4 rounded-xl font-semibold text-lg flex items-center justify-center space-x-3 shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-105 mx-auto",children:[Ce.jsx(ce,{className:"w-5 h-5"}),Ce.jsx("span",{children:"Entrar al Sistema"})]})}),Ce.jsxs("div",{className:"text-center mt-8 text-sm text-gray-500 transition-all duration-1000 ease-out delay-600 "+(i?"opacity-100 translate-y-0":"opacity-0 translate-y-4"),children:[Ce.jsx("p",{children:"Versión 1.0"}),Ce.jsx("p",{className:"mt-1",children:"© 2024 kimiPOS - Todos los derechos reservados"})]})]})})},Fa=a.createContext(null);function Oa(e,t){var a,s;const r=null==(a=Object.getOwnPropertyDescriptor(e,"value"))?void 0:a.set,n=Object.getPrototypeOf(e),i=null==(s=Object.getOwnPropertyDescriptor(n,"value"))?void 0:s.set;i&&r!==i?i.call(e,t):r?r.call(e,t):e.value=t,e.dispatchEvent(new Event("input",{bubbles:!0}))}const za=({children:e})=>{const[t,s]=a.useState(!1),[r,n]=a.useState(""),i=a.useRef(null),o=a.useRef(0),l=a.useRef(!1),c=a.useCallback(e=>{i.current=e;const t=e.value??"";n(t);try{o.current=e.selectionStart??t.length}catch{o.current=t.length}s(!0)},[]),d=a.useCallback(()=>{s(!1),i.current=null},[]),m=a.useCallback(()=>{const e=i.current;if(e){Oa(e,r);try{e.selectionStart=e.selectionEnd=o.current}catch{}l.current=!0,e.focus()}d()},[r,d]),u=a.useCallback(()=>{d()},[d]),x=a.useCallback(e=>{n(e);const t=i.current;if(t){Oa(t,e);try{t.selectionStart=t.selectionEnd=o.current}catch{}}},[]),h=a.useCallback(e=>{const t=Math.max(0,Math.min(r.length,(o.current??0)+e));o.current=t},[r.length]),g=a.useCallback(()=>{const e=o.current??0;if(e<=0)return;const t=r.slice(0,e-1)+r.slice(e);o.current=e-1,x(t)},[r,x]),p=a.useCallback(e=>{const t=o.current??0,a=r.slice(0,t)+e+r.slice(t);o.current=t+e.length,x(a)},[r,x]);a.useEffect(()=>{const e=e=>{const t=e.target;if(t)if(l.current)l.current=!1;else if("false"!==t.getAttribute("data-osk"))if(t instanceof HTMLInputElement){const e=(t.type||"text").toLowerCase();["text","search","email","password","tel","url","number"].includes(e)&&c(t)}else t instanceof HTMLTextAreaElement&&c(t)};return document.addEventListener("focusin",e),()=>document.removeEventListener("focusin",e)},[c]);const b=a.useMemo(()=>({isOpen:t,currentValue:r,openForElement:c,close:d,setValue:x,commit:m,cancel:u,moveCaret:h,backspace:g,insertText:p}),[t,r,c,d,x,m,u,h,g,p]);return Ce.jsx(Fa.Provider,{value:b,children:e})},Ra=[["1","2","3","4","5","6","7","8","9","0"],["q","w","e","r","t","y","u","i","o","p"],["a","s","d","f","g","h","j","k","l"],["z","x","c","v","b","n","m"]],Wa=()=>{const{isOpen:e,currentValue:t,insertText:s,backspace:r,moveCaret:n,commit:i,cancel:o}=(()=>{const e=a.useContext(Fa);if(!e)throw new Error("useOnScreenKeyboard debe usarse dentro de OnScreenKeyboardProvider");return e})(),[l,c]=a.useState(!1),d=a.useMemo(()=>Ra.map(e=>e.map(e=>l?e.toUpperCase():e)),[l]),m="osk:possize:v1",[u,x]=a.useState(()=>({x:20,y:window.innerHeight-360})),[h,g]=a.useState(()=>({w:980,h:320})),p=a.useRef({dragging:!1,dx:0,dy:0}),b=a.useRef({dir:null,startX:0,startY:0,startW:0,startH:0});return a.useEffect(()=>{try{const e=localStorage.getItem(m);if(e){const{x:t,y:a,w:s,h:r}=JSON.parse(e);Number.isFinite(t)&&Number.isFinite(a)&&x({x:t,y:a}),Number.isFinite(s)&&Number.isFinite(r)&&g({w:s,h:r})}}catch{}},[]),a.useEffect(()=>{try{localStorage.setItem(m,JSON.stringify({x:u.x,y:u.y,w:h.w,h:h.h}))}catch{}},[u,h]),a.useEffect(()=>{const e=e=>{if(p.current.dragging){const t=e.clientX-p.current.dx,a=e.clientY-p.current.dy,s=window.innerWidth-h.w-10,r=window.innerHeight-h.h-10;x({x:Math.max(10,Math.min(t,s)),y:Math.max(10,Math.min(a,r))})}else if(b.current.dir){const t=e.clientX-b.current.startX,a=e.clientY-b.current.startY,s=600,r=260;"right"===b.current.dir?g(e=>({w:Math.max(s,b.current.startW+t),h:e.h})):"bottom"===b.current.dir?g(e=>({w:e.w,h:Math.max(r,b.current.startH+a)})):"corner"===b.current.dir&&g({w:Math.max(s,b.current.startW+t),h:Math.max(r,b.current.startH+a)})}},t=()=>{p.current.dragging=!1,b.current.dir=null};return window.addEventListener("mousemove",e),window.addEventListener("mouseup",t),()=>{window.removeEventListener("mousemove",e),window.removeEventListener("mouseup",t)}},[h.w,h.h]),e?Ce.jsx("div",{className:"fixed inset-0 pointer-events-none z-[2000]",children:Ce.jsxs("div",{className:"absolute bg-white rounded-2xl shadow-2xl border pointer-events-auto select-none",style:{left:u.x,top:u.y,width:h.w,height:h.h},children:[Ce.jsxs("div",{className:"px-4 py-2 border-b flex items-center justify-between cursor-move rounded-t-2xl bg-gray-50",onMouseDown:e=>{p.current={dragging:!0,dx:e.clientX-u.x,dy:e.clientY-u.y}},children:[Ce.jsx("div",{className:"text-sm text-gray-700 font-medium",children:"Entrada de texto"}),Ce.jsxs("div",{className:"flex items-center gap-2",children:[Ce.jsx("div",{className:"text-gray-400 text-xs max-w-[420px] truncate",children:t}),Ce.jsx("button",{className:"text-sm text-gray-500 hover:text-gray-700 px-2 py-1",onClick:o,children:"Cerrar"})]})]}),Ce.jsxs("div",{className:"p-3 h-[calc(100%-48px)] overflow-auto",children:[Ce.jsx("div",{className:"grid gap-2 mb-2",style:{gridTemplateColumns:"repeat(10, minmax(0, 1fr))"},children:d[0].map(e=>Ce.jsx("button",{className:"h-12 rounded bg-gray-100 hover:bg-gray-200 active:bg-gray-300 text-lg",onClick:()=>s(e),children:e},e))}),Ce.jsx("div",{className:"grid gap-2 mb-2",style:{gridTemplateColumns:"repeat(10, minmax(0, 1fr))"},children:d[1].map(e=>Ce.jsx("button",{className:"h-12 rounded bg-gray-100 hover:bg-gray-200 active:bg-gray-300 text-lg",onClick:()=>s(e),children:e},e))}),Ce.jsxs("div",{className:"grid gap-2 mb-2",style:{gridTemplateColumns:"repeat(13, minmax(0, 1fr))"},children:[Ce.jsx("button",{className:`h-12 rounded ${l?"bg-blue-600 text-white":"bg-gray-100 hover:bg-gray-200"} text-sm col-span-2`,onClick:()=>c(e=>!e),children:"Shift"}),d[2].map(e=>Ce.jsx("button",{className:"h-12 rounded bg-gray-100 hover:bg-gray-200 active:bg-gray-300 text-lg",onClick:()=>s(e),children:e},e)),Ce.jsx("button",{className:"h-12 rounded bg-gray-100 hover:bg-gray-200 text-sm col-span-2",onClick:r,children:"⌫"})]}),Ce.jsxs("div",{className:"grid gap-2",style:{gridTemplateColumns:"repeat(11, minmax(0, 1fr))"},children:[Ce.jsx("button",{className:"h-12 rounded bg-gray-100 hover:bg-gray-200 text-sm col-span-2",onClick:()=>n(-1),children:"◀"}),d[3].map(e=>Ce.jsx("button",{className:"h-12 rounded bg-gray-100 hover:bg-gray-200 active:bg-gray-300 text-lg",onClick:()=>s(e),children:e},e)),Ce.jsx("button",{className:"h-12 rounded bg-gray-100 hover:bg-gray-200 text-sm col-span-2",onClick:()=>n(1),children:"▶"})]}),Ce.jsxs("div",{className:"grid gap-2 mt-2 items-stretch",style:{gridTemplateColumns:"repeat(12, minmax(0, 1fr))"},children:[Ce.jsx("div",{className:"col-span-2"}),Ce.jsx("button",{className:"h-12 col-span-6 rounded bg-gray-100 hover:bg-gray-200",onClick:()=>s(" "),children:"Espacio"}),Ce.jsx("button",{className:"h-12 col-span-2 rounded bg-gray-100 hover:bg-gray-200",onClick:()=>s("\n"),children:"Enter"}),Ce.jsx("button",{className:"h-12 col-span-2 rounded bg-emerald-600 text-white hover:bg-emerald-700",onClick:i,children:"Aceptar"})]})]}),Ce.jsx("div",{className:"absolute right-0 top-0 h-full w-2 cursor-ew-resize",onMouseDown:e=>{b.current={dir:"right",startX:e.clientX,startY:e.clientY,startW:h.w,startH:h.h}}}),Ce.jsx("div",{className:"absolute left-0 bottom-0 w-full h-2 cursor-ns-resize",onMouseDown:e=>{b.current={dir:"bottom",startX:e.clientX,startY:e.clientY,startW:h.w,startH:h.h}}}),Ce.jsx("div",{className:"absolute right-0 bottom-0 w-3 h-3 cursor-nwse-resize",onMouseDown:e=>{b.current={dir:"corner",startX:e.clientX,startY:e.clientY,startW:h.w,startH:h.h}}})]})}):null},La=()=>{const[e,t]=a.useState(!0),[s,r]=a.useState(!0);a.useEffect(()=>{localStorage.getItem("kimipos-has-visited")&&t(!1),r(!1)},[]);const n=()=>{localStorage.setItem("kimipos-has-visited","true"),t(!1)};return s?Ce.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 flex items-center justify-center",children:Ce.jsx("div",{className:"w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full animate-spin"})}):e?Ce.jsx($a,{onEnter:n}):Ce.jsx(De,{children:Ce.jsx(Vt,{children:Ce.jsx(ua,{children:Ce.jsx(Ht,{children:Ce.jsx(pa,{children:Ce.jsx(Rt,{children:Ce.jsx(za,{children:Ce.jsx(l,{children:Ce.jsxs(Ft,{children:[Ce.jsxs(c,{children:[Ce.jsx(d,{path:"/",element:Ce.jsx(va,{})}),Ce.jsx(d,{path:"/products",element:Ce.jsx(ka,{})}),Ce.jsx(d,{path:"/categories",element:Ce.jsx(Aa,{})}),Ce.jsx(d,{path:"/tables",element:Ce.jsx(Sa,{})}),Ce.jsx(d,{path:"/orders",element:Ce.jsx(Da,{})}),Ce.jsx(d,{path:"/modifiers",element:Ce.jsx(Ea,{})}),Ce.jsx(d,{path:"/configuration",element:Ce.jsx(Ia,{})}),Ce.jsx(d,{path:"/configuration/salons",element:Ce.jsx(Ia,{})}),Ce.jsx(d,{path:"/customers",element:Ce.jsx(Ia,{})}),Ce.jsx(d,{path:"/configuration/incentives",element:Ce.jsx(Ia,{})}),Ce.jsx(d,{path:"/reports",element:Ce.jsx(Ia,{})}),Ce.jsx(d,{path:"/invoices",element:Ce.jsx(Ia,{})})]}),Ce.jsx(de,{position:"top-right",toastOptions:{duration:4e3,style:{background:"#363636",color:"#fff"},success:{style:{background:"#10b981"}},error:{style:{background:"#ef4444"}}}}),Ce.jsx(Wa,{})]})})})})})})})})})};ke.createRoot(document.getElementById("root")).render(Ce.jsx(r.StrictMode,{children:Ce.jsx(La,{})}));
